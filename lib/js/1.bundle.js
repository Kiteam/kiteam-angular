webpackJsonp([1],Array(35).concat([function(e,t,n){var i,r;i=[n(34),n(86),n(47),n(48),n(55),n(64),n(67),n(76),n(80),n(36),n(97),n(101),n(105),n(110),n(111),n(112),n(113)],r=function(e){return e.module("mic",["ngRoute","mic.services","mic.directives","mic.controllers","mic.filters","ui.router"])}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(37),n(45)],r=function(){}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(38),n(39),n(43),n(44)],r=function(e,t,n,i){return e.controllerModule.controller("reportController",["$scope","API",function(e,t){var n;return e.title="我的报表",(n=function(){return t.team().retrieve({role:"l"}).then(function(t){return e.teamCategory=t})})()}]).controller("weeklyReportListController",["$scope","$stateParams","$location","API","WEEKLIST",function(e,t,n,i,r){return e.weeks=r(30),e.title="项目周报",t.team_id&&(e.title="【"+n.$$search.title+"】团队周报"),0===parseInt(t.team_id)&&(e.title="我的周报"),e.teamName=n.$$search.title,e.createReport=function(){return e.$broadcast("report:create:show")}}]).controller("reportWeeklyDetailsController",["$rootScope","$scope","$stateParams","$location","API",function(e,t,i,r,o){var a,s,l,c,d;return c=i.start_time||r.$$search.start_time,s=i.end_time||r.$$search.end_time,l=i.project_id||r.$$search.project_id||null,d=i.team_id||r.$$search.team_id||null,t.printExtraUrl="",d&&(t.printExtraUrl+="&team_id="+d),l&&(t.printExtraUrl+="&project_id="+l),a={start_time:c,end_time:s,project_id:l},n.extend(t,a),o.report(d).weekly().retrieve(a).then(function(e){return t.report=e})}])}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(34)],r=function(e){return{directiveModule:e.module("mic.directives",["mic.services","mic.filters"]),controllerModule:e.module("mic.controllers",["mic.services"]),serviceModule:e.module("mic.services",[]),filterModule:e.module("mic.filters",[])}}.apply(t,i),!(void 0!==r&&(e.exports=r))},,,,,,function(e,t,n){var i,r;(function(n){var o=[].slice;i=[],r=function(){return{trim:function(e){return e&&e.replace(/^\s+/,"").replace(/\s+$/,"")},formatString:function(){var e,t;return t=arguments[0],e=2<=arguments.length?o.call(arguments,1):[],t?(1===e.length&&e[0]instanceof Array&&(e=e[0]),t.replace(/\{(\d+)\}/g,function(t,n){return e[n]})):t},extractTemplate:function(e,t){var i,r,o,a;if("string"==typeof e)return n(t).find(e).val();if(e instanceof Array){for(i="",o=0,a=e.length;a>o;o++)r=e[o],i+=n(t).find(r).val();return i}},hex2rgba:function(e){var t,n={r:0,g:0,b:0,a:0},i=[],r=0,o=e.match(/^#(([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})|([0-9a-f])([0-9a-f])([0-9a-f]))$/i);if(!o)return n;for(var a=2,s=o.length;s>a;a++)void 0!==o[a]&&(t=parseInt(o[a],16),i[r++]=t+(a>4?16*t:0));return n.r=i[0],n.g=i[1],n.b=i[2],n},toDyadicArray:function(e,t){var n,i,r,o,a,s,l,c,d,u,p,h,m,f;for(i=[],u=t,u>0?(o=s=0,d=e.length):o=s=e.length-1;u>0?d>s:s>=0;o=s+=u){if(a=e[o],o+t<e.length)for(n=[],r=l=p=o,h=o+t;h>=p?h>l:l>h;r=h>=p?++l:--l)n.push(e[r]);else for(n=[],r=c=m=o,f=e.length;f>=m?f>c:c>f;r=f>=m?++c:--c)n.push(e[r]);i.push(n)}return i},detectFileType:function(e){return/\.(7z|zip|rar)$/i.test(e)?"bundle":/\.(png|jpg|jpeg|gif|bmp)$/i.test(e)?"image":/\.(md|markdown|mark|mkd|mark)$/i.test(e)?"markdown":/\.(js|json|html|htm|less|css|coffee|hbs|xml)/i.test(e)?"code":/\.(txt)/i.test(e)?"text":"other"}}}.apply(t,i),!(void 0!==r&&(e.exports=r))}).call(t,n(33))},function(e,t,n){var i,r;(function(o){"use strict";i=[n(38),n(44),n(46)],r=function(e,t,n){return e.directiveModule.directive("reportWeeklyDetailsMember",[function(){return{restrict:"E",replace:!0,scope:{source:"="},template:t.extractTemplate("#tmpl-report-weekly-details-member",n),link:function(e,t,n){}}}]).directive("reportTeamCategoryMenu",[function(){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-report-team-menu-category",n),link:function(e,t,n){}}}]).directive("reportWeeklyDetailsContent",[function(){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-report-weekly-details-content",n),link:function(e,t,n){}}}]).directive("reportWeeklyDetailsPrint",[function(){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-report-weekly-details-print",n),link:function(e,t,n){}}}]).directive("indexTeamFinishedChart",["API",function(e){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-index-team-finished-chart",n),link:function(t,n,i){return e.team().retrieve({status:1}).then(function(e){return t.teams=e?e:[],t.current_team=t.teams.length>0?t.teams[0]:0}),t.teamClick=function(e){return t.current_team=e,t.$broadcast("team:chart:change",e.team_id,"team")}}}}]).directive("reportCreate",["WEEKLIST","API","NOTIFY",function(e,i,r){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-report-create",n),link:function(t,n,a){var s;return t.weekList=e(5),t.profile={},t.profile.time=t.weekList[0].start,s=o(n),t.$on("report:create:show",function(e){return s.modal({showClose:!1})}),t.$on("report:create:hide",function(){return o.modal.close()}),t.dropDownChange=function(){return i.report().retrieve({time:t.profile.time}).then(function(e){return t.profile.content=e.content,t.profile.id=e.id})},t.onClickSave=function(){var e,n,o;return e=!1,o=i.report(),n=t.profile.id?"update":"create",o[n](t.profile).then(function(e){return r.success("保存成功！"),t.$emit("report:create:hide")})},t.onClickCancel=function(){return t.$emit("report:create:hide")},t.dropDownChange()}}}])}.apply(t,i),!(void 0!==r&&(e.exports=r))}).call(t,n(33))},function(e,t){var n,i=window.angular;try{n=i.module(["ng"])}catch(r){n=i.module("ng",[])}var o='<div>  <textarea id="tmpl-report-layout">\n        <div class="frame project-view team-view">\n            <global-message ng-show="false"></global-message>\n            <header-global></header-global>\n            <div class="container">\n                \n                <div class="master-panel">\n                    \n                    <div class="project-menu">\n                        <ul class="master-menu" project-menu-highlight>\n                            <li class="issue-category">\n                                <div class="inner">\n                                    <div class="title">\n                                        <label>\n                                            <a href="/report/0/weekly-report?title=我的周报">我的周报</a>\n                                        </label>\n                                    </div>\n                                </div>\n                            </li>\n                            <li class="issue-category" ng-show="teamCategory.length > 0">\n                                <div class="inner">\n                                    <div class="title">\n                                        <label>\n                                            <a>团队周报</a>\n                                        </label>\n                                    </div>\n                                    <report-team-category-menu></report-team-category-menu>\n                                </div>\n                            </li>\n                        </ul>\n                    </div>\n                </div>\n                <project-salve-panel></project-salve-panel>\n            </div>\n        </div>\n    </textarea>  <textarea id="tmpl-report-team-menu-category">\n        <ul class="sub-menu">\n            <li ng-repeat="item in teamCategory" ng-if="item.status==1">\n                <a href="/report/{{item.team_id}}/weekly-report?title={{item.name}}" class="text-overflow">{{item.name}}</a>\n            </li>\n        </ul>\n    </textarea>  <textarea id="tmpl-report-weekly-list">\n        <div class="list">\n            <header>\n                <h3>{{title}}<button class="primary default" style="float:right;margin-bottom:5px" ng-click="createReport()" ng-if="title==\'我的周报\'">添加</button></h3>\n            </header>\n\n            <ul class="details">\n                <li class="row" ng-repeat="week in weeks">\n                    <a class="title" href="/{{null | projectLink: \'normal\'}}/weekly-report/{{week.start}}~{{week.end}}?title={{teamName}}">\n                        {{week.start|date: \'yyyy年第ww周\'}}\n                    </a>\n\n                    <div class="info">\n                        <span class="memo">{{week.start | date}} 至 {{week.end | date}}</span>\n                    </div>\n                </li>\n            </ul>\n        </div>\n        <report-create></report-create>\n    </textarea>  <textarea id="tmpl-report-weekly-details-member">\n        <div>\n            <div class="somebody" ng-repeat="item in source">\n                <div class="member">{{item.member.realname || item.member.username}}({{item.issue.length+item.others.length}})</div>\n                <ul class="tasks">\n                    <li ng-repeat="issue in item.issue">\n                        <a href="/project/{{issue.project_id}}/issue/{{issue.id}}"><span ng-if="issue.issue_title">{{issue.issue_title}}--></span>{{issue.title}} </a>\n                        <div class="info">\n                            <span class="plain gray">{{(issue.finish_time || issue.timestamp) | date: \'EEEE\'}}</span>\n                            <span class="plain gray">{{issue.project_name}}</span>\n                        </div>\n                    </li>\n                    <li ng-show="item.others.length>0 && item.issue.length>0" class="devide"></li>\n                    <li ng-repeat="other in item.others">\n                        {{other}}\n                    </li>\n                </ul>\n            </div>\n            <div ng-show="source.length == 0" class="somebody">暂无数据</div>\n        </div>\n    </textarea>  <textarea id="tmpl-report-weekly-details">\n        <div class="weekly-report-details inner-view">\n            <header>\n                <div class="title">\n                    {{start_time | date: \'yyyy年第ww周\'}}周报\n                    <em>{{start_time | date: \'yyyy-MM-dd\'}} 至 {{end_time | date: \'yyyy-MM-dd\'}}</em>\n                </div>\n                <div class="print">\n                    <i class="icon small"></i>\n                    <a href="/report/weekly.html?start_time={{start_time}}&end_time={{end_time}}{{printExtraUrl}}" target="_blank">打印版</a>\n                </div>\n            </header>\n            \n            <report-weekly-details-content></report-weekly-details-content>\n        </div>\n    </textarea>  <textarea id="tmpl-report-weekly-details-print">\n        <div class="report-weekly-print">\n            <header>\n                <h3>\n                    {{start_time | date: \'yyyy年第ww周\'}}周报\n                    <em>{{start_time | date: \'yyyy-MM-dd\'}} 至 {{end_time | date: \'yyyy-MM-dd\'}}</em>\n                </h3>\n            </header>\n            <report-weekly-details-content></report-weekly-details-content>\n            <footer>\n                本报表由BHF自动生成\n            </footer>\n        </div>\n    </textarea>  <textarea id="tmpl-report-weekly-details-content">\n        <div>\n            \n            <section class="done report-view">\n                <div class="title">\n                    <i class="icon small"></i>\n                    <h3>本周完成任务</h3>\n                </div>\n\n                <report-weekly-details-member data-source="report.finished"></report-weekly-details-member>\n            </section>\n\n            \n            <section class="undone report-view">\n                <div class="title">\n                    <i class="icon small"></i>\n                    <h3>本周未完成任务</h3>\n                </div>\n\n                <report-weekly-details-member data-source="report.unfinished"></report-weekly-details-member>\n            </section>\n\n            \n            <section class="lazybone report-view" ng-hide="true">\n                <div class="title">\n                    <i class="icon small"></i>\n                    <h3>本周无任务和周报记录(共{{report.lazybones.length}}人)</h3>\n                </div>\n\n                <ul class="member-list">\n                    <li ng-repeat="member in report.lazybones">\n                        <div class="avatar">\n                            {{member.realname | lastName}}\n                        </div>\n                        <label>{{member.realname}}</label>\n                    </li>\n                </ul>\n            </section>\n        </div>\n    </textarea> <textarea id="tmpl-index-team-finished-chart">\n        <div ng-if="teams.length > 0">\n            <div class="chart-box">\n                <h3>【{{current_team.name}}】年度开发者完成任务Top 5</h3>\n                \n                <div class="chart" issue-finished-total-chart data-name="team" data-id="{{current_team.team_id}}" data-flag="team"></div>\n            </div>\n            <ul class="team-chart" ng-show="teams.length > 1">\n                <li ng-repeat="team in teams" ng-click="teamClick(team)" ng-class="{true: \'selected\', false: \'\'}[(team == current_team)]">\n                    {{team.name}}\n                </li>\n            </ul>\n        </div>\n    </textarea> <textarea id="tmpl-report-create">\n        <div class="modal">\n            <div class="inner">\n                <a class="close-modal" rel="modal:close"><i class="icon"></i></a>\n                <div class="simple-tab" simple-tab="" data-active-index="0">\n                    <div class="nav title" data-field="nav">\n                        <span>添加周报</span>\n                    </div>\n                </div>\n                <div class="content" data-field="content">\n                    <div class="panel">\n                        <div class="standard-form">\n                            <div class="row">\n                                <label class="caption">\n                                    时间：\n                                </label>\n                                <select class="width" ng-change="dropDownChange()" ng-model="profile.time" ng-options="week.start as ((week.start|date: \'yyyy年第ww周\')+\'(\'+(week.start|date: \'MM月dd日\')+\'至\'+(week.end|date: \'MM月dd日\')+\')\') for week in weekList"></select>\n                            </div>\n                            <div class="row">\n                                <label class="caption float">\n                                    内容：\n                                </label>\n                                &lt;textarea ng-model="profile.content"&gt;&lt;/textarea&gt;\n                            </div>\n\n                            <div class="row control">\n                                <button class="primary default" ng-click="onClickSave()">保存</button>\n                                <button class="cancel default" ng-click="onClickCancel()">取消</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </textarea> </div>';n.run(["$templateCache",function(e){e.put("report-all.html",o)}]),e.exports=o},function(e,t,n){var i,r;(function(o){"use strict";i=[n(38),n(44),n(39)],r=function(e,t,n){return e.filterModule.filter("unsafe",["$sce",function(e){return function(t){return e.trustAsHtml(t)}}]).filter("projectMemberRole",function(){return function(e){return{a:"管理员",d:"开发",p:"产品",l:"Leader",g:"客人",t:"测试"}[e]}}).filter("teamMemberRole",function(){return function(e){return{m:"成员",l:"Leader"}[e]}}).filter("teamMemberStatus",function(){return function(e){return["未接受",""][e]}}).filter("assetThumbnail",function(){return function(e){var n,i,r,o;return/\.(png|jpg|jpeg|gif|bmp)$/i.test(e.url)?o="/api/project/"+e.project_id+"/asset/"+(e.asset_id||e.id)+"/thumbnail":(i=/\.(7z|ai|aif|asf|asp|asx|avi|bmp|cab|chm|css|directory|doc|docx|dwg|eps|exe|fla|gz|htm|html|ico|iso|jpeg|jpg|js|log|md|mid|mov|mp3|mp4|mpg|others|pdf|png|ppt|psd|rar|rm|rtf|swf|tif|txt|wav|xls|xml|zip)$/i,r="/images/file-extension/file_extension_{0}.png",n=e.url&&i.test(e.url)?e.url.replace(/\.(\w)$/i,"$1"):"others",t.formatString(r,n))}}).filter("extensionImage",["$filter",function(e){return function(t,n){return n?"folder":e("assetIsPicture")(t)?"png":e("assetIsBundle")(t)?"zip":"other"}}]).filter("getAssetThumbnailClass",["$filter",function(e){return function(t){return e("assetIsPicture")(t)?"thumbnail":"extension"}}]).filter("assetIsBundle",function(){return function(e){return/\.(7z|zip|rar)$/i.test(e)}}).filter("assetIsDocx",function(){return function(e){return/\.(docx)$/i.test(e)}}).filter("assetIsPicture",function(){return function(e){return/\.(png|jpg|jpeg|gif|bmp)$/i.test(e)}}).filter("friendlyFileSize",function(){return function(e){return(e/=1024)<1024?Math.round(100*e)/100+"KB":(e/=1024)<1024?Math.round(100*e)/100+"MB":Math.round(100*e/1024)/100+"GB"}}).filter("rawText",function(){return function(e){var t;return t=document.createElement("div"),t.innerHTML=e,o(t).text()}}).filter("timeAgo",function(){return function(e){return n.lang("zh-cn"),n(e).fromNow()}}).filter("dateAgo",function(){return function(e){var t;return t=new Date(e),(new Date).toDateString()===t.toDateString()?"今天":(new Date).toDateString()===new Date(e+864e5).toDateString()?"昨天":t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()}}).filter("currentProjectVersion",["$stateParams",function(e){return function(t){var n;return t&&(null!=e?e.version_id:void 0)?(n=_.find(t,{id:Number(e.version_id)}),(null!=n?n.title:void 0)||"未知版本"):"所有版本"}}]).filter("wikiLink",["$stateParams",function(e){return function(t,n){return["wiki",e.project_id].join("/")}}]).filter("isActiveIssue",["$stateParams",function(e){return function(t){return e.issue_id===String(t.id)}}]).filter("projectLink",["$stateParams","$state","$location",function(e,t,n){return function(n,i){var r,o,a,s;return e.team_id&&"normal"===i?"report/"+e.team_id:(o="issue"===i||"normal"===i||"test"===i||"form"===i,r="issue"===i||"form"===i,(null!=(s=t.current.data)?s.wiki:void 0)?(a=["wiki",e.project_id],r&&e.category_id&&(a.push("category"),a.push(e.category_id)),"issue"===i&&a.push("issue"),a.join("/")):(a=[],a.push("project"),a.push(e.project_id),o&&e.version_id&&(a.push("version"),a.push(e.version_id)),"issue"!==i&&"form"!==i||!e.myself||(a.push("issue"),a.push("myself")),"test"===i&&a.push("test"),r&&e.category_id&&(a.push("category"),a.push(e.category_id)),"issue"!==i&&"form"!==i||e.myself||a.push("issue"),a.join("/")))}}]).filter("filenameIsPicture",function(){return function(e){var t;return t=e.replace(/.+\.(\w+)$/,"$1"),/^(jpg|jpeg|png|gif|bmp)$/i.test(t)}}).filter("replace",function(){return function(e,t,n){return e.replace(t,n)}}).filter("replaceWithRegExp",function(){return function(e,t,n){var i;return i=new RegExp(t),e.replace(t,n)}}).filter("lastName",function(){return function(e){return e.substr(0,1)}}).filter("assetLink",function(){return function(e,t){var n;if(e)return n="/api/project/"+e.project_id+"/asset/"+e.id+"/read",t&&(n+="?download=true"),n}}).filter("highlightKeyword",function(){return function(e,t){var n;return t?(n=new RegExp(t,"ig"),e.replace(n,"<span class='highlight'>"+t+"</span>")):e}}).filter("removeTag",function(){return function(e){return e&&e.replace(/(#.+?#)/gi,"")}}).filter("removeCommand",function(){return function(e){return e&&e.replace(/#p\-\d+/gi,"").replace(/#(doing|done|pause)/,"").replace(/#(.+)/,"")}}).filter("dateOrNow",function(){return function(e){return e||new Date}})}.apply(t,i),!(void 0!==r&&(e.exports=r))}).call(t,n(33))},function(e,t,n){var i,r;i=[n(49),n(50),n(54)],r=function(){}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(38),n(39),n(43),n(44)],r=function(e,t,n,i){return e.controllerModule.controller("projectController",["$rootScope","$scope","$routeParams","$location","$stateParams","API","STORE",function(e,t,n,i,r,o,a){var s,l,c,d,u,p;return s=o.project(r.project_id),c=function(){return s.retrieve().then(function(n){return t.project=n,e.$broadcast("project:loaded",n)})},u=function(){return s.member().retrieve().then(function(e){return t.projectMember=e,a.projectMemberList.data=e})},d=function(){return s.category().retrieve().then(function(e){return t.projectCategory=e,a.projectCategory.data=e})},p=function(){return s.version().retrieve({status:"available"}).then(function(n){return t.projectVersion=n,a.projectVersion.data=n,e.$broadcast("project:version:loaded",n)})},l=function(e){var n;return"-1"===e?alert("新建版本的功能暂未发"):(n="/project/"+r.project_id,"all"!==e&&(n+="/version/"+e),n+="/issue",t.$apply(function(){return i.path(n)}))},t.user=a.user.data,t.$on("project:member:request",function(){return u()}),t.$on("project:category:request",function(){return d()}),t.$on("member:creator:toshow",function(e,n){return t.$broadcast("member:creator:show",n)}),t.$on("dropdown:selected",function(e,t,n){switch(t){case"project:version":return l(n)}}),u(),d(),c(),p()}]).controller("myProjectController",["$rootScope","$scope","$routeParams","$location","$stateParams","API","STORE",function(e,t,n,i,r,o,a){var s,l,c,d,u;return t.myproject=!0,t.title="个人中心",d=function(e){return e||(e=r.project_id),o.project(e).member().retrieve().then(function(e){return t.projectMember=e,a.projectMemberList.data=e})},c=function(e){return e||(e=r.project_id),o.project(e).category().retrieve().then(function(e){return t.projectCategory=e,a.projectCategory.data=e})},u=function(n){return n||(n=r.project_id),o.project(n).version().retrieve({status:"available"}).then(function(n){return t.projectVersion=n,a.projectVersion.data=n,e.$broadcast("project:version:loaded",n)})},l=function(e){return e||(e=r.project_id),o.project(e).retrieve().then(function(e){return t.project=e})},t.$on("project:member:request",function(e,t){return d(t)}),t.$on("project:category:request",function(e,t){return c(t)}),t.$on("project:version:request",function(e,t){return u(t)}),t.$on("project:refresh:request",function(e,t){return l(t)}),s={pageSize:9999,myself:!0},o.project().retrieve(s).then(function(e){return t.projects=e})}]).controller("myFollowController",["$rootScope","$scope","$routeParams","$location","$stateParams","API","STORE",function(e,t,n,i,r,o,a){var s,l,c,d,u;return t.myproject=!0,t.title="我的关注",d=function(e){return e||(e=r.project_id),o.project(e).member().retrieve().then(function(e){return t.projectMember=e,a.projectMemberList.data=e})},c=function(e){return e||(e=r.project_id),o.project(e).category().retrieve().then(function(e){return t.projectCategory=e,a.projectCategory.data=e})},u=function(n){return n||(n=r.project_id),o.project(n).version().retrieve({status:"available"}).then(function(n){return t.projectVersion=n,a.projectVersion.data=n,e.$broadcast("project:version:loaded",n)})},l=function(e){return e||(e=r.project_id),o.project(e).retrieve().then(function(e){return t.project=e})},t.$on("project:member:request",function(e,t){return d(t)}),t.$on("project:category:request",function(e,t){return c(t)}),t.$on("project:version:request",function(e,t){return u(t)}),t.$on("project:refresh:request",function(e,t){return l(t)}),s={pageSize:9999},o.project().retrieve(s).then(function(e){return t.projects=e})}])}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;(function(o){"use strict";i=[n(38),n(44),n(51),n(52),n(53)],r=function(e,t,n,i){return e.directiveModule.directive("projectMenu",["$rootScope","$stateParams","API",function(e,i,r){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-project-menu",n),link:function(t,n,o){var a;return a=["project",i.project_id],i.version_id&&(a.push("version"),a.push(i.version_id)),t.baseLink=a.join("/"),r.project(i.project_id).issue().stat().test().retrieve().then(function(e){return t.testStat=e}),t.onClickInvite=function(){return e.$broadcast("member:invite:show")}}}}]).directive("projectMemberDropdown",function(){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-project-member-dropdown",n),link:function(e,n,i){var r;return r=!1,i.$observe("items",function(){return!r&&i.items?e.items=t.toDyadicArray(JSON.parse(i.items),10):void 0})}}}).directive("projectTiles",["$location","$rootScope","$timeout","$filter","API","NOTIFY","ENUM",function(e,i,r,a,s,l,c){return{restrict:"E",replace:!0,scope:{},template:t.extractTemplate("#tmpl-project-tiles",n),link:function(t,n,a){var d,u;return d={},t.isLogin=i.__member.isLogin,t.onClickCreate=function(){return i.$broadcast("project:editor:show")},t.onClickTile=function(t,n){var i;return i="/project/"+n.id,n.active_version&&(i+="/version/"+n.active_version),i+="/issue",n.flag===c.projectFlag.wiki&&(i="/wiki/"+n.id+"/issue"),e.path(i)},t.onClickEdit=function(e,t){e.stopPropagation(),i.$broadcast("project:editor:show",t.id)},t.onClickFavorite=function(e,t){var n,i;e.stopPropagation(),n={type:"project",target_id:t.id},i=t.favorite?"delete":"create",s.project(t.id).favorite(n)[i](n).then(function(){return u()})},t.onClickDelete=function(e,t){return e.stopPropagation(),confirm("您确定要删除该项目吗？")?s.project(t.id).update({status:"trash"}).then(function(){var t;return t=o(e.target).closest("li.tile"),t.fadeOut(),l.success("该项目已经删除成功")}):void 0},t.$on("instant-search:change",function(e,t){return d.keyword!==t?u({keyword:t}):void 0}),t.$on("project:change",function(e){return u({keyword:d.keyword})}),(u=function(e){var n;return n={pageSize:9999,special:!0},d=_.extend(n,e),s.project().retrieve(d).then(function(e){return t.projects=e,_.map(e.items,function(e){return e.finished_rate=e.undone_task_total===e.task_total?100:100-e.undone_task_total/e.task_total*100}),r(function(){return t.$emit("project:tile:loaded")},0)})})()}}}]).directive("projectTileResize",[function(){return{restrict:"A",link:function(e,t,n){var i,r;return i=o(t),r=function(){var e,t,n,r,o,a;return e=i.find(">li.tile"),t=i.width(),a=250,n=10,r=Math.round(t/(a+2*n)),o=(t-n*r*2-10)/r,e.css({width:o})},o(window).on("onResizeEx",r),e.$on("project:tile:loaded",function(){return r()}),e.$on("$destroy",function(){return o(window).off("onResizeEx",r)})}}}]).directive("projectCategoryMenu",["STORE",function(){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-project-menu-category",n),link:function(e,t,n){}}}]).directive("myProjectMenu",["STORE",function(){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-my-project-menu",n),link:function(e,t,n){}}}]).directive("myFollowMenu",["STORE",function(){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-my-follow-menu",n),link:function(e,t,n){}}}]).directive("projectCategoryDropdown",["STORE",function(){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-project-category-dropdown",n),link:function(e,t,n){}}}]).directive("projectSalvePanel",["$stateParams",function(e){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-project-salve-panel",n),link:function(t,n,i){var r;return r=function(e,n){var i;return n&&(i=n),t.needchange=document.body.clientWidth<1280&&window.location.href.indexOf("weekly-report")>-1,t.needchange?1===i?(t.leftViewStyle={width:"100%"},t.rightViewStyle={display:"none"},i=2):2===i?(t.leftViewStyle={display:"none"},t.rightViewStyle={width:"100%"},i=1):void 0:(t.leftViewStyle={width:"40%",display:"block"},t.rightViewStyle={display:"block"},void(i=1))},t.windowChange=function(){return r(null,null)},t.$on("project:window:change",function(e,t){return r(e,t)}),e.issue_id?r(null,2):r(null,1)}}}]).directive("projectVersionDropdown",["STORE",function(){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-project-versions-dropdown",n),link:function(e,t,n){return e.showMore="true"===n.showMore}}}]).directive("projectMenuHighlight",["$stateParams","$location",function(e,t){return{restrict:"A",link:function(e,t,n){}}}]).directive("projectMenuBar",["$rootScope","$stateParams",function(e,i){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-project-menu-bar",n),link:function(t,n,r){return t.$on("dropdown:selected",function(t,n,r){if("project:menu:manage"===n)switch(r){case"category":return e.$broadcast("issue-category:editor:show");case"version":return e.$broadcast("project:version:editor:show");case"project":return e.$broadcast("project:editor:show",i.project_id);case"webhook":return e.$broadcast("project:webhook:editor:show",i.project_id)}})}}}]).directive("projectProcessing",["$timeout",function(e){return{restrict:"A",replace:!0,link:function(t,n,i){return e(function(){return Circles.create({id:i.domId,radius:60,value:Math.round(t.project.finished_rate),maxValue:100,width:6,text:function(e){return e+"%"},colors:["#2d9ab5","#FFF"],duration:60,wrpClass:"circles-wrp",textClass:"circles-text"})},0)}}}])}.apply(t,i),!(void 0!==r&&(e.exports=r))}).call(t,n(33))},function(e,t){var n,i=window.angular;try{n=i.module(["ng"])}catch(r){n=i.module("ng",[])}var o='<div> <textarea id="tmpl-project-menu">\n        <div class="project-menu">\n            <ul class="master-menu" project-menu-highlight>\n                <li class="myself">\n                    <div class="inner">\n                        <i class="icon small"></i>\n                        <label>\n                            <a href="/{{baseLink}}/issue/myself">我相关的任务</a>\n                        </label>\n                    </div>\n                </li>\n                <li class="discussion">\n                    <div class="inner">\n                        <i class="icon small"></i>\n                        <label>\n                            <a href="/{{baseLink}}/discussion">讨论</a>\n                        </label>\n                    </div>\n                </li>\n                <li class="test">\n                    <div class="inner">\n                        <i class="icon small"></i>\n                        <label>\n                            <a href="/{{baseLink}}/test">测试专区</a>\n                        </label>\n                        <span class="badge small gray stat">{{testStat.undone || 0}}/{{testStat.all || 0}}</span>\n                    </div>\n                </li>\n                <li class="issue-category">\n                    <div class="inner">\n                        <div class="title">\n                            <i class="icon small"></i>\n                            <label>\n                                <a href="/{{baseLink}}/issue">全部任务</a>\n                            </label>\n                            \n                        </div>\n                        <project-category-menu data-project-id="{{project.id}}"></project-category-menu>\n                    </div>\n                </li>\n                <li class="document">\n                    <div class="inner">\n                        <i class="icon small"></i>\n                        <label>\n                            <a href="/{{baseLink}}/document">文档</a>\n                        </label>\n                    </div>\n                </li>\n                <li class="asset">\n                    <div class="inner">\n                        <i class="icon small"></i>\n                        <label>\n                            <a href="/{{baseLink}}/assets">素材</a>\n                        </label>\n                    </div>\n                </li>\n                <li class="member">\n                    <div class="inner">\n                        <i class="icon small"></i>\n                        <label>\n                            <a href="/{{baseLink}}/member">成员</a>\n                        </label>\n                        <a class="invite" href="javascript:void(0)" title="邀请请成员加入此项目" ng-click="onClickInvite($event)">邀请新成员</a>\n                    </div>\n                </li>\n                <li class="commit">\n                    <div class="inner">\n                        <i class="icon small"></i>\n                        <label>\n                            <a href="/{{baseLink}}/commit">Commit</a>\n                        </label>\n                    </div>\n                </li>\n                <li class="gitlab">\n                    <div class="inner">\n                        <i class="icon small"></i>\n                        <label>\n                            <a href="/{{baseLink}}/gitlab">Gitlab</a>\n                        </label>\n                    </div>\n                </li>\n                <li class="report" ng-show="project.role == \'l\'">\n                    <div class="inner">\n                        <i class="icon small"></i>\n                        <label>\n                            <a href="/{{baseLink}}/weekly-report">项目周报</a>\n                        </label>\n                    </div>\n                </li>\n                \n                <li class="stat" ng-hide="true">\n                    <div class="inner">\n                        <i class="icon small"></i>\n                        <label>\n                            <a href="/{{baseLink}}/stat">统计</a>\n                        </label>\n                    </div>\n                </li>\n                <li class="plugin" ng-hide="true">\n                    <div class="inner">\n                        <i class="icon small"></i>\n                        <label>\n                            <a href="/{{baseLink}}/plugin">插件</a>\n                        </label>\n                    </div>\n                </li>\n            </ul>\n\n            <project-menu-bar></project-menu-bar>\n            <invite-member></invite-member>\n        </div>\n    </textarea>  <textarea id="tmpl-project-menu-bar">\n        <div>\n            <div class="menu-bar">\n                \n\n                <div class="setting item" dropdown data-name="project:menu:manage">\n                    <i class="icon"></i>\n                    <span>管理工具</span>\n                    <div class="dropdown dropdown-tip dropdown-up">\n                        <ul class="dropdown-menu">\n                            <li>\n                                <a data-value="project"><span>项目设置</span></a>\n                            </li>\n                            <li>\n                                <a data-value="version"><span>版本</span></a>\n                            </li>\n                            <li>\n                                <a data-value="category"><span>任务分类</span></a>\n                            </li>\n                            <li>\n                                <a data-value="webhook"><span>Webhook</span></a>\n                            </li>\n                        </ul>\n                    </div>\n                </div>\n            </div>\n\n            <project-editor></project-editor>\n            <issue-category-editor></issue-category-editor>\n            <project-version-editor></project-version-editor>\n            <project-webhook-editor></project-webhook-editor>\n        </div>\n    </textarea>  <textarea id="tmpl-project-menu-category">\n        <ul class="sub-menu">\n            <li ng-repeat="item in projectCategory">\n                <a href="/{{item | projectLink: \'normal\'}}/category/{{item.id}}/issue?title={{item.title}}" class="text-overflow">{{item.title}}</a>\n                <span class="badge small gray stat">{{item.issue_undone_total}}/{{item.issue_total}}</span>\n            </li>\n        </ul>\n    </textarea>  <textarea id="tmpl-team-menu-category">\n        <ul class="sub-menu">\n            <li ng-repeat="item in projectCategory">\n                <a href="/{{item | projectLink: \'normal\'}}/category/{{item.id}}/issue?title={{item.title}}" class="text-overflow">{{item.title}}</a>\n                <span class="badge small gray stat">{{item.issue_undone_total}}/{{item.issue_total}}</span>\n            </li>\n        </ul>\n    </textarea>   <textarea id="tmpl-project-member-dropdown">\n        <div class="dropdown dropdown-tip members">\n            <ul class="dropdown-menu" ng-repeat="array in items">\n                \n                <li ng-repeat="item in array">\n                    <a data-value="{{item.member_id}}">\n                        {{item.realname}}\n                    </a>\n                </li>\n            </ul>\n        </div>\n    </textarea>  <textarea id="tmpl-project-category-dropdown">\n        <div class="dropdown dropdown-tip">\n            <ul class="dropdown-menu">\n                <li ng-repeat="item in projectCategory">\n                    <a data-value="{{item.id}}"><span>{{item.title}}</span></a>\n                </li>\n            </ul>\n        </div>\n    </textarea>  <textarea id="tmpl-project-versions-dropdown">\n        <div class="dropdown dropdown-tip">\n            <ul class="dropdown-menu">\n                <li ng-repeat="item in projectVersion">\n                    <a data-value="{{item.id}}"><span>{{item.title}}</span></a>\n                </li>\n                <li ng-show="showMore">\n                    <a data-value="all"><span>全部版本</span></a>\n                </li>\n            </ul>\n        </div>\n    </textarea>  <textarea id="tmpl-project-tiles">\n        <ul class="project-tiles" project-tile-resize>\n            <li class="create tile" ng-click="onClickCreate()">\n                <i class="icon"></i>\n            </li>\n\n            <li class="tile" ng-repeat="project in projects.items" ng-click="onClickTile($event, project)" ng-class="{true: \'favorite\'}[project.favorite > 0]" title="{{project.description}}">\n               <div class="title">\n                   {{project.title}}\n                   <i class="icon small favorite"></i>\n               </div>\n\n               <div class="processing" project-processing data-dom-id="project-tile-{{project.id}}" id="project-tile-{{project.id}}">\n                \n               </div>\n\n               <div class="tile-toolbar">\n                   <div class="description">{{project.description || \'无项目说明\' | limitTo: 38}}</div>\n                   <ul class="menu">\n                       <li class="sub-menu favorite">\n                           <button class="default" ng-click="onClickFavorite($event, project)">\n                               <i class="small icon"></i>\n                               <span ng-show="project.favorite == 0">收藏</span>\n                               <span ng-show="project.favorite > 0">取消</span>\n                           </button>\n                       </li>\n                       <li class="sub-menu edit" ng-show="project.role == \'l\'">\n                           <button class="default" ng-click="onClickEdit($event, project)">\n                            <i class="small icon"></i>\n                               编辑\n                           </button>\n                       </li>\n                       <li class="sub-menu remove" ng-show="project.role == \'l\'">\n                           <button class="default" ng-click="onClickDelete($event, project)">\n                               <i class="small icon"></i>\n                               删除\n                           </button>\n                       </li>\n                   </ul>\n               </div>\n            </li>\n        </ul>\n    </textarea>  <textarea id="tmpl-project-layout">\n        <div class="frame project-view">\n            <global-message ng-show="false"></global-message>\n            <header-global data-project="project" data-projectversion="{{projectVersion}}"></header-global>\n            <div class="container">\n                \n                <div class="master-panel">\n                    <project-menu></project-menu>\n                </div>\n                <project-salve-panel></project-salve-panel>\n\n            </div>\n        </div>\n    </textarea>  <textarea id="tmpl-project-salve-panel">\n        <div class="salve-panel">\n            <div class="list-panel" ui-view="listPanel" ng-style="leftViewStyle"></div>\n         \n            <div class="details-panel full" ui-view="detailsPanel" ng-style="rightViewStyle"></div>\n        </div>\n    </textarea>  <textarea id="tmpl-my-project-layout">\n        <div class="frame project-view team-view portal">\n            <global-message ng-show="false"></global-message>\n            <header-global></header-global>\n            <div class="container">\n                \n                <div class="master-panel">\n                    \n                    <div class="project-menu">\n                        <ul class="master-menu" project-menu-highlight>\n                            <li class="issue-category">\n                                <div class="inner">\n                                    <div class="title">\n                                        <label>\n                                            <a href="/myproject/all/issue/myself?title=我的所有任务">所有任务</a>\n                                        </label>\n                                    </div>\n                                </div>\n                            </li>\n                            <li class="issue-category">\n                                <div class="inner">\n                                    <div class="title">\n                                        <label>\n                                            <a>我的项目</a>\n                                        </label>\n                                    </div>\n                                    <div ng-show="projects.items.length == 0" class="empty ng-binding">\n                                        尚未参加任何项目\n                                    </div>\n                                    <my-project-menu></my-project-menu>\n                                </div>\n                            </li>\n                        </ul>\n                    </div>\n                </div>\n                <project-salve-panel></project-salve-panel>\n            </div>\n        </div>\n    </textarea> <textarea id="tmpl-my-project-menu">\n        <ul class="sub-menu">\n            <li ng-repeat="item in projects.items">\n                <a title="{{item.title}}" href="/myproject/{{item.id}}/issue/myself?title={{item.title}}" class="text-overflow">\n                    {{item.title}}\n                </a>\n                <span class="badge small gray stat">{{item.undone_task_total}}/{{item.task_total}}</span>\n            </li>\n        </ul>\n    </textarea>  <textarea id="tmpl-my-follow-layout">\n        <div class="frame project-view team-view">\n            <global-message ng-show="false"></global-message>\n            <header-global></header-global>\n            <div class="container">\n                \n                <div class="master-panel">\n                    \n                    <div class="project-menu">\n                        <ul class="master-menu" project-menu-highlight>\n                            <li class="issue-category">\n                                <div class="inner">\n                                    <div class="title">\n                                        <label>\n                                            <a href="/myfollow/all/issue/follow?title=我的关注">所有关注</a>\n                                        </label>\n                                    </div>\n                                </div>\n                            </li>\n                            <li class="issue-category">\n                                <div class="inner">\n                                    <div class="title">\n                                        <label>\n                                            <a>我的项目</a>\n                                        </label>\n                                    </div>\n                                    <div ng-show="projects.items.length == 0" class="empty ng-binding">\n                                        尚未参加任何项目\n                                    </div>\n                                    <my-follow-menu></my-follow-menu>\n                                </div>\n                            </li>\n                        </ul>\n                    </div>\n                </div>\n                <project-salve-panel></project-salve-panel>\n            </div>\n        </div>\n    </textarea> <textarea id="tmpl-my-follow-menu">\n        <ul class="sub-menu">\n            <li ng-repeat="item in projects.items">\n                <a class="text-overflow wide" href="/myfollow/{{item.id}}/issue/follow?title={{item.title}}" class="text-overflow">{{item.title}}</a>\n            </li>\n        </ul>\n    </textarea> </div>';
n.run(["$templateCache",function(e){e.put("project-all.html",o)}]),e.exports=o},function(e,t){var n,i=window.angular;try{n=i.module(["ng"])}catch(r){n=i.module("ng",[])}var o='<div>   <textarea id="tmpl-project-editor">\n        <div class="modal project-editor">\n            <div class="inner">\n                <a class="close-modal" rel="modal:close"><i class="icon"></i></a>\n                <header>\n                    {{editor_title}}项目\n                </header>\n                <section>\n                    <form class="standard-form">\n                        <div class="row">\n                            <label class="caption">\n                                项目名称\n                            </label>\n                            <input class="medium text" type="text" ng-model="data.title" maxlength="40"/>\n                        </div>\n\n                        <div class="row">\n                            <label class="caption">\n                                摘要说明\n                            </label>\n\n                            \n                            &lt;textarea class="medium text" placeholder="简单描述项目" ng-model="data.description">{{data.description}}&lt;/textarea>\n                        </div>\n\n                        <div class="row">\n                            <label class="caption">\n                                项目状态\n                            </label>\n                            <div class="inline">\n                                <label>\n                                    <input type="radio" value="active" name="status" ng-model="data.status"/> 活动\n                                </label>\n\n                                <label>\n                                    <input type="radio" value="archive" name="status" ng-model="data.status"/> 存档\n                                </label>\n                            </div>\n                        </div>\n\n                        <div class="row">\n                            <label class="caption">\n                                访问级别\n                            </label>\n                            <div class="inline">\n                                <label>\n                                    <input type="radio" value="0" name="visibility_level" ng-model="data.visibility_level"/> 私有\n                                </label>\n\n                                <label>\n                                    <input type="radio" value="10" name="visibility_level" ng-model="data.visibility_level"/> 团队内\n                                </label>\n                                <label>\n                                    <input type="radio" value="20" name="visibility_level" ng-model="data.visibility_level"/> 公开\n                                </label>\n                            </div>\n                        </div>\n\n                        <div class="row control">\n                            <button class="primary default" ng-click="onClickSave()">保存</button>\n                            <button class="cancel default" ng-click="onClickCancel()">取消</button>\n                            <button class="delete default" ng-click="onClickDelete()" ng-show="data.id">删除</button>\n                        </div>\n                    </form>\n                </section>\n            </div>\n        </div>\n    </textarea>  <textarea id="tmpl-issue-category-editor">\n        <div class="modal issue-category-editor">\n            <div class="inner">\n                <a class="close-modal" rel="modal:close"><i class="icon"></i></a>\n                <header>\n                    任务分类管理\n                </header>\n                <section>\n                    <form class="standard-form">\n                        <div class="row">\n                            <table class="standard-table full simple-line">\n                                <tr ng-repeat="item in category">\n                                    <td>{{item.title}}</td>\n                                    <td>{{item.short_title}}</td>\n                                    <td>{{item.issue_undone_total}}/{{item.issue_total}}</td>\n                                    <td class="right">\n                                        <a href="javascript:void(0)" ng-click="onClickEdit($event, item)">编辑</a> |\n                                        <a href="javascript:void(0)" ng-click="onClickDelete($event, item)">删除</a>\n                                    </td>\n                                </tr>\n                            </table>\n                        </div>\n                        <div class="row">\n                            <label class="caption">\n                                分类名称\n                            </label>\n                            <input class="medium text" type="text" ng-model="editModel.title" maxlength="20"/>\n                        </div>\n\n                        <div class="row">\n                            <label class="caption">\n                                别名\n                            </label>\n                            <input class="medium text" type="text" ng-model="editModel.short_title" maxlength="10" placeholder="别名用于git commit指令指定分类用"/>\n                        </div>\n                        <div class="row control">\n                            <button class="primary default" ng-click="onClickSave()">保存</button>\n                            <button class="cancel default" ng-click="onClickCancel()">取消</button>\n                        </div>\n                    </form>\n                </section>\n            </div>\n        </div>\n    </textarea>  <textarea id="tmpl-project-version-editor">\n        <div class="modal project-version-editor">\n            <div class="inner">\n                <a class="close-modal" rel="modal:close"><i class="icon"></i></a>\n                <header>\n                    版本管理\n                </header>\n                <section>\n                    <table class="standard-table full simple-line">\n                        <thead>\n                        <tr class="left">\n                            <th>名称</th>\n                            <th>别名</th>\n                            <th>状态</th>\n                            <th class="right">操作</th>\n                        </tr>\n                        </thead>\n                        <tr ng-repeat="item in version">\n                            <td>{{item.title}}</td>\n                            <td>{{item.short_title}}</td>\n                            <td class="status {{item.status}}">{{item.status}}</td>\n                            <td class="right">\n                                <span ng-show="item.status == \'deactive\'">\n                                    <a href="javascript:void(0)" title="存档后，将不会显示在版本列表中" ng-click="onChangeStatus($event, item, \'archive\')">存档</a> |\n                                </span>\n\n                                <span ng-show="item.status == \'deactive\'">\n                                    <a href="javascript:void(0)" title="将此版本设置为活动版本" ng-click="onChangeStatus($event, item, \'active\')">激活</a> |\n                                </span>\n\n                                <a href="javascript:void(0)" ng-click="onClickEdit($event, item)">编辑</a> |\n                                <a href="javascript:void(0)" ng-click="onClickDelete($event, item)">删除</a>\n                            </td>\n                        </tr>\n                    </table>\n                    <form class="standard-form">\n                        <div class="row">\n                            <label class="caption">\n                                版本名称\n                            </label>\n                            <input class="medium text" type="text" ng-model="editModel.title" maxlength="20"/>\n                        </div>\n\n                        \n\n                        <div class="row">\n                            <label class="caption">\n                                别名\n                            </label>\n                            <input class="medium text" type="text" ng-model="editModel.short_title" maxlength="5" placeholder="用于git commit，建议英文或者数字"/>\n                        </div>\n                        <div class="row control">\n                            <button class="primary default" ng-click="onClickSave()">保存</button>\n                            <button class="cancel default" ng-click="onClickCancel()">取消</button>\n                        </div>\n                    </form>\n                </section>\n            </div>\n        </div>\n    </textarea>  <textarea id="tmpl-project-webhook-editor">\n        <div class="modal project-webhook-editor">\n            <div class="inner">\n                <a class="close-modal" rel="modal:close"><i class="icon"></i></a>\n                <header>\n                    webhook管理\n                </header>\n                <section>\n                    <table class="standard-table full simple-line">\n                        <thead>\n                        <tr class="left">\n                            <th>类型</th>\n                            <th>URL</th>\n                            <th class="right">操作</th>\n                        </tr>\n                        </thead>\n                        <tr ng-repeat="item in webhook">\n                            <td>{{item.trigger}}</td>\n                            <td>{{item.url}}</td>\n                            <td class="right">\n                                <a href="javascript:void(0)" ng-click="onClickEdit($event, item)">编辑</a> |\n                                <a href="javascript:void(0)" ng-click="onClickDelete($event, item)">删除</a>\n                            </td>\n                        </tr>\n                        <tr ng-if="webhook.length == 0">\n                            <td colspan="4">暂无webhook</td>\n                        </tr>\n                    </table>\n                    <form class="standard-form">\n                        <div class="row">\n                            <label class="caption">\n                                类型\n                            </label>\n                            issue<input type="radio" name="trigger" value="issue" ng-model="editModel.trigger"/>\n                            comment<input type="radio" name="trigger" value="comment" ng-model="editModel.trigger"/>\n                            mention<input type="radio" name="trigger" value="mention" ng-model="editModel.trigger"/>\n                        </div>\n\n\n                        <div class="row">\n                            <label class="caption">\n                                URL\n                            </label>\n                            <input class="medium text" type="text" ng-model="editModel.url" placeholder=""/>\n                        </div>\n                        <div class="row control">\n                            <button class="primary default" ng-click="onClickSave()">保存</button>\n                            <button class="cancel default" ng-click="onClickCancel()">取消</button>\n                        </div>\n                    </form>\n                </section>\n            </div>\n        </div>\n    </textarea> </div>';n.run(["$templateCache",function(e){e.put("project-editors.html",o)}]),e.exports=o},function(e,t){!function(){var e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeout(e,1e3/60)},t=window.Circles=function(e){var t=e.id;if(this._el=document.getElementById(t),null!==this._el){this._radius=e.radius||10,this._duration=void 0===e.duration?500:e.duration,this._value=0,this._maxValue=e.maxValue||100,this._text=void 0===e.text?function(e){return this.htmlifyNumber(e)}:e.text,this._strokeWidth=e.width||10,this._colors=e.colors||["#EEE","#F00"],this._svg=null,this._movingPath=null,this._wrapContainer=null,this._textContainer=null,this._wrpClass=e.wrpClass||"circles-wrp",this._textClass=e.textClass||"circles-text";var n=Math.PI/180*270;this._start=-Math.PI/180*90,this._startPrecise=this._precise(this._start),this._circ=n-this._start,this._generate().update(e.value||0)}};t.prototype={VERSION:"0.0.5",_generate:function(){return this._svgSize=2*this._radius,this._radiusAdjusted=this._radius-this._strokeWidth/2,this._generateSvg()._generateText()._generateWrapper(),this._el.innerHTML="",this._el.appendChild(this._wrapContainer),this},_setPercentage:function(e){this._movingPath.setAttribute("d",this._calculatePath(e,!0)),this._textContainer.innerHTML=this._getText(this.getValueFromPercent(e))},_generateWrapper:function(){return this._wrapContainer=document.createElement("div"),this._wrapContainer.className=this._wrpClass,this._wrapContainer.style.position="relative",this._wrapContainer.style.display="inline-block",this._wrapContainer.appendChild(this._svg),this._wrapContainer.appendChild(this._textContainer),this},_generateText:function(){this._textContainer=document.createElement("div"),this._textContainer.className=this._textClass;var e={position:"absolute",top:0,left:0,textAlign:"center",width:"100%",fontSize:.7*this._radius+"px",height:this._svgSize+"px",lineHeight:this._svgSize+"px"};for(var t in e)this._textContainer.style[t]=e[t];return this._textContainer.innerHTML=this._getText(0),this},_getText:function(e){return this._text?(void 0===e&&(e=this._value),e=parseFloat(e.toFixed(2)),"function"==typeof this._text?this._text.call(this,e):this._text):""},_generateSvg:function(){return this._svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this._svg.setAttribute("xmlns","http://www.w3.org/2000/svg"),this._svg.setAttribute("width",this._svgSize),this._svg.setAttribute("height",this._svgSize),this._generatePath(100,!1,this._colors[0])._generatePath(1,!0,this._colors[1]),this._movingPath=this._svg.getElementsByTagName("path")[1],this},_generatePath:function(e,t,n){var i=document.createElementNS("http://www.w3.org/2000/svg","path");return i.setAttribute("fill","transparent"),i.setAttribute("stroke",n),i.setAttribute("stroke-width",this._strokeWidth),i.setAttribute("d",this._calculatePath(e,t)),this._svg.appendChild(i),this},_calculatePath:function(e,t){var n=this._start+e/100*this._circ,i=this._precise(n);return this._arc(i,t)},_arc:function(e,t){var n=e-.001,i=e-this._startPrecise<Math.PI?0:1;return["M",this._radius+this._radiusAdjusted*Math.cos(this._startPrecise),this._radius+this._radiusAdjusted*Math.sin(this._startPrecise),"A",this._radiusAdjusted,this._radiusAdjusted,0,i,1,this._radius+this._radiusAdjusted*Math.cos(n),this._radius+this._radiusAdjusted*Math.sin(n),t?"":"Z"].join(" ")},_precise:function(e){return Math.round(1e3*e)/1e3},htmlifyNumber:function(e,t,n){t=t||"circles-integer",n=n||"circles-decimals";var i=(e+"").split("."),r='<span class="'+t+'">'+i[0]+"</span>";return i.length>1&&(r+='.<span class="'+n+'">'+i[1].substring(0,2)+"</span>"),r},updateRadius:function(e){return this._radius=e,this._generate().update(!0)},updateWidth:function(e){return this._strokeWidth=e,this._generate().update(!0)},updateColors:function(e){this._colors=e;var t=this._svg.getElementsByTagName("path");return t[0].setAttribute("stroke",e[0]),t[1].setAttribute("stroke",e[1]),this},getPercent:function(){return 100*this._value/this._maxValue},getValueFromPercent:function(e){return this._maxValue*e/100},getValue:function(){return this._value},getMaxValue:function(){return this._maxValue},update:function(t,n){if(t===!0)return this._setPercentage(this.getPercent()),this;if(this._value==t||isNaN(t))return this;void 0===n&&(n=this._duration);var i,r,o,a,s=this,l=s.getPercent(),c=1;return this._value=Math.min(this._maxValue,Math.max(0,t)),n?(i=s.getPercent(),r=i>l,c+=i%1,o=Math.floor(Math.abs(i-l)/c),a=n/o,function d(t){if(r?l+=c:l-=c,r&&l>=i||!r&&i>=l)return void e(function(){s._setPercentage(i)});e(function(){s._setPercentage(l)});var n=Date.now(),o=n-t;o>=a?d(n):setTimeout(function(){d(Date.now())},a-o)}(Date.now()),this):(this._setPercentage(this.getPercent()),this)}},t.create=function(e){return new t(e)}}()},function(e,t,n){var i,r;(function(o){"use strict";i=[n(38),n(44),n(52)],r=function(e,t,n){return e.directiveModule.directive("projectEditor",["$rootScope","$location","API","NOTIFY",function(e,i,r,a){return{restrict:"E",replace:!0,scope:{},template:t.extractTemplate("#tmpl-project-editor",n),link:function(t,n,i){var s,l;return s=o(n),l=function(e){var t;return t={get_role:!0},r.project(e).retrieve(t)},t.onClickDelete=function(e,t){return confirm("您确定将要删除这个项目吗？")?r.project(t).update({status:"trash"}).then(function(){return o.modal.close(),a.success("删除成功，刷新项目列表（功能未开发）")}):void 0},t.onClickSave=function(){var n;return t.data.title?(n=t.data.id?"update":"create",r.project(t.data.id)[n](t.data).then(function(i){return a.success("项目信息保存成功"),o.modal.close(),e.$broadcast("project:change",n,t.data.id||i.id)})):a.error("项目名称必需输入")},t.onClickCancel=function(){return o.modal.close(),!1},t.$on("project:editor:show",function(e,n){return t.editor_title="新建",t.contextName="project",t.data={status:"active"},n?l(n).then(function(e){return"l"!==e.role?a.error("您没有权限修改此项目"):(t.editor_title="编辑",t.data={id:e.id,title:e.title,description:e.description,visibility_level:e.visibility_level,status:e.status},s.modal({showClose:!1}))}):s.modal({showClose:!1})}),t.$on("project:editor:hide",function(){return $model.close()})}}}]).directive("issueCategoryEditor",["$stateParams","$location","API","NOTIFY",function(e,i,r,a){return{restrict:"E",replace:!0,scope:{},template:t.extractTemplate("#tmpl-issue-category-editor",n),link:function(t,n,i){var s,l,c;return t.editModel={},c=r.project(e.project_id),s=o(n),l=function(e){return c.category().retrieve().then(function(n){return t.category=n,"function"==typeof e?e():void 0})},t.onClickSave=function(){var e,n;return t.editModel.title?(n=t.editModel.short_title,n&&!/^[\w\d_]+$/i.test(n)?void a.warn("别名只能是英文数字和下划线"):(e=t.editModel.id?"update":"create",c.category(t.editModel.id)[e](t.editModel).then(function(){return a.success("分类保存成功"),l(),t.editModel={}}))):void a.warn("分类名称必需输入")},t.onClickDelete=function(e,n){return confirm("您确定要删除这个分类么？")?c.category(n.id)["delete"]().then(function(){return a.success("删除分类成功"),l(),t.editModel.id===n.id?t.editModel={}:void 0}):void 0},t.onClickEdit=function(e,n){t.editModel=_.pick(n,"id","title","short_title")},t.onClickCancel=function(){o.modal.close()},t.$on("issue-category:editor:show",function(e){return l(function(){return s.modal({showClose:!1})})}),t.$on("issue-category:editor.hide",function(){return o.modal.close()})}}}]).directive("projectVersionEditor",["$stateParams","$location","API","NOTIFY",function(e,i,r,a){return{restrict:"E",replace:!0,scope:{},template:t.extractTemplate("#tmpl-project-version-editor",n),link:function(t,n,i){var s,l,c;return t.editModel={},c=r.project(e.project_id),s=o(n),l=function(e){return c.version().retrieve().then(function(n){return t.version=n,"function"==typeof e?e():void 0})},t.onClickSave=function(){var e,n;return t.editModel.title?(n=t.editModel.short_title,n&&!/^[\w\d_]+$/i.test(n)?void a.warn("别名只能是英文数字和下划线"):(e=t.editModel.id?"update":"create",c.version(t.editModel.id)[e](t.editModel).then(function(){return a.success("版本保存成功"),l(),t.editModel={}}))):void a.warn("版本名称必需输入")},t.onChangeStatus=function(e,t,n){return c.version(t.id).update({status:n}).then(function(){}),a.success("状态修改成功"),l()},t.onClickDelete=function(e,n){return confirm("您确定要删除这个版本么？")?c.version(n.id)["delete"]().then(function(){return a.success("删除版本成功"),l(),t.editModel.id===n.id?t.editModel={}:void 0}):void 0},t.onClickEdit=function(e,n){t.editModel=_.pick(n,"id","title","short_title","status")},t.onClickCancel=function(){o.modal.close()},t.$on("project:version:editor:show",function(e){return l(function(){return s.modal({showClose:!1})})}),t.$on("project:version:editor.hide",function(){return o.modal.close()})}}}]).directive("projectWebhookEditor",["$stateParams","$location","API","NOTIFY",function(e,i,r,a){return{restrict:"E",replace:!0,scope:{},template:t.extractTemplate("#tmpl-project-webhook-editor",n),link:function(t,n,i){var s,l,c;return t.editModel={trigger:"issue"},c=r.project(e.project_id),s=o(n),l=function(e){return c.webhook().retrieve().then(function(n){return t.webhook=n,"function"==typeof e?e():void 0})},t.onClickSave=function(){var e;return t.editModel.url?(e=t.editModel.id?"update":"create",c.webhook(t.editModel.id)[e](t.editModel).then(function(){return a.success("保存成功"),l(),t.editModel={trigger:"issue"}})):a.warn("必须输入URL")},t.onClickEdit=function(e,n){return t.editModel=_.pick(n,"id","trigger","url")},t.onClickDelete=function(e,n){return confirm("您确定要删除么？")?c.webhook(n.id)["delete"]().then(function(){return a.success("删除成功"),l(),t.editModel.id===n.id?t.editModel={}:void 0}):void 0},t.onClickCancel=function(){o.modal.close()},t.$on("project:webhook:editor:show",function(e){return l(function(){return s.modal({showClose:!1})})})}}}])}.apply(t,i),!(void 0!==r&&(e.exports=r))}).call(t,n(33))},function(e,t,n){var i,r;i=[n(56),n(60),n(61),n(63)],r=function(){}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;(function(o){i=[n(38),n(44),n(57),n(58)],r=function(e,t,i,r){return e.directiveModule.directive("issueListCell",["$rootScope","$location","$filter","API",function(e,n,r,o){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-issue-list-cell",i),link:function(e,t,i){return e.onClickIssue=function(t,i){var o;return n.$$url.indexOf("/myproject/")>-1?n.path(n.$$url.split("?")[0].split("/myself")[0]+"/myself/"+i.id):n.$$url.indexOf("/myfollow/")>-1?n.path(n.$$url.split("?")[0].split("/follow")[0]+"/follow/"+i.id):(o=r("projectLink")(i,i.tag),n.path(o+"/"+i.id)),e.$emit("project:window:change",2)},e.onClickStatus=function(t,n){e.$emit("issue:status-dropdown:show",t,n)},e.getDelayClass=function(e){return e.plan_finish_time&&"done"!==e.status&&e.plan_finish_time<(new Date).valueOf()?"delay":""},e.$on("dropdown:selected",function(t,n,i){return"issue:status"===n?o.project(e.issue.project_id).issue(e.issue.id).update({status:i}).then(function(){return e.$emit("issue:change","status",e.issue.id)}):void 0})}}}]).directive("issuePriorityDropdown",[function(){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-issue-priority-dropdown",i),link:function(e,t,n){}}}]).directive("issueStatusDropdown",[function(){return{restrict:"E",replace:!0,scope:{},template:t.extractTemplate("#tmpl-issue-status-dropdown",i),link:function(e,t,n){}}}]).directive("issueSplitStatusDropdown",[function(){return{restrict:"E",replace:!0,scope:{},template:t.extractTemplate("#tmpl-issue-status-dropdown",i),link:function(e,t,n){}}}]).directive("issueStatusDropdownAction",[function(){return{restrict:"A",replace:!1,link:function(e,t,n){var i,r,a,s;return i=null,r=null,e.$on("issue:status-dropdown:show",function(e,t,n){var a,l;t.stopPropagation(),r=n,s(n),a=o(t.target),l=a.position(),l.top+=a.height(),l.left-=6,i.css(l).fadeIn(),o("body").one("click",function(){return i.fadeOut()})}),a=function(){return i?void 0:(i=o(t).find("div.dropdown.status"),i.bind("mouseleave",function(){return i.fadeOut()}),i.find("a").bind("click",function(){var t,n,i;return t=o(this),i=t.attr("data-value"),n=null!=r.issue_id,e.$emit("issue:status:change",r.id,r.status,i,n)}))},s=function(e){var t,n,r,s;return n="test"===e.tag,t={doing:!0,pause:"done"!==e.status,repaired:n&&"repairing"===e.status,repairing:n&&("doing"===(r=e.status)||"reviewing"===r||"repaired"===r),reviewing:n&&("doing"===(s=e.status)||"repairing"===s||"repaired"===s),done:!n&&"done"!==e.status,reviewed:n&&"reviewing"===e.status},a(),i.find("li").each(function(){var e,n;return e=o(this),n=e.attr("data-status"),e.toggle(t[n])})}}}}]).directive("issueQuickEditor",["$rootScope","$state","$stateParams","$location","$timeout","API","NOTIFY",function(e,n,i,r,o,a,s){return{restrict:"A",replace:!0,link:function(n,l,c){var d,u;return u={issue:"任务",document:"文档",discussion:"讨论",test:"测试"},d=function(t){var n;return n=r.$$path.replace(/(.+)(\/\d+)$/,"$1")+"/"+t,r.path(n),o(function(){return e.$broadcast("issue:editor:show")},1e3)},n.onKeyDown=function(e){var r,o;if(13===e.keyCode&&(o=t.trim(e.target.value)))return r={tag:c.tag,title:o,category_id:i.category_id,version_id:i.version_id},a.project(n.project.id).issue().create(r).then(function(t){return s.success("创建"+u[c.tag]+"成功"),e.target.value=null,n.$emit("issue:change",{status:"new",tag:c.tag,id:t.id}),d(t.id)})},n.createForm=function(e){return e=i.category_id,n.$broadcast("issue:form:show",-1,e)}}}}]).directive("issueLog",["$stateParams","API",function(e,n){return{restrict:"E",replace:!0,scope:{},template:t.extractTemplate("#tmpl-issue-log",i),link:function(t,i,r){return n.project(e.project_id).issue(e.issue_id).log().retrieve().then(function(e){return t.logs=e.items})}}}]).directive("issueTagDropdown",["$stateParams","API","NOTIFY",function(e,n,r){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-issue-tag-dropdown",i),link:function(t,i,o){return t.$on("dropdown:selected",function(t,i,o){return"issue:tag"===i?n.project(e.project_id).issue(e.issue_id).update({tag:o}).then(function(){return r.success("修改成功")}):void 0})}}}]).directive("issuePlainList",[function(){return{restrict:"E",replace:!0,scope:{title:"@",emptyMemo:"@",showDetails:"@",needPagination:"@",uuid:"@"},template:t.extractTemplate("#tmpl-issue-plain-list",i),link:function(e,t,n){return e.emptyMemo=e.emptyMemo||e.title+"的任务为空",e.onClickToggle=function(){return e.showDetails=!e.showDetails},n.$observe("source",function(){return n.source?e.source=JSON.parse(n.source):void 0})}}}]).directive("issueForm",["$rootScope","$stateParams","$compile","API","NOTIFY",function(e,n,i,o,a){return{restrict:"E",replace:!0,scope:{type:"@",issue:"@",editflag:"@",change:"@"},link:function(e,s,l){return-1!==e.issue&&null!==n.issue_id&&o.project(n.project_id).issue(n.issue_id).retrieve().then(function(n){var o,a;if("form"===n.tag)return e.entity=JSON.parse(n.content),e.title=n.title,a=e.entity.uuid,o=t.extractTemplate(["#temp-form-head","#tmpl-issue-form-"+a,"#temp-form-foot"],r),o=o.replace(/&lt;/g,"<").replace(/&gt;/g,">"),s.html(o),i(s.contents())(e)}),e.editable="-1"!==e.editflag,e.$on("issue:form:submit",function(t){var i,r,s,l;return e.myForm.$valid?(l={tag:"form",title:e.entity.name+"-"+e.entity.department+"-"+e.entity.title,category_id:n.category_id,content:JSON.stringify(e.entity)},e.entity.name||(l.title=e.entity.title),i="-1"===e.issue,r=o.project(n.project_id).issue(i?"":n.issue_id),s=i?"create":"update",r[s](l).then(function(){return a.success("保存"+l.title+"成功"),e.$emit("issue:list:reload"),e.$emit("issue:form:hide")})):void a.error("请检查必填项是否漏填！")}),e.$on("issue:form:change",function(a,l,c){var d;if("-1"!==e.change)return e.editable="-1"!==e.editflag,d=t.extractTemplate(["#temp-form-head","#tmpl-issue-form-"+c,"#temp-form-foot"],r),d=d.replace(/&lt;/g,"<").replace(/&gt;/g,">"),s.html(d),e.entity={},-1!==l?o.project(n.project_id).issue(n.issue_id).retrieve().then(function(t){return e.entity=JSON.parse(t.content),e.title=t.title}):e.entity.uuid=c,i(s.contents())(e)})}}}]).directive("issueFormModal",["$timeout",function(e){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-issue-form-modal",r),scope:{},link:function(t,n,i){return t.btname=1,t.issueId=-1,t.onClickSubmit=function(){return t.$broadcast("issue:form:submit")},t.onClickCancel=function(){return t.$emit("issue:form:hide")},t.$on("issue:form:show",function(i,r,a){var s;return t.activeIndex=a,t.issueId=r,s=o(n),e(function(){return s.modal({showClose:!1})},200),t.$broadcast("issue:form:change",r,a)}),t.$on("issue:form:hide",function(e){return o.modal.close()})}}}]).directive("windowChangeButton",[function(){return{restrict:"E",replace:!0,template:"<button class='primary default' ng-click='windowChange()'>返回列表</button>",scope:{},link:function(e,t,n){return e.windowChange=function(){return e.$emit("project:window:change",1)}}}}]).directive("uploadDocx",["$rootScope","$stateParams","API","NOTIFY",function(e,t,i,r){return{restrict:"A",replace:!0,link:function(i,o,a){var s,l;return s=function(e,t){var n,i;return n=Math.pow(2,28),i=Math.pow(2,30),e.size>n?confirm("上传大文件浏览器可能会出现卡死的情况，你确定要上传么"):e.size>i?(alert("上传文件不能超过"+i/1024/1024+"M"),!1):!0},l=function(n,i){return 0===n.length?void r.warn("无可上传的文件"):FileAPI.upload({url:"/api/project/"+t.project_id+"/"+t.version_id+"/"+t.category_id+"/issue/create/assets",files:{assets:n},complete:function(t,n){return t?r.error("文件上传失败"):(r.success("所有文件已经上传成功啦"),e.$broadcast("issue:list:reload"))},progress:function(e,t,n,i){}})},n.e(2,function(e){var t=[e(59)];(function(){var e;return e=o[0],FileAPI.event.on(e,"change",function(e){var t;return t=FileAPI.getFiles(e),FileAPI.filterFiles(t,s,l)})}).apply(null,t)})}}}]).directive("issueFollowMemberDropdown",["API","NOTIFY",function(e,n){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-issue-follow-member-dropdown",i),link:function(i,r,o){var a;return a=!1,o.$observe("items",function(){return!a&&o.items?(a=!0,i.items=t.toDyadicArray(JSON.parse(o.items),15)):void 0}),i.$on("dropdown:selected",function(t,r,o){return"issue:follow"===r?e.project(i.issue.project_id).issue(i.issue.id).follow().create({member_id:o}).then(function(e){return i.$emit("issue:follow:change"),n.success("关注成功")}):void 0})}}}]).directive("issueFollowMembers",["$stateParams","API","NOTIFY",function(e,n,r){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-issue-follow-members",i),link:function(t,i,o){var a,s;return a=n.project(e.project_id).issue(e.issue_id).follow(),s=function(){return a.retrieve().then(function(e){return t.followMembers=e})},t.removeFollow=function(e){return a["delete"]({id:e.member_id}).then(function(e){return t.$emit("issue:follow:change"),r.success("取消关注成功")})},t.$on("issue:follow:change",function(e){return s()}),s()}}}]).directive("issueFollowIcon",["$stateParams","API","NOTIFY",function(e,n,r){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-issue-follow-icon",i),link:function(t,i,o){var a;return a=n.project(e.project_id).issue(e.issue_id).follow(),t.clickFollow=function(e){return 1===e?a["delete"]().then(function(e){return t.$emit("issue:follow:change"),t.issue.follow=0,r.success("取消关注成功")}):a.create().then(function(e){return t.$emit("issue:follow:change"),t.issue.follow=1,r.success("关注成功")})}}}}]).directive("issueSplit",["$rootScope","$stateParams","$timeout","API","NOTIFY",function(e,n,r,a,s){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-issue-split",i),link:function(t,i,l){var c;return c=a.project(n.project_id).issue(n.issue_id),t.recentSplit={},t.$on("datetime:change",function(t,n,i){return-1!==n.indexOf("plan_finish_time_")?c.split(n.split("_").pop()).update({plan_finish_time:i}).then(function(t){return t?e.$broadcast("issue:detail:reload"):void 0}):void 0}),t.blur=function(){return t.splitShow=!1,t.recentSplit={}},t.splitSave=function(){var n,i;if(13===event.keyCode)return i=c.split(),t.recentSplit.id&&(i=c.split(t.recentSplit.id)),n=t.recentSplit.id?"update":"create",i[n](t.recentSplit).then(function(n){return s.success("保存成功"),t.recentSplit={},e.$broadcast("issue:detail:reload")})},t.splitEdit=function(e){return r(function(){return o("#split-text").focus()},100),t.splitShow=!0,t.recentSplit=e},t.splitDelete=function(t){return confirm("您确定要删除这个子任务吗？")?c.split(t.id)["delete"]().then(function(t){return t?e.$broadcast("issue:detail:reload"):void 0}):void 0}}}}]).directive("issueSplitMemberDropdown",["$stateParams","API","NOTIFY",function(e,n,r){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-issue-split-member-dropdown",i),link:function(i,r,o){var a;return a=!1,o.$observe("items",function(){return!a&&o.items?(a=!0,i.items=t.toDyadicArray(JSON.parse(o.items),15)):void 0;
}),i.$on("dropdown:selected",function(t,i,r){return-1!==i.indexOf("issue:split")?n.project(e.project_id).issue(e.issue_id).split(i.split(":").pop()).update({owner:r}).then(function(){}):void 0})}}}])}.apply(t,i),!(void 0!==r&&(e.exports=r))}).call(t,n(33))},function(e,t){var n,i=window.angular;try{n=i.module(["ng"])}catch(r){n=i.module("ng",[])}var o='<div>  <textarea id="tmpl-issue-list-cell">\n        <div class="row" ng-class="getDelayClass(issue)" ng-click="onClickIssue($event, issue)">\n            <div class="body">\n                <div class="issue-status" data-selected="{{issue.status}}" data-name="issue:status" ng-click="onClickStatus($event, issue)">\n                    <i class="icon small" ng-class="issue.status" ng-click="clickStatus()"></i>\n                </div>\n                <i class="priority" ng-class="\'priority-\' + issue.priority" ng-click="clickPriority()"></i>\n                <a class="title" ng-bind-html="issue.title | removeCommand | removeTag | highlightKeyword: condition.keyword | unsafe"></a>\n            </div>\n            <div class="info">\n                <span class="issue-id memo">#{{issue.id}}</span>\n                <span class="member memo">责任人：{{(issue.owner_name) || \'未分配\'}}</span>\n                <span class="date memo" title="实际完成时间">实际完成：{{(issue.finish_time | date) || \'未完成\'}}</span>\n                <span class="date memo" title="计划完成时间"> 计划完成：{{(issue.plan_finish_time | date) || \'无限期\'}}</span>\n            </div>\n        </div>\n    </textarea>  <textarea id="tmpl-issue-list">\n        <div class="issue-list list" issue-status-dropdown-action style="position: relative">\n            <h3>{{title}}\n                <button issue-form-button class="primary default" style="float:right;margin-bottom:5px" ng-if="project.flag==2&&showQuickEditor" ng-click="createForm()">申请</button>\n                <button issue-form-button upload-docx class="primary default upload-docx" style="float:right;margin-bottom:5px" ng-if="project.flag==0&&showQuickEditor">\n                    批量创建\n                    <input type="file"/>\n                </button>\n                <a href="/wiki/17/category/89/issue/6902" ng-if="project.flag==0&&showQuickEditor" class="stubborn">如何批量创建任务？</a>\n            </h3>\n            <div class="create" ng-show="project.flag!=2&&!myproject">\n                <input type="text" placeholder="请输入您将要创建的任务，支持指令" autofocus issue-quick-editor ng-keydown="onKeyDown($event)" data-category="1" ng-show="showQuickEditor" data-tag="issue"/>\n                <div ng-show="!showQuickEditor" class="empty">\n                    您需要切换到具体任务分类下才能创建任务，<a href="/wiki/17/category/89/issue/2956" class="stubborn">这是什么意思？</a>\n                </div>\n            </div>\n\n            <div>\n                \n                <issue-plain-list data-source="{{undoneIssues}}" data-title="未完成"></issue-plain-list>\n                <issue-plain-list data-source="{{doneIssues}}" data-title="已经完成" data-show-details="false" data-need-pagination="true" data-uuid="done_issues"></issue-plain-list>\n            </div>\n\n            <issue-status-dropdown></issue-status-dropdown>\n\n            <issue-form-modal></issue-form-modal>\n\n\n        </div>\n    </textarea>  <textarea id="tmpl-issue-editor">\n        <div>\n            <div class="title">\n                <input type="text"/>\n            </div>\n            <editor></editor>\n            <div class="control">\n                <label class="always-top" ng-show="showAlwaysTop">\n                    <input type="checkbox"/>\n                    置顶\n                </label>\n                <button>保存</button>\n            </div>\n        </div>\n    </textarea>  <textarea id="tmpl-discussion-list">\n        <div class="list issue-list">\n            <header>\n                <h3>讨论</h3>\n            </header>\n\n            <div class="create">\n                <input type="text" placeholder="你想说点什么？" autofocus issue-quick-editor ng-keydown="onKeyDown($event)" data-category="1" data-tag="discussion"/>\n            </div>\n\n            <ul class="details">\n                <li ng-repeat="item in discussion.items" class="row" ng-class="{\'active\': (item | isActiveIssue)}">\n                    <a href="/{{item | projectLink: \'normal\'}}/discussion/{{item.id}}">\n                        <span class="badge gray small">{{item.comment_count}}</span>\n\n                        <span class="title" ng-bind-html="item.title | highlightKeyword: condition.keyword | unsafe"></span>\n                    </a>\n                    <div class="info">\n                        <span class="member memo">{{item.owner_name}}</span>\n                        <span class="date memo">{{item.timestamp | date}}</span>\n                    </div>\n                    <p class="summary" ng-show="item.content">\n                        {{item.content | rawText | limitTo: 40}}\n                    </p>\n                </li>\n            </ul>\n        </div>\n    </textarea>  <textarea id="tmpl-issue-priority-dropdown">\n        <div class="dropdown dropdown-tip priority">\n            <ul class="dropdown-menu">\n                <li>\n                    <a data-value="2"><i class="icon small priority-2"></i><span>低</span></a>\n                </li>\n                <li>\n                    <a data-value="3"><i class="icon small priority-3"></i><span>一般</span></a>\n                </li>\n                <li>\n                    <a data-value="4"><i class="icon small priority-4"></i><span>紧急</span></a>\n                </li>\n            </ul>\n        </div>\n    </textarea>  <textarea id="tmpl-issue-status-dropdown">\n        <div class="dropdown dropdown-tip status issue-status">\n            <ul class="dropdown-menu">\n                <li data-status="doing">\n                    <a data-value="doing"><i class="icon small doing"></i><span>进行中</span></a>\n                </li>\n                <li data-status="pause">\n                    <a data-value="pause"><i class="icon small pause"></i><span>暂停</span></a>\n                </li>\n                <li data-status="repairing">\n                    <a data-value="repairing"><i class="icon small repairing"></i><span>需要修改</span></a>\n                </li>\n                <li data-status="repaired">\n                    <a data-value="repaired"><i class="icon small repaired"></i><span>修复完成</span></a>\n                </li>\n                <li data-status="reviewing">\n                    <a data-value="reviewing"><i class="icon small reviewing"></i><span>测试已审</span></a>\n                </li>\n                <li data-status="reviewed">\n                    <a data-value="done"><i class="icon small done"></i><span>产品已审</span></a>\n                </li>\n                <li data-status="done">\n                    <a data-value="done"><i class="icon small done"></i><span>已完成</span></a>\n                </li>\n            </ul>\n        </div>\n    </textarea>  <textarea id="tmpl-issue-log">\n        <ul class="list">\n            <li ng-repeat="log in logs" title="{{log.timestamp | date: \'yyyy-MM-dd hh:mm\'}}">\n                <span class="realname gray">{{log.realname}}</span>\n                在\n                <span class="timestamp gray">{{log.timestamp | timeAgo}}</span>\n                <span class="content">{{log.content}}</span>\n            </li>\n        </ul>\n    </textarea>  <textarea id="tmpl-document-list">\n        <div class="list">\n            <header>\n                <h3>文档</h3>\n            </header>\n\n            <div class="create">\n                <input type="text" placeholder="想要新建文档吗？输入文档标题后回车" autofocus issue-quick-editor ng-keydown="onKeyDown($event)" data-category="1" data-tag="document"/>\n            </div>\n\n            <div ng-show="document.pagination.recordCount == 0" class="empty">\n                还没有任何文档哦，快创建一个吧\n            </div>\n\n            <ul class="details">\n                <li ng-repeat="item in document.items" class="row" ng-class="{\'active\': (item | isActiveIssue)}">\n                    <a href="/{{item | projectLink: \'normal\'}}/document/{{item.id}}">\n                        <span class="title">{{item.title}}</span>\n                    </a>\n\n                    <div class="info">\n                        <span class="member memo">{{item.owner_name}}</span>\n                        <span class="date memo">{{item.timestamp | date}}</span>\n                    </div>\n\n                    <p class="summary" ng-show="item.content">\n                        {{item.content | rawText}}\n                    </p>\n                </li>\n            </ul>\n\n            <pagination ng-hide="document.pagination.pageCount<2" data-uuid="document_pagination" data-paginations="{{document.pagination}}"></pagination>\n        </div>\n    </textarea>  <textarea id="tmpl-issue-tag-dropdown">\n        <div class="dropdown dropdown-tip tag">\n            <ul class="dropdown-menu">\n                <li>\n                    <a data-value="issue"><span>任务</span></a>\n                </li>\n                <li>\n                    <a data-value="document"><span>文档</span></a>\n                </li>\n                <li>\n                    <a data-value="discussion"><span>讨论</span></a>\n                </li>\n            </ul>\n        </div>\n    </textarea>  <textarea id="tmpl-issue-plain-list">\n        <div class="list">\n            <header>\n                <h3>\n                    {{title}}\n                    <span class="badge">({{source.pagination.recordCount}})</span>\n                </h3>\n                <div class="toggle" ng-class="{\'collapse\': showDetails}" ng-click="onClickToggle()">\n                    <i class="icon small"></i>\n                </div>\n            </header>\n            <ul class="details" ng-hide="showDetails">\n                <li ng-repeat="issue in source.items" class="row" id="issue-list-{{issue.id}}" ng-class="{\'active\': (issue | isActiveIssue)}">\n                    <issue-list-cell></issue-list-cell>\n                </li>\n            </ul>\n            <div ng-show="source.items.length == 0" class="empty">\n                {{emptyMemo || \'太棒了，所有的任务都已经完成了\'}}\n            </div>\n            <pagination ng-if="needPagination" ng-hide="showDetails||source.pagination.pageCount<2" data-uuid="{{uuid}}" data-paginations="{{source.pagination}}"></pagination>\n        </div>\n    </textarea>  <textarea id="tmpl-test-list">\n        <div class="issue-list list" issue-status-dropdown-action style="position: relative">\n            <h3>测试任务</h3>\n            <div class="create">\n                <input type="text" placeholder="请输入您将要创建的测试任务" autofocus issue-quick-editor ng-keydown="onKeyDown($event)" data-category="1" data-tag="test"/>\n            </div>\n\n\n            <div>\n                \n                <issue-plain-list data-source="{{doing}}" data-title="待办中" data-name="doing"></issue-plain-list>\n                \n                <issue-plain-list data-source="{{repairing}}" data-title="修复中" data-name="repairing"></issue-plain-list>\n                \n                <issue-plain-list data-source="{{reviewing}}" data-title="产品审核" data-name="reviewing"></issue-plain-list>\n                \n                <issue-plain-list data-source="{{done}}" data-title="已完成" data-name="done" data-show-details="false"></issue-plain-list>\n            </div>\n\n            <issue-status-dropdown></issue-status-dropdown>\n        </div>\n        <div>\n    </div>\n    </textarea> <textarea id="tmpl-issue-follow-icon">\n        <div class="follow-icon">\n            <i class="icon follow"></i>\n        </div>\n    </textarea> <textarea id="tmpl-issue-follow-member-dropdown">\n        <div class="dropdown dropdown-tip members">\n            <ul class="dropdown-menu" ng-repeat="array in items">\n                <li ng-repeat="item in array">\n                    <a data-value="{{item.member_id}}">\n                        {{item.realname}}\n                    </a>\n                </li>\n            </ul>\n        </div>\n    </textarea> <textarea id="tmpl-issue-follow-members">\n        <div class="follow-members">\n\n            <ul class="follow-members">\n                <li class="follow-title">\n                    关注成员：\n                </li>\n                <li class="follow-member" ng-repeat="item in followMembers">\n                        {{item.realname}}\n                    <i class="icon remove" ng-click="removeFollow(item)" title="删除关注"></i>\n                </li>\n\n                <li class="follow-title no-follower" ng-if="followMembers.length==0">\n                    暂无\n                </li>\n                <li>\n                    <div class="follow" dropdown data-name="issue:follow" ng-hide="articleOnly" data-empty="添加关注">\n                        <issue-follow-icon></issue-follow-icon>\n                        <issue-follow-member-dropdown data-items="{{projectMember}}"></issue-follow-member-dropdown>\n                    </div>\n                </li>\n            </ul>\n        </div>\n    </textarea> <textarea id="tmpl-issue-split-member-dropdown">\n        <div class="dropdown dropdown-tip members">\n            <ul class="dropdown-menu" ng-repeat="array in items">\n                <li ng-repeat="item in array">\n                    <a data-value="{{item.member_id}}">\n                        {{item.realname}}\n                    </a>\n                </li>\n            </ul>\n        </div>\n    </textarea> <textarea id="tmpl-issue-split">\n        <div class="issue-split">\n\n            <ul class="issue-split">\n                <li ng-repeat="item in issue.splitArr" issue-status-dropdown-action>\n                    <div class="split-major">\n                        <div class="issue-status" data-selected="{{item.status}}" ng-click="onClickStatus($event, item)">\n                            <i class="icon small" ng-class="item.status"></i>\n                        </div>\n                        <div class="title">{{item.title}}</div>\n                        <div class="ids">#{{item.issue_id}}-{{item.id}}</div>\n                    </div>\n                    <div class="operation">\n\n                        <div class="member text-only" dropdown data-name="issue:split:{{item.id}}" data-text-container="label.display" title="责任人" data-empty="{{item.realname || \'责任人\'}}">\n                            <i class="icon owner"></i>\n                            <label class="display">{{item.realname || \'责任人\'}}</label>\n                            <issue-split-member-dropdown data-split-id="item.id" data-member-id="item.owner"></issue-split-member-dropdown>\n                        </div>\n\n                        <div class="finish-date" ng-show="item.status!=\'done\'">\n                            <a datetime-picker data-name="plan_finish_time_{{item.id}}" data-date="{{item.plan_finish_time}}">\n                                <i class="icon date"></i>\n                                <span>{{(item.plan_finish_time | date:\'yyyy-MM-dd\') || \'计划完成\' }}</span>\n                            </a>\n                        </div>\n                        \n                        <div class="toolbar">\n                            <a ng-click="splitEdit(item)" href="javascript:void(0)" class="edit">\n                                <i class="icon edit"></i>\n                                <span class="tollbar-text">编辑</span>\n                            </a>\n                            <a ng-click="splitDelete(item)" href="javascript:void(0)" class="delete">\n                                <i class="icon delete"></i>\n                                <span class="tollbar-text">删除</span>\n                            </a>\n                        </div>\n                    </div>\n                </li>\n            </ul>\n            <div class="create" ng-show="issue.splited==1&&splitShow">\n                <input type="text" id="split-text" placeholder="请输入子任务的名称后回车" ng-model="recentSplit.title" ng-blur="blur()" ng-keydown="splitSave($event)">\n            </div>\n        </div>\n    </textarea> </div>';n.run(["$templateCache",function(e){e.put("issue-all.html",o)}]),e.exports=o},function(e,t){var n,i=window.angular;try{n=i.module(["ng"])}catch(r){n=i.module("ng",[])}var o=' <div> <textarea id="tmpl-issue-form-234">\n\n<tr>\n	<td class="mtitle" colspan="2">基本信息</td>\n</tr>\n<tr>\n	<td>\n		<b><i ng-show="editable">*&nbsp;</i>标题：</b>\n		<input name="title" ng-model="entity.title" required ng-show="editable" type="text"/>\n		<span ng-show="!editable">{{entity.title}}</span>u\n	</td>\n	<td>\n		<b><i ng-show="editable">*&nbsp;</i>申请部门：</b>\n		<select required ng-show="editable" ng-model="entity.department">\n			<option value="市场营销中心">市场营销中心</option>\n			<option value="平台部">平台部</option>\n			<option value="平台运营部">平台运营部</option>\n			<option value="运营支撑部">运营支撑部</option>\n			<option value="芒果OTT部">芒果OTT部</option>\n			<option value="芒果MPP部">芒果MPP部</option>\n			<option value="综合事务部">综合事务部</option>\n		</select>\n		\n		<span ng-show="!editable">{{entity.department}}</span>\n	</td>\n</tr>\n<tr>\n	<td>\n		<b><i ng-show="editable">*&nbsp;</i>申请人：</b>\n		<input name="name" required type="text" ng-show="editable" ng-model="entity.name"/>\n		<span ng-show="!editable">{{entity.name}}</span>\n	</td>\n<td>\n	<b>协办部门：</b>\n	<select ng-show="editable" class="form-control" ng-model="entity.assdepartment">\n		<option value="市场营销中心">市场营销中心</option>\n		<option value="平台部">平台部</option>\n		<option value="平台运营部">平台运营部</option>\n		<option value="运营支撑部">运营支撑部</option>\n		<option value="芒果OTT部">芒果OTT部</option>\n		<option value="芒果MPP部">芒果MPP部</option>\n		<option value="综合事务部">综合事务部</option>\n	</select>\n	<span ng-show="!editable">{{entity.assdepartment}}</span>\n</td>\n</tr>\n<tr>\n	<td>\n		<b>协办人：</b>\n		<input type="text" ng-show="editable" ng-model="entity.assname"/>	\n		<span ng-show="!editable">{{entity.assname}}</span>\n	</td>\n	<td></td>\n</tr>\n<tr>\n	<td class="mtitle" colspan="2">设备变更</td>\n</tr>\n<tr>\n	<td colspan="2">\n		<b>设备管理：</b> \n		<div class="line">\n			<div class="check">\n				<input type="checkbox" ng-disabled="!editable" ng-model="entity.ckbox_value1" ng-true-value="1" ng-false-value="0"/>	\n				设备上架\n			</div>\n			<div class="check">\n				<input type="checkbox" ng-disabled="!editable" ng-model="entity.ckbox_value2" ng-true-value="1" ng-false-value="0"/>	\n				设备下架\n			</div>\n			<div class="check">\n				<input type="checkbox" ng-disabled="!editable" ng-model="entity.ckbox_value3" ng-true-value="1" ng-false-value="0"/>	\n				设备入机房\n			</div>\n			<div class="check">\n				<input type="checkbox" ng-disabled="!editable" ng-model="entity.ckbox_value4" ng-true-value="1" ng-false-value="0"/>	\n				设备出机房\n			</div>\n		</div>\n	</td>\n</tr>\n<tr>\n	<td colspan="2">\n		<b>系统操作：</b>\n		<div class="line">\n			<div class="check">\n				<input type="checkbox" ng-disabled="!editable" ng-model="entity.ckbox_value5" ng-true-value="1" ng-false-value="0"/>	\n				系统安装\n			</div>\n			<div class="check">\n				<input type="checkbox" ng-disabled="!editable" ng-model="entity.ckbox_value6" ng-true-value="1" ng-false-value="0"/>	\n				登录密码更改\n			</div>\n			<div class="check">\n				<input type="checkbox" ng-disabled="!editable" ng-model="entity.ckbox_value7" ng-true-value="1" ng-false-value="0"/>	\n				软件安装\n			</div>\n			<div class="check">\n				<input type="checkbox" ng-disabled="!editable" ng-model="entity.ckbox_value8" ng-true-value="1" ng-false-value="0"/>	\n				权限申请\n			</div>\n			<div class="check">\n				<input type="checkbox" ng-disabled="!editable" ng-model="entity.ckbox_value9" ng-true-value="1" ng-false-value="0"/>	\n				来路限制\n			</div>\n			<div class="check">\n				<input type="checkbox" ng-disabled="!editable" ng-model="entity.ckbox_value10" ng-true-value="1" ng-false-value="0"/>	\n				端口配置\n			</div>\n		</div>\n	</td>\n</tr>\n<tr>\n	<td colspan="2">\n		<b>业务系统：</b>\n		<div class="line">\n			<div class="check">\n				<input type="checkbox" ng-disabled="!editable" ng-model="entity.ckbox_value11" ng-true-value="1" ng-false-value="0"/>	\n				系统配置更改\n			</div>\n			<div class="check">\n				<input type="checkbox" ng-disabled="!editable" ng-model="entity.ckbox_value12" ng-true-value="1" ng-false-value="0"/>	\n				业务系统上线\n			</div>\n			<div class="check">\n				<input type="checkbox" ng-disabled="!editable" ng-model="entity.ckbox_value13" ng-true-value="1" ng-false-value="0"/>	\n				系统维护割接\n			</div>\n			<div class="check">\n				<input type="checkbox" ng-disabled="!editable" ng-model="entity.ckbox_value14" ng-true-value="1" ng-false-value="0"/>	\n				版本升级\n			</div>\n			<div class="check">\n				<input type="checkbox" ng-disabled="!editable" ng-model="entity.ckbox_value15" ng-true-value="1" ng-false-value="0"/>	\n				服务安装\n			</div>\n			<div class="check">\n				<input type="checkbox" ng-disabled="!editable" ng-model="entity.ckbox_value16" ng-true-value="1" ng-false-value="0"/>	\n				版本更新\n			</div>\n		</div>\n	</td>\n</tr>\n<tr>\n	<td colspan="2">\n		<b>数据库：</b>\n		<div class="line">\n\n			<div class="check">\n				<input type="checkbox" ng-disabled="!editable" ng-model="entity.ckbox_value17" ng-true-value="1" ng-false-value="0"/>	\n				数据库备份\n			</div>\n			<div class="check">\n				<input type="checkbox" ng-disabled="!editable" ng-model="entity.ckbox_value18" ng-true-value="1" ng-false-value="0"/>	\n				数据库密码更改\n			</div>\n			<div class="check">\n				<input type="checkbox" ng-disabled="!editable" ng-model="entity.ckbox_value19" ng-true-value="1" ng-false-value="0"/>	\n				数据库割接\n			</div>\n		</div>\n	</td>\n</tr>\n<tr>\n	<td colspan="2">\n		<b>网络配置：</b>\n		<div class="line">\n			<div class="check">\n				<input type="checkbox" ng-disabled="!editable" ng-model="entity.ckbox_value20" ng-true-value="1" ng-false-value="0"/>	\n				服务器IP更改\n			</div>\n			<div class="check">\n				<input type="checkbox" ng-disabled="!editable" ng-model="entity.ckbox_value21" ng-true-value="1" ng-false-value="0"/>	\n				路由器配置\n			</div>\n			<div class="check">\n				<input type="checkbox" ng-disabled="!editable" ng-model="entity.ckbox_value22" ng-true-value="1" ng-false-value="0"/>	\n				交换机配置\n			</div>\n		</div>\n	</td>\n</tr>\n<tr>\n	<td colspan="2">\n		<b>负载均衡配置：</b>\n		<div class="line">\n			<div class="check">\n				<input type="checkbox" ng-disabled="!editable" ng-model="entity.ckbox_value25" ng-true-value="1" ng-false-value="0"/>	\n				流量控制配置\n			</div>\n			<div class="check">\n				<input type="checkbox" ng-disabled="!editable" ng-model="entity.ckbox_value26" ng-true-value="1" ng-false-value="0"/>	\n				VPN权限配置\n			</div>\n			<div class="check">\n				<input type="checkbox" ng-disabled="!editable" ng-model="entity.ckbox_value27" ng-true-value="1" ng-false-value="0"/>	\n				设备密码更改\n			</div>\n		</div>\n	</td>\n</tr>\n<tr>\n	<td colspan="2">\n		<b>其他配置：</b>\n		&lt;textarea ng-show="editable" ng-model="entity.other" &gt;&lt;/textarea&gt;\n		<label ng-show="!editable">{{entity.other}}</label>\n	</td>\n</tr>\n<tr>\n	<td class="mtitle" colspan="2">申请原因</td>\n</tr>\n<tr>\n	<td colspan="2">\n		<b><i ng-show="editable">*&nbsp;</i>详细说明变更需求：</b>\n		&lt;textarea ng-show="editable" ng-model="entity.detail" &gt;&lt;/textarea&gt;\n		<label ng-show="!editable">{{entity.detail}}</label>\n	</td>\n</tr>\n<tr>\n	<td colspan="2">\n		<b><i ng-show="editable">*&nbsp;</i>申请原因及用途：</b>\n		&lt;textarea ng-show="editable" ng-model="entity.reason" &gt;&lt;/textarea&gt;\n		<label ng-show="!editable">{{entity.reason}}</label>\n	</td>\n</tr>\n</textarea> <textarea id="tmpl-issue-form-233">\n\n	<tr>\n		<td class="mtitle" colspan="2">基本信息</td>\n	</tr>\n	<tr>\n		<td>\n			<b><i ng-show="editable">*&nbsp;</i>标题：</b>\n			<input name="title" ng-model="entity.title" required ng-show="editable" type="text"/>\n			<span ng-show="!editable">{{entity.title}}</span>\n		</td>\n		<td>\n			<b><i ng-show="editable">*&nbsp;</i>申请部门：</b>\n			<select required ng-show="editable" ng-model="entity.department">\n				<option value="市场营销中心">市场营销中心</option>\n				<option value="平台部">平台部</option>\n				<option value="平台运营部">平台运营部</option>\n				<option value="运营支撑部">运营支撑部</option>\n				<option value="芒果OTT部">芒果OTT部</option>\n				<option value="芒果MPP部">芒果MPP部</option>\n				<option value="综合事务部">综合事务部</option>\n			</select>\n			\n			<span ng-show="!editable">{{entity.department}}</span>\n		</td>\n	</tr>\n	<tr>\n		<td>\n			<b><i ng-show="editable">*&nbsp;</i>申请人：</b>\n			<input name="name" required type="text" ng-show="editable" ng-model="entity.name"/>\n			<span ng-show="!editable">{{entity.name}}</span>\n		</td>\n		<td>\n			<b><i ng-show="editable">*&nbsp;</i>项目名称：</b>\n			<input type="text" required ng-show="editable" ng-model="entity.pname"/>\n			<span ng-show="!editable">{{entity.pname}}</span>\n		</td>\n	</tr>\n	<tr>\n		<td>\n			<b>上线类型：</b>\n			<select ng-show="editable" ng-model="entity.type">\n				<option value="小型">小型</option>\n				<option value="中大型">中大型</option>\n			</select>\n			<span ng-show="!editable">{{entity.type}}</span>\n		</td>\n		<td>\n			<b>紧急程度：</b>\n			<select ng-show="editable" ng-model="entity.j">\n				<option value="高">高</option>\n				<option value="中">中</option>\n				<option value="低">低</option>\n			</select>\n			<span ng-show="!editable">{{entity.j}}</span>\n		</td>\n	</tr>\n	<tr>\n		<td>\n			<b>上线时间：</b>\n			<input type="text" datetype="datetime" placeholder="开始时间，精确到小时" ng-show="editable" ng-model="entity.time"/>\n			<span ng-show="!editable">{{entity.time}}</span>\n		</td>\n		<td>\n			<b>上线时间：</b>\n			<input type="text" datetype="datetime" placeholder="结束时间，精确到小时" ng-show="editable" ng-model="entity.endtime"/>\n			<span ng-show="!editable">{{entity.endtime}}</span>\n		</td>\n	</tr>\n	<tr>\n		<td colspan="2">\n			<b>上线描述：</b>\n			&lt;textarea rows="10" placeholder="对上线内容进行清晰描述，着重描述功能点和影响范围。（内容可直接让产品人员提供）" ng-show="editable" ng-model="entity.details" &gt;&lt;/textarea&gt;\n			<label ng-show="!editable">{{entity.details}}</label>\n		</td>\n	</tr>	\n	<tr>\n		<td colspan="2">\n			<b>上线重点：</b>\n			&lt;textarea rows="10" placeholder="对本次上线可能造成的影响范围，以便上线后重点关注。" ng-show="editable" ng-model="entity.importance" &gt;&lt;/textarea&gt;\n			<label ng-show="!editable">{{entity.importance}}</label>\n		</td>\n	</tr>	\n</textarea> <textarea id="tmpl-issue-form-207">\n	<tr>\n		<td class="mtitle" colspan="2">基本信息</td>\n	</tr>\n	<tr>\n		<td>\n			<b><i ng-show="editable">*&nbsp;</i>标题：</b>\n			<input name="title" ng-model="entity.title" required ng-show="editable" type="text"/>\n			<span ng-show="!editable">{{entity.title}}</span>\n		</td>\n		<td>\n			<b><i ng-show="editable">*&nbsp;</i>申请部门：</b>\n			<select required ng-show="editable" ng-model="entity.department">\n				<option value="市场营销中心">市场营销中心</option>\n				<option value="平台部">平台部</option>\n				<option value="平台运营部">平台运营部</option>\n				<option value="运营支撑部">运营支撑部</option>\n				<option value="芒果OTT部">芒果OTT部</option>\n				<option value="芒果MPP部">芒果MPP部</option>\n				<option value="综合事务部">综合事务部</option>\n			</select>\n			\n			<span ng-show="!editable">{{entity.department}}</span>\n		</td>\n	</tr>\n	<tr>\n		<td>\n			<b><i ng-show="editable">*&nbsp;</i>申请人：</b>\n			<input name="name" required type="text" ng-show="editable" ng-model="entity.name"/>\n			<span ng-show="!editable">{{entity.name}}</span>\n		</td>\n		<td>\n			<b><i ng-show="editable">*&nbsp;</i>签呈时间：</b>\n			<input type="text" ng-show="editable" datetype="date" datetime-picker format="yyyy年mm月dd日" ng-model="entity.time"/>\n			<span ng-show="!editable">{{entity.time}}</span>\n		</td>\n	</tr>\n	<tr>\n		<td>\n			<b><i ng-show="editable">*&nbsp;</i>业务模块：</b>\n			<input type="text" required ng-show="editable" ng-model="entity.model"/>\n			<span ng-show="!editable">{{entity.model}}</span>\n		</td>\n		<td></td>\n	</tr>		\n\n	<tr>\n		<td colspan="2">\n			<b>功能描述：</b>\n			&lt;textarea ng-show="editable" ng-model="entity.detail" &gt;&lt;/textarea&gt;\n			<label ng-show="!editable">{{entity.detail}}</label>\n		</td>\n	</tr>	\n\n\n\n	<tr>\n		<td class="mtitle" colspan="2">资源配置</td>\n	</tr>\n	<tr>\n		<td colspan="2" class="table">\n			<table class="inner">\n				<tr>\n					<th>名称</th><th>CPU</th><th>内存</th><th>硬盘</th><th>RAID</th><th>网口数量</th><th>外网</th><th>机架高度</th><th>电源模块</th><th>功耗</th><th>数量</th>\n				</tr>\n				<tr class="cel">\n					<td>负载均衡</td><td>E3-1220<br/>4核</td><td>4*8G</td><td>2*500G</td><td>RAID1</td><td>千兆*2</td><td>有</td><td>1U</td><td>单电源冗余</td><td>550W</td><td><input ng-disabled="!editable" onkeypress="if (event.keyCode < 45 || event.keyCode > 57) event.returnValue = false" ng-model="entity.num1"/></td>\n				</tr>\n\n				<tr>\n					<td>web层</td><td>2*E5-2420<br/>6核</td><td>4*8G</td><td>2*1T</td><td>RAID1</td><td>千兆*2</td><td>有</td><td>1U</td><td>单电源冗余</td><td>550W</td><td><input ng-disabled="!editable" onkeypress="if (event.keyCode < 45 || event.keyCode > 57) event.returnValue = false" ng-model="entity.num2"/></td>\n				</tr>\n\n				<tr class="cel">\n					<td>缓存层</td><td>2*E5-2420<br/>6核</td><td>8*8G</td><td>2*1T</td><td>RAID1</td><td>千兆*2</td><td>有</td><td>1U</td><td>单电源冗余</td><td>550W</td><td><input ng-disabled="!editable" onkeypress="if (event.keyCode < 45 || event.keyCode > 57) event.returnValue = false" ng-model="entity.num3"/></td>\n				</tr>\n\n				<tr>\n					<td>数据层</td><td>2*E5-2440<br/>8核</td><td>8*8G</td><td>2*300G(系统)<br/>4*600G(数据)</td><td>RAID5</td><td>千兆*2</td><td>无</td><td>1U</td><td>双电源冗余</td><td>550W</td><td><input ng-disabled="!editable" onkeypress="if (event.keyCode < 45 || event.keyCode > 57) event.returnValue = false" ng-model="entity.num4"/></td>\n				</tr>\n\n				<tr class="cel">\n					<td>CDN</td><td>2*E5-2620<br/>6核</td><td>8*8G</td><td>2*300G(系统)<br/>12*4T(数据)</td><td>RAID1(系统)<br/>RAID0(数据)</td><td>千兆*4</td><td>有</td><td>2U</td><td>双电源冗余</td><td>750W</td><td><input ng-disabled="!editable" onkeypress="if (event.keyCode < 45 || event.keyCode > 57) event.returnValue = false" ng-model="entity.num5"/></td>\n				</tr>\n			</table>\n		</td>\n	</tr>\n	<tr ng-show="editable">\n		<td colspan="2">\n			<tip>说明：以上为推荐配置，如有其他需求请按照格式在备注中填写。</tip>\n		</td>\n	</tr>\n\n	<tr>\n		<td class="mtitle" colspan="2">环境说明</td>\n	</tr>\n	<tr>\n		<td>\n			<b><i ng-show="editable">*&nbsp;</i>部署环境：</b>\n			<input type="text" required ng-show="editable" ng-model="entity.env"/>\n			<span ng-show="!editable">{{entity.env}}</span>\n		</td>\n		<td>\n			<b>监控内容：</b>\n			<input type="text" ng-show="editable" ng-model="entity.content"/>\n			<span ng-show="!editable">{{entity.content}}</span>\n		</td>\n	</tr>\n\n	<tr>\n		<td colspan="2">\n			<b>备注：</b>\n			&lt;textarea rows="10" ng-show="editable" ng-model="entity.ext" &gt;&lt;/textarea&gt;\n			<label ng-show="!editable">{{entity.ext}}</label>\n		</td>\n	</tr>\n	<tr>\n		<td colspan="2">\n			<b>域名：</b>\n			<span class="text">如有需要请到备注说明。</span>\n		</td>\n	</tr>\n	\n</textarea> <textarea id="tmpl-issue-form-316">\n	<tr>\n		<td>\n			<b><i ng-show="editable">*&nbsp;</i>标题：</b>\n			<input name="title" ng-model="entity.title" required ng-show="editable" type="text"/>\n			<span ng-show="!editable">{{entity.title}}</span>\n		</td>\n		<td>\n			<b><i ng-show="editable">*&nbsp;</i>申请部门：</b>\n			<input name="department" ng-model="entity.department" required ng-show="editable" type="text"/>\n			<span ng-show="!editable">{{entity.department}}</span>\n		</td>\n	</tr>\n	<tr>\n		<td>\n			<b><i ng-show="editable">*&nbsp;</i>申请人：</b>\n			<input name="name" required type="text" ng-show="editable" ng-model="entity.name"/>\n			<span ng-show="!editable">{{entity.name}}</span>\n		</td>\n	\n		<td>\n			<b><i ng-show="editable">*&nbsp;</i>联系电话：</b>\n			<input type="text" required ng-show="editable" ng-model="entity.phone"/>\n			<span ng-show="!editable">{{entity.phone}}</span>\n		</td>\n	</tr>\n	<tr>\n		<td>\n			<b><i ng-show="editable">*&nbsp;</i>节目名称：</b>\n		<input type="text" required ng-show="editable" ng-model="entity.pname"/>\n		<span ng-show="!editable">{{entity.pname}}</span>\n		</td>\n		<td>\n			<b><i ng-show="editable">*&nbsp;</i>录制形式：</b>\n			<select ng-show="editable" required ng-model="entity.j">\n				<option value="语言录音">语言录音</option>\n				<option value="视频配音">视频配音</option>\n				<option value="歌唱录音">歌唱录音</option>\n			</select>\n			<span ng-show="!editable">{{entity.j}}</span>\n		</td>\n	</tr>\n	<tr>\n		<td><b><i ng-show="editable">*&nbsp;</i>使用时间：</b>\n		<input type="text" required datetype="datetime" placeholder="开始时间，精确到分" datetype="date" datetime-picker format="yyyy年mm月dd日 hh时:ii分" ng-show="editable" ng-model="entity.stime"/>\n		<span ng-show="!editable">{{entity.stime}}</span>\n		</td>\n		<td>\n		<b><i ng-show="editable">*&nbsp;</i>使用时长：</b>\n		<input type="text" required ng-show="editable" ng-model="entity.time"/>\n		<span ng-show="!editable">{{entity.time}}</span>\n		</td>\n	</tr>\n	<tr>\n		<td colspan="2">\n			<b>备注：</b>\n		&lt;textarea rows="10" placeholder="如无特别要求可不填写" ng-show="editable" ng-model="entity.details" &gt;&lt;/textarea&gt;\n		<label ng-show="!editable">{{entity.details}}</label>\n		</td>\n	</tr>\n	<tr ng-show="editable">\n		<td colspan="2">\n			<b class="tips">说明：</b>\n			<dl>\n				<dd>语言录音：纯语言录音，如娱乐新闻配音。</dd>\n				<dd>视频配音：对照视频口型录音，如动画配音。</dd>\n				<dd>歌唱录音：歌唱、乐器小样录音。</dd>\n			</dl>\n		</td>\n	</tr>\n	\n</textarea> <textarea id="temp-form-head">\n	<form name="myForm">\n		<table class="body">\n</table></form></textarea> <textarea id="temp-form-foot">\n	\n</textarea> <textarea id="tmpl-issue-form-modal">\n	<div class="inner issue-form">\n		<div class="title">\n			<span>申请表单</span>\n		</div>\n		<a class="close-modal" rel="modal:close"> <i class="icon"></i>\n		</a>\n		<div class="main">\n			<div class="simple-tab" simple-tab="" data-active-index="0">\n				<issue-form data-type="{{activeIndex}}" data-issue="{{issueId}}"></issue-form>\n			</div>\n		</div>\n		<div class="right footer">\n			<button class="primary default" ng-click="onClickSubmit()">提&nbsp;&nbsp;交</button>\n\n			<button class="cancel default" ng-click="onClickCancel()">取&nbsp;&nbsp;消</button>\n		</div>\n	</div>\n</textarea> <textarea id="tmpl-issue-form-395">\n\n	<tr>\n		<td class="mtitle">基本信息</td>\n		<td class="mtitle" style="text-align:right"><span>以下尺寸单位统一为px（像素）</span></td>\n	</tr>\n	<tr>\n		\n		<td>\n			<b><i ng-show="editable">*&nbsp;</i>项目名称：</b>\n			<input name="title" ng-model="entity.title" ng-show="editable" type="text"/>\n			<span ng-show="!editable">{{entity.title}}</span>\n		</td>\n		\n		<td>\n			<b><i ng-show="editable">*&nbsp;</i>上线日期：</b>\n			<input name="title" ng-model="entity.date" datetype="date" datetime-picker format="yyyy年mm月dd日" ng-show="editable" type="text"/>\n			<span ng-show="!editable">{{entity.date}}</span>\n		</td>\n	</tr>\n	<tr>\n		\n		<td>\n			<b><i ng-show="editable">*&nbsp;</i>项目性质：</b>\n			<select ng-show="editable" required ng-model="entity.j">\n				<option value="专题">专题</option>\n				<option value="H5单页">H5单页</option>\n				<option value="栏目">栏目</option>\n				<option value="其他">其他</option>\n			</select>\n			<span ng-show="!editable">{{entity.j}}</span>\n		</td>\n		\n		<td>\n			<b>项目适配：</b>				\n			<input type="checkbox" ng-disabled="!editable" ng-model="entity.ckbox_value1" ng-true-value="1" ng-false-value="0"/><span>PC端</span>\n			<input type="checkbox" ng-disabled="!editable" ng-model="entity.ckbox_value2" ng-true-value="1" ng-false-value="0"/><span>平板</span>\n			<input type="checkbox" ng-disabled="!editable" ng-model="entity.ckbox_value3" ng-true-value="1" ng-false-value="0"/><span>手机</span>\n		</td>\n	</tr>\n	<tr>\n		\n		<td>\n			<b>默认尺寸：</b>\n			<input placeholder="内容区域的默认最大宽度" type="text" ng-show="editable" ng-model="entity.assname"/>	\n			<span ng-show="!editable">{{entity.assname}}</span>\n		</td>\n	</tr>\n	<tr>\n		\n		<td class="mtitle" colspan="2">\n			<b>适配档位：</b>\n			<input type="checkbox" ng-disabled="!editable" ng-model="entity.ckbox_value4" ng-true-value="1" ng-false-value="0"/><span>1580</span>\n			<input type="checkbox" ng-disabled="!editable" ng-model="entity.ckbox_value5" ng-true-value="1" ng-false-value="0"/><span>1400</span>\n			<input type="checkbox" ng-disabled="!editable" ng-model="entity.ckbox_value6" ng-true-value="1" ng-false-value="0"/><span>1180</span>\n			<input type="checkbox" ng-disabled="!editable" ng-model="entity.ckbox_value7" ng-true-value="1" ng-false-value="0"/><span>940</span>\n			<input type="checkbox" ng-disabled="!editable" ng-model="entity.ckbox_value8" ng-true-value="1" ng-false-value="0"/><span>720</span>\n		</td>\n	</tr>\n	<tr ng-show="editable">\n		<td colspan="2" class="tips">\n			<b>说明：</b>\n			<span>当选择专题时，默认不适配，会将默认尺寸做等比缩小，H5单页无需填写此项。</span>\n		</td>\n	</tr>\n	<tr>\n		\n		<td>\n			<b><i ng-show="editable">*&nbsp;</i>复用性：</b>\n			<select ng-show="editable" ng-model="entity.fyx">\n				<option value="是">是</option>\n				<option value="否">否</option>\n			</select>\n			<span ng-show="!editable">{{entity.fyx}}</span>\n		</td>\n		\n		<td>\n			<b>合作方：</b>\n			<select ng-show="editable" ng-model="entity.hzf">\n				<option value="是">是</option>\n				<option value="否">否</option>\n			</select>\n			<span ng-show="!editable">{{entity.hzf}}</span>\n		</td>\n	</tr>\n	<tr>\n		\n		<td>\n			<b><i ng-show="editable">*&nbsp;</i>产品负责人：</b>\n			<input name="title" ng-model="entity.person" ng-show="editable" type="text"/>\n			<span ng-show="!editable">{{entity.person}}</span>\n		</td>\n		\n		<td>\n			<b><i ng-show="editable">*&nbsp;</i>联系电话：</b>\n			<input name="title" ng-model="entity.phone" ng-show="editable" type="text"/>\n			<span ng-show="!editable">{{entity.phone}}</span>\n		</td>\n	</tr>\n	<tr>\n		<td colspan="2">\n			<b><i ng-show="editable">*&nbsp;</i>补充说明：</b>\n			&lt;textarea ng-show="editable" ng-model="entity.reason" &gt;&lt;/textarea&gt;\n			<label ng-show="!editable">{{entity.reason}}</label>\n		</td>\n	</tr>\n</textarea> </div>';
n.run(["$templateCache",function(e){e.put("issue-form.html",o)}]),e.exports=o},,function(e,t,n){var i,r;i=[n(38),n(44)],r=function(e,t){return e.controllerModule.controller("issueListController",["$rootScope","$scope","$stateParams","API","$state","$location",function(e,t,n,i,r,o){var a,s;return s=function(e){var o,s,l;return t.$parent.$broadcast("project:window:change",1),o=_.extend({tag:r.params.tag,category_id:r.params.category_id},e),t.condition=o,l=a(o),s=i.project(n.project_id).issue(),s.retrieve(_.extend({status:"undone",pageSize:9999},l)).then(function(e){return t.undoneIssues=e}),t.showQuickEditor=Boolean(o.category_id),s.retrieve(_.extend({status:"done",pageSize:10},l)).then(function(e){return t.doneIssues=e})},a=function(e){var i;return i={},e.keyword?(t.title="搜索："+e.keyword,i.keyword=e.keyword):n.myself?(t.title="我相关的任务",o.$$search.title&&(t.title=o.$$search.title),i.myself=!0):n.follow?(t.title="我相关注",o.$$search.title&&(t.title=o.$$search.title),i.follow=!0):e.category_id?t.title=o.$$search.title:t.title="所有任务",i.category_id=r.params.category_id,i.version_id=r.params.version_id,i},e.$on("pagination:change",function(e,r,o,s){var l,c;if("done_issues"===o)return c=a(t.condition),l=i.project(n.project_id).issue(),l.retrieve(_.extend({status:"done",pageSize:10,pageIndex:r},c)).then(function(e){return t.doneIssues=e})}),t.$on("issue:list:reload",function(e){return s()}),t.$on("issue:change",function(){return s()}),t.$on("instant-search:change",function(e,n){return t.condition.keyword!==n?s({keyword:n}):void 0}),t.$on("issue:status:change",function(e,t,r,o){return r!==o?i.project(n.project_id).issue(t).update({status:o}).then(function(){return s()}):void 0}),s()}]).controller("testListController",["$scope","$stateParams","API","$state","$location",function(e,t,n,i,r){var o,a;return e.condition={},o=n.project(t.project_id).issue(),a=function(t){var n;return n=_.extend({tag:"test"},t),o.retrieve(_.extend({status:["doing","repaired","pause"]},n)).then(function(t){return e.doing=t}),o.retrieve(_.extend({status:"repairing"},n)).then(function(t){return e.repairing=t}),o.retrieve(_.extend({status:"reviewing"},n)).then(function(t){return e.reviewing=t}),o.retrieve(_.extend({status:"done"},n)).then(function(t){return e.done=t})},e.$on("instant-search:change",function(t,n){return e.condition.keyword!==n?(e.condition.keyword=n,a({keyword:n})):void 0}),e.$on("issue:status:change",function(e,i,r,o){return r!==o?n.project(t.project_id).issue(i).update({status:o}).then(function(){return a()}):void 0}),a()}])}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(38),n(44),n(62)],r=function(e,t,n,i){return e.controllerModule.controller("issueDetailsController",["$scope","$stateParams","API","$state","$timeout",function(e,t,i,r,o){var a,s;return e.articleOnly=null!=(s=r.current.data)?s.articleOnly:void 0,a=function(){return i.project(t.project_id).issue(t.issue_id).retrieve().then(function(i){return e.issue=i,e.notFound=!i,e.projectMember&&t.project_id===e.issue.project_id||e.$emit("project:member:request",e.issue.project_id),e.projectCategory&&t.project_id===e.issue.project_id||e.$emit("project:category:request",e.issue.project_id),e.projectVersion&&t.project_id===e.issue.project_id||e.$emit("project:version:request",e.issue.project_id),e.projectVersion&&t.project_id===e.issue.project_id||e.$emit("project:refresh:request",e.issue.project_id),o(n.initHighlighting,100)})},e.$on("assets:upload:finish",function(){e.$broadcast("assets:list:update")}),e.$on("issue:detail:reload",function(){a()}),a()}]).controller("discussionListController",["$scope","$stateParams","$location","$filter","API",function(e,t,n,i,r){var o;return e.condition={},o=function(){return r.project(t.project_id).discussion().retrieve(e.condition).then(function(t){return e.discussion=t})},e.$on("issue:change",function(e,t){var r;return o(),"new"===t.status?(r="/"+i("projectLink")(null,"normal")+"/discussion/"+t.id,n.path(r).search("editing","true")):void 0}),e.$on("instant-search:change",function(t,n){return e.condition.keyword!==n?(e.condition.keyword=n,o()):void 0}),o()}]).controller("commentListController",["$scope","$stateParams","API",function(e,t,n){}]).controller("documentListController",["$rootScope","$scope","$stateParams","$location","$filter","API",function(e,t,n,i,r,o){var a,s;return a={tag:"document",pageSize:20},s=function(e){return e&&(a.pageIndex=e),o.project(n.project_id).issue().retrieve(a).then(function(e){return t.document=e})},t.$on("issue:change",function(e,t){return s()}),e.$on("pagination:change",function(e,t,n,i){return"document_pagination"===n?s(t):void 0}),s()}]).controller("documentDetailsController",["$state","$scope",function(e,t){}])}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t){var n=new function(){function e(e){return e.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;")}function t(e){return e.nodeName.toLowerCase()}function n(e,t){var n=e&&e.exec(t);return n&&0==n.index}function i(e){var t=(e.className+" "+(e.parentNode?e.parentNode.className:"")).split(/\s+/);return t=t.map(function(e){return e.replace(/^lang(uage)?-/,"")}),t.filter(function(e){return b(e)||/no(-?)highlight/.test(e)})[0]}function r(e,t){var n={};for(var i in e)n[i]=e[i];if(t)for(var i in t)n[i]=t[i];return n}function o(e){var n=[];return function i(e,r){for(var o=e.firstChild;o;o=o.nextSibling)3==o.nodeType?r+=o.nodeValue.length:1==o.nodeType&&(n.push({event:"start",offset:r,node:o}),r=i(o,r),t(o).match(/br|hr|img|input/)||n.push({event:"stop",offset:r,node:o}));return r}(e,0),n}function a(n,i,r){function o(){return n.length&&i.length?n[0].offset!=i[0].offset?n[0].offset<i[0].offset?n:i:"start"==i[0].event?n:i:n.length?n:i}function a(n){function i(t){return" "+t.nodeName+'="'+e(t.value)+'"'}d+="<"+t(n)+Array.prototype.map.call(n.attributes,i).join("")+">"}function s(e){d+="</"+t(e)+">"}function l(e){("start"==e.event?a:s)(e.node)}for(var c=0,d="",u=[];n.length||i.length;){var p=o();if(d+=e(r.substr(c,p[0].offset-c)),c=p[0].offset,p==n){u.reverse().forEach(s);do l(p.splice(0,1)[0]),p=o();while(p==n&&p.length&&p[0].offset==c);u.reverse().forEach(a)}else"start"==p[0].event?u.push(p[0].node):u.pop(),l(p.splice(0,1)[0])}return d+e(r.substr(c))}function s(e){function t(e){return e&&e.source||e}function n(n,i){return RegExp(t(n),"m"+(e.cI?"i":"")+(i?"g":""))}function i(o,a){if(!o.compiled){if(o.compiled=!0,o.k=o.k||o.bK,o.k){var s={},l=function(t,n){e.cI&&(n=n.toLowerCase()),n.split(" ").forEach(function(e){var n=e.split("|");s[n[0]]=[t,n[1]?Number(n[1]):1]})};"string"==typeof o.k?l("keyword",o.k):Object.keys(o.k).forEach(function(e){l(e,o.k[e])}),o.k=s}o.lR=n(o.l||/\b[A-Za-z0-9_]+\b/,!0),a&&(o.bK&&(o.b="\\b("+o.bK.split(" ").join("|")+")\\b"),o.b||(o.b=/\B|\b/),o.bR=n(o.b),o.e||o.eW||(o.e=/\B|\b/),o.e&&(o.eR=n(o.e)),o.tE=t(o.e)||"",o.eW&&a.tE&&(o.tE+=(o.e?"|":"")+a.tE)),o.i&&(o.iR=n(o.i)),void 0===o.r&&(o.r=1),o.c||(o.c=[]);var c=[];o.c.forEach(function(e){e.v?e.v.forEach(function(t){c.push(r(e,t))}):c.push("self"==e?o:e)}),o.c=c,o.c.forEach(function(e){i(e,o)}),o.starts&&i(o.starts,a);var d=o.c.map(function(e){return e.bK?"\\.?("+e.b+")\\.?":e.b}).concat([o.tE,o.i]).map(t).filter(Boolean);o.t=d.length?n(d.join("|"),!0):{exec:function(){return null}}}}i(e)}function l(t,i,r,o){function a(e,t){for(var i=0;i<t.c.length;i++)if(n(t.c[i].bR,e))return t.c[i]}function d(e,t){return n(e.eR,t)?e:e.eW?d(e.parent,t):void 0}function u(e,t){return!r&&n(t.iR,e)}function p(e,t){var n=k.cI?t[0].toLowerCase():t[0];return e.k.hasOwnProperty(n)&&e.k[n]}function h(e,t,n,i){var r=i?"":y.classPrefix,o='<span class="'+r,a=n?"":"</span>";return o+=e+'">',o+t+a}function m(){if(!_.k)return e(A);var t="",n=0;_.lR.lastIndex=0;for(var i=_.lR.exec(A);i;){t+=e(A.substr(n,i.index-n));var r=p(_,i);r?($+=r[1],t+=h(r[0],e(i[0]))):t+=e(i[0]),n=_.lR.lastIndex,i=_.lR.exec(A)}return t+e(A.substr(n))}function f(){if(_.sL&&!w[_.sL])return e(A);var t=_.sL?l(_.sL,A,!0,C[_.sL]):c(A);return _.r>0&&($+=t.r),"continuous"==_.subLanguageMode&&(C[_.sL]=t.top),h(t.language,t.value,!1,!0)}function g(){return void 0!==_.sL?f():m()}function v(t,n){var i=t.cN?h(t.cN,"",!0):"";t.rB?(T+=i,A=""):t.eB?(T+=e(n)+i,A=""):(T+=i,A=n),_=Object.create(t,{parent:{value:_}})}function x(t,n){if(A+=t,void 0===n)return T+=g(),0;var i=a(n,_);if(i)return T+=g(),v(i,n),i.rB?0:n.length;var r=d(_,n);if(r){var o=_;o.rE||o.eE||(A+=n),T+=g();do _.cN&&(T+="</span>"),$+=_.r,_=_.parent;while(_!=r.parent);return o.eE&&(T+=e(n)),A="",r.starts&&v(r.starts,""),o.rE?0:n.length}if(u(n,_))throw new Error('Illegal lexeme "'+n+'" for mode "'+(_.cN||"<unnamed>")+'"');return A+=n,n.length||1}var k=b(t);if(!k)throw new Error('Unknown language: "'+t+'"');s(k);for(var _=o||k,C={},T="",j=_;j!=k;j=j.parent)j.cN&&(T=h(j.cN,"",!0)+T);var A="",$=0;try{for(var S,M,N=0;_.t.lastIndex=N,S=_.t.exec(i),S;)M=x(i.substr(N,S.index-N),S[0]),N=S.index+M;x(i.substr(N));for(var j=_;j.parent;j=j.parent)j.cN&&(T+="</span>");return{r:$,value:T,language:t,top:_}}catch(E){if(-1!=E.message.indexOf("Illegal"))return{r:0,value:e(i)};throw E}}function c(t,n){n=n||y.languages||Object.keys(w);var i={r:0,value:e(t)},r=i;return n.forEach(function(e){if(b(e)){var n=l(e,t,!1);n.language=e,n.r>r.r&&(r=n),n.r>i.r&&(r=i,i=n)}}),r.language&&(i.second_best=r),i}function d(e){return y.tabReplace&&(e=e.replace(/^((<[^>]+>|\t)+)/gm,function(e,t){return t.replace(/\t/g,y.tabReplace)})),y.useBR&&(e=e.replace(/\n/g,"<br>")),e}function u(e,t,n){var i=t?x[t]:n,r=[e.trim()];return e.match(/(\s|^)hljs(\s|$)/)||r.push("hljs"),i&&r.push(i),r.join(" ").trim()}function p(e){var t=i(e);if(!/no(-?)highlight/.test(t)){var n;y.useBR?(n=document.createElementNS("http://www.w3.org/1999/xhtml","div"),n.innerHTML=e.innerHTML.replace(/\n/g,"").replace(/<br[ \/]*>/g,"\n")):n=e;var r=n.textContent,s=t?l(t,r,!0):c(r),p=o(n);if(p.length){var h=document.createElementNS("http://www.w3.org/1999/xhtml","div");h.innerHTML=s.value,s.value=a(p,o(h),r)}s.value=d(s.value),e.innerHTML=s.value,e.className=u(e.className,t,s.language),e.result={language:s.language,re:s.r},s.second_best&&(e.second_best={language:s.second_best.language,re:s.second_best.r})}}function h(e){y=r(y,e)}function m(){m.called=!0;var e=document.querySelectorAll("pre code");Array.prototype.forEach.call(e,p)}function f(){addEventListener("DOMContentLoaded",m,!1),addEventListener("load",m,!1)}function g(e,t){var n=w[e]=t(this);n.aliases&&n.aliases.forEach(function(t){x[t]=e})}function v(){return Object.keys(w)}function b(e){return w[e]||w[x[e]]}var y={classPrefix:"hljs-",tabReplace:null,useBR:!1,languages:void 0},w={},x={};this.highlight=l,this.highlightAuto=c,this.fixMarkup=d,this.highlightBlock=p,this.configure=h,this.initHighlighting=m,this.initHighlightingOnLoad=f,this.registerLanguage=g,this.listLanguages=v,this.getLanguage=b,this.inherit=r,this.IR="[a-zA-Z][a-zA-Z0-9_]*",this.UIR="[a-zA-Z_][a-zA-Z0-9_]*",this.NR="\\b\\d+(\\.\\d+)?",this.CNR="(\\b0[xX][a-fA-F0-9]+|(\\b\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)",this.BNR="\\b(0b[01]+)",this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|-|-=|/=|/|:|;|<<|<<=|<=|<|===|==|=|>>>=|>>=|>=|>>>|>>|>|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~",this.BE={b:"\\\\[\\s\\S]",r:0},this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE]},this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE]},this.PWM={b:/\b(a|an|the|are|I|I'm|isn't|don't|doesn't|won't|but|just|should|pretty|simply|enough|gonna|going|wtf|so|such)\b/},this.CLCM={cN:"comment",b:"//",e:"$",c:[this.PWM]},this.CBCM={cN:"comment",b:"/\\*",e:"\\*/",c:[this.PWM]},this.HCM={cN:"comment",b:"#",e:"$",c:[this.PWM]},this.NM={cN:"number",b:this.NR,r:0},this.CNM={cN:"number",b:this.CNR,r:0},this.BNM={cN:"number",b:this.BNR,r:0},this.CSSNM={cN:"number",b:this.NR+"(%|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc|px|deg|grad|rad|turn|s|ms|Hz|kHz|dpi|dpcm|dppx)?",r:0},this.RM={cN:"regexp",b:/\//,e:/\/[gimuy]*/,i:/\n/,c:[this.BE,{b:/\[/,e:/\]/,r:0,c:[this.BE]}]},this.TM={cN:"title",b:this.IR,r:0},this.UTM={cN:"title",b:this.UIR,r:0}};n.registerLanguage("javascript",function(e){return{aliases:["js"],k:{keyword:"in if for while finally var new function do return void else break catch instanceof with throw case default try this switch continue typeof delete let yield const class",literal:"true false null undefined NaN Infinity",built_in:"eval isFinite isNaN parseFloat parseInt decodeURI decodeURIComponent encodeURI encodeURIComponent escape unescape Object Function Boolean Error EvalError InternalError RangeError ReferenceError StopIteration SyntaxError TypeError URIError Number Math Date String RegExp Array Float32Array Float64Array Int16Array Int32Array Int8Array Uint16Array Uint32Array Uint8Array Uint8ClampedArray ArrayBuffer DataView JSON Intl arguments require module console window document"},c:[{cN:"pi",b:/^\s*('|")use strict('|")/,r:10},e.ASM,e.QSM,e.CLCM,e.CBCM,e.CNM,{b:"("+e.RSR+"|\\b(case|return|throw)\\b)\\s*",k:"return throw case",c:[e.CLCM,e.CBCM,e.RM,{b:/</,e:/>;/,r:0,sL:"xml"}],r:0},{cN:"function",bK:"function",e:/\{/,eE:!0,c:[e.inherit(e.TM,{b:/[A-Za-z$_][0-9A-Za-z$_]*/}),{cN:"params",b:/\(/,e:/\)/,c:[e.CLCM,e.CBCM],i:/["'\(]/}],i:/\[|%/},{b:/\$[(.]/},{b:"\\."+e.IR,r:0}]}}),n.registerLanguage("sql",function(e){var t={cN:"comment",b:"--",e:"$"};return{cI:!0,i:/[<>]/,c:[{cN:"operator",bK:"begin end start commit rollback savepoint lock alter create drop rename call delete do handler insert load replace select truncate update set show pragma grant merge describe use explain help declare prepare execute deallocate savepoint release unlock purge reset change stop analyze cache flush optimize repair kill install uninstall checksum restore check backup",e:/;/,eW:!0,k:{keyword:"abs absolute acos action add adddate addtime aes_decrypt aes_encrypt after aggregate all allocate alter analyze and any are as asc ascii asin assertion at atan atan2 atn2 authorization authors avg backup before begin benchmark between bin binlog bit_and bit_count bit_length bit_or bit_xor both by cache call cascade cascaded case cast catalog ceil ceiling chain change changed char_length character_length charindex charset check checksum checksum_agg choose close coalesce coercibility collate collation collationproperty column columns columns_updated commit compress concat concat_ws concurrent connect connection connection_id consistent constraint constraints continue contributors conv convert convert_tz corresponding cos cot count count_big crc32 create cross cume_dist curdate current current_date current_time current_timestamp current_user cursor curtime data database databases datalength date_add date_format date_sub dateadd datediff datefromparts datename datepart datetime2fromparts datetimeoffsetfromparts day dayname dayofmonth dayofweek dayofyear deallocate declare decode default deferrable deferred degrees delayed delete des_decrypt des_encrypt des_key_file desc describe descriptor diagnostics difference disconnect distinct distinctrow div do domain double drop dumpfile each else elt enclosed encode encrypt end end-exec engine engines eomonth errors escape escaped event eventdata events except exception exec execute exists exp explain export_set extended external extract fast fetch field fields find_in_set first first_value floor flush for force foreign format found found_rows from from_base64 from_days from_unixtime full function get get_format get_lock getdate getutcdate global go goto grant grants greatest group group_concat grouping grouping_id gtid_subset gtid_subtract handler having help hex high_priority hosts hour ident_current ident_incr ident_seed identified identity if ifnull ignore iif ilike immediate in index indicator inet6_aton inet6_ntoa inet_aton inet_ntoa infile initially inner innodb input insert install instr intersect into is is_free_lock is_ipv4 is_ipv4_compat is_ipv4_mapped is_not is_not_null is_used_lock isdate isnull isolation join key kill language last last_day last_insert_id last_value lcase lead leading least leaves left len lenght level like limit lines ln load load_file local localtime localtimestamp locate lock log log10 log2 logfile logs low_priority lower lpad ltrim make_set makedate maketime master master_pos_wait match matched max md5 medium merge microsecond mid min minute mod mode module month monthname mutex name_const names national natural nchar next no no_write_to_binlog not now nullif nvarchar oct octet_length of old_password on only open optimize option optionally or ord order outer outfile output pad parse partial partition password patindex percent_rank percentile_cont percentile_disc period_add period_diff pi plugin position pow power pragma precision prepare preserve primary prior privileges procedure procedure_analyze processlist profile profiles public publishingservername purge quarter query quick quote quotename radians rand read references regexp relative relaylog release release_lock rename repair repeat replace replicate reset restore restrict return returns reverse revoke right rlike rollback rollup round row row_count rows rpad rtrim savepoint schema scroll sec_to_time second section select serializable server session session_user set sha sha1 sha2 share show sign sin size slave sleep smalldatetimefromparts snapshot some soname soundex sounds_like space sql sql_big_result sql_buffer_result sql_cache sql_calc_found_rows sql_no_cache sql_small_result sql_variant_property sqlstate sqrt square start starting status std stddev stddev_pop stddev_samp stdev stdevp stop str str_to_date straight_join strcmp string stuff subdate substr substring subtime subtring_index sum switchoffset sysdate sysdatetime sysdatetimeoffset system_user sysutcdatetime table tables tablespace tan temporary terminated tertiary_weights then time time_format time_to_sec timediff timefromparts timestamp timestampadd timestampdiff timezone_hour timezone_minute to to_base64 to_days to_seconds todatetimeoffset trailing transaction translation trigger trigger_nestlevel triggers trim truncate try_cast try_convert try_parse ucase uncompress uncompressed_length unhex unicode uninstall union unique unix_timestamp unknown unlock update upgrade upped upper usage use user user_resources using utc_date utc_time utc_timestamp uuid uuid_short validate_password_strength value values var var_pop var_samp variables variance varp version view warnings week weekday weekofyear weight_string when whenever where with work write xml xor year yearweek zon",literal:"true false null",built_in:"array bigint binary bit blob boolean char character date dec decimal float int integer interval number numeric real serial smallint varchar varying int8 serial8 text"},c:[{cN:"string",b:"'",e:"'",c:[e.BE,{b:"''"}]},{cN:"string",b:'"',e:'"',c:[e.BE,{b:'""'}]},{cN:"string",b:"`",e:"`",c:[e.BE]},e.CNM,e.CBCM,t]},e.CBCM,t]}}),n.registerLanguage("python",function(e){var t={cN:"prompt",b:/^(>>>|\.\.\.) /},n={cN:"string",c:[e.BE],v:[{b:/(u|b)?r?'''/,e:/'''/,c:[t],r:10},{b:/(u|b)?r?"""/,e:/"""/,c:[t],r:10},{b:/(u|r|ur)'/,e:/'/,r:10},{b:/(u|r|ur)"/,e:/"/,r:10},{b:/(b|br)'/,e:/'/},{b:/(b|br)"/,e:/"/},e.ASM,e.QSM]},i={cN:"number",r:0,v:[{b:e.BNR+"[lLjJ]?"},{b:"\\b(0o[0-7]+)[lLjJ]?"},{b:e.CNR+"[lLjJ]?"}]},r={cN:"params",b:/\(/,e:/\)/,c:["self",t,i,n]},o={e:/:/,i:/[${=;\n]/,c:[e.UTM,r]};return{aliases:["py","gyp"],k:{keyword:"and elif is global as in if from raise for except finally print import pass return exec else break not with class assert yield try while continue del or def lambda nonlocal|10 None True False",built_in:"Ellipsis NotImplemented"},i:/(<\/|->|\?)/,c:[t,i,n,e.HCM,e.inherit(o,{cN:"function",bK:"def",r:10}),e.inherit(o,{cN:"class",bK:"class"}),{cN:"decorator",b:/@/,e:/$/},{b:/\b(print|exec)\(/}]}}),n.registerLanguage("perl",function(e){var t="getpwent getservent quotemeta msgrcv scalar kill dbmclose undef lc ma syswrite tr send umask sysopen shmwrite vec qx utime local oct semctl localtime readpipe do return format read sprintf dbmopen pop getpgrp not getpwnam rewinddir qqfileno qw endprotoent wait sethostent bless s|0 opendir continue each sleep endgrent shutdown dump chomp connect getsockname die socketpair close flock exists index shmgetsub for endpwent redo lstat msgctl setpgrp abs exit select print ref gethostbyaddr unshift fcntl syscall goto getnetbyaddr join gmtime symlink semget splice x|0 getpeername recv log setsockopt cos last reverse gethostbyname getgrnam study formline endhostent times chop length gethostent getnetent pack getprotoent getservbyname rand mkdir pos chmod y|0 substr endnetent printf next open msgsnd readdir use unlink getsockopt getpriority rindex wantarray hex system getservbyport endservent int chr untie rmdir prototype tell listen fork shmread ucfirst setprotoent else sysseek link getgrgid shmctl waitpid unpack getnetbyname reset chdir grep split require caller lcfirst until warn while values shift telldir getpwuid my getprotobynumber delete and sort uc defined srand accept package seekdir getprotobyname semop our rename seek if q|0 chroot sysread setpwent no crypt getc chown sqrt write setnetent setpriority foreach tie sin msgget map stat getlogin unless elsif truncate exec keys glob tied closedirioctl socket readlink eval xor readline binmode setservent eof ord bind alarm pipe atan2 getgrent exp time push setgrent gt lt or ne m|0 break given say state when",n={cN:"subst",b:"[$@]\\{",e:"\\}",k:t},i={b:"->{",e:"}"},r={cN:"variable",v:[{b:/\$\d/},{b:/[\$\%\@](\^\w\b|#\w+(\:\:\w+)*|{\w+}|\w+(\:\:\w*)*)/},{b:/[\$\%\@][^\s\w{]/,r:0}]},o={cN:"comment",b:"^(__END__|__DATA__)",e:"\\n$",r:5},a=[e.BE,n,r],s=[r,e.HCM,o,{cN:"comment",b:"^\\=\\w",e:"\\=cut",eW:!0},i,{cN:"string",c:a,v:[{b:"q[qwxr]?\\s*\\(",e:"\\)",r:5},{b:"q[qwxr]?\\s*\\[",e:"\\]",r:5},{b:"q[qwxr]?\\s*\\{",e:"\\}",r:5},{b:"q[qwxr]?\\s*\\|",e:"\\|",r:5},{b:"q[qwxr]?\\s*\\<",e:"\\>",r:5},{b:"qw\\s+q",e:"q",r:5},{b:"'",e:"'",c:[e.BE]},{b:'"',e:'"'},{b:"`",e:"`",c:[e.BE]},{b:"{\\w+}",c:[],r:0},{b:"-?\\w+\\s*\\=\\>",c:[],r:0}]},{cN:"number",b:"(\\b0[0-7_]+)|(\\b0x[0-9a-fA-F_]+)|(\\b[1-9][0-9_]*(\\.[0-9_]+)?)|[0_]\\b",r:0},{b:"(\\/\\/|"+e.RSR+"|\\b(split|return|print|reverse|grep)\\b)\\s*",k:"split return print reverse grep",r:0,c:[e.HCM,o,{cN:"regexp",b:"(s|tr|y)/(\\\\.|[^/])*/(\\\\.|[^/])*/[a-z]*",r:10},{cN:"regexp",b:"(m|qr)?/",e:"/[a-z]*",c:[e.BE],r:0}]},{cN:"sub",bK:"sub",e:"(\\s*\\(.*?\\))?[;{]",r:5},{cN:"operator",b:"-\\w\\b",r:0}];return n.c=s,i.c=s,{aliases:["pl"],k:t,c:s}}),n.registerLanguage("apache",function(e){var t={cN:"number",b:"[\\$%]\\d+"};return{aliases:["apacheconf"],cI:!0,c:[e.HCM,{cN:"tag",b:"</?",e:">"},{cN:"keyword",b:/\w+/,r:0,k:{common:"order deny allow setenv rewriterule rewriteengine rewritecond documentroot sethandler errordocument loadmodule options header listen serverroot servername"},starts:{e:/$/,r:0,k:{literal:"on off all"},c:[{cN:"sqbracket",b:"\\s\\[",e:"\\]$"},{cN:"cbracket",b:"[\\$%]\\{",e:"\\}",c:["self",t]},t,e.QSM]}}],i:/\S/}}),n.registerLanguage("less",function(e){var t="[\\w-]+",n="("+t+"|@{"+t+"})+",i=[],r=[],o=function(e){return{cN:"string",b:"~?"+e+".*?"+e}},a=function(e,t,n){return{cN:e,b:t,r:n}},s=function(t,n,i){return e.inherit({cN:t,b:n+"\\(",e:"\\(",rB:!0,eE:!0,r:0},i)},l={b:"\\(",e:"\\)",c:r,r:0};r.push(e.CLCM,e.CBCM,o("'"),o('"'),e.CSSNM,a("hexcolor","#[0-9A-Fa-f]+\\b"),s("function","(url|data-uri)",{starts:{cN:"string",e:"[\\)\\n]",eE:!0}}),s("function",t),l,a("variable","@@?"+t,10),a("variable","@{"+t+"}"),a("built_in","~?`[^`]*?`"),{cN:"attribute",b:t+"\\s*:",e:":",rB:!0,eE:!0});var c=r.concat({b:"{",e:"}",c:i}),d={bK:"when",eW:!0,c:[{bK:"and not"}].concat(r)},u={cN:"attribute",b:n,r:0,starts:{e:"[;}]",rE:!0,c:r,i:"[<=$]"}},p={cN:"at_rule",b:"@(import|media|charset|font-face|(-[a-z]+-)?keyframes|supports|document|namespace|page|viewport|host)\\b",starts:{e:"[;{}]",rE:!0,c:r,r:0}},h={cN:"variable",v:[{b:"@"+t+"\\s*:",r:15},{b:"@"+t}],starts:{e:"[;}]",rE:!0,c:c}},m={v:[{b:"[\\.#:&\\[]",e:"[;{}]"},{b:"(?="+n+")("+["//.*","/\\*(?:[^*]|\\*+[^*/])*\\*+/","\\[[^\\]]*\\]","@{.*?}","[^;}'\"`]"].join("|")+")*?[^@'\"`]{",e:"{"}],rB:!0,rE:!0,i:"[<='$\"]",c:[e.CLCM,e.CBCM,d,a("keyword","all\\b"),a("variable","@{"+t+"}"),a("tag",n+"%?",0),a("id","#"+n),a("class","\\."+n,0),a("keyword","&",0),s("pseudo",":not"),s("keyword",":extend"),a("pseudo","::?"+n),{cN:"attr_selector",b:"\\[",e:"\\]"},{b:"\\(",e:"\\)",c:c},{b:"!important"}]};return i.push(e.CLCM,e.CBCM,p,h,m,u),{cI:!0,i:"[=>'/<($\"]",c:i}}),n.registerLanguage("xml",function(){var e="[A-Za-z0-9\\._:-]+",t={b:/<\?(php)?(?!\w)/,e:/\?>/,sL:"php",subLanguageMode:"continuous"},n={eW:!0,i:/</,r:0,c:[t,{cN:"attribute",b:e,r:0},{b:"=",r:0,c:[{cN:"value",c:[t],v:[{b:/"/,e:/"/},{b:/'/,e:/'/},{b:/[^\s\/>]+/}]}]}]};return{aliases:["html","xhtml","rss","atom","xsl","plist"],cI:!0,c:[{cN:"doctype",b:"<!DOCTYPE",e:">",r:10,c:[{b:"\\[",e:"\\]"}]},{cN:"comment",b:"<!--",e:"-->",r:10},{cN:"cdata",b:"<\\!\\[CDATA\\[",e:"\\]\\]>",r:10},{cN:"tag",b:"<style(?=\\s|>|$)",e:">",k:{title:"style"},c:[n],starts:{e:"</style>",rE:!0,sL:"css"}},{cN:"tag",b:"<script(?=\\s|>|$)",e:">",k:{title:"script"},c:[n],starts:{e:"</script>",rE:!0,sL:"javascript"}},t,{cN:"pi",b:/<\?\w+/,e:/\?>/,r:10},{cN:"tag",b:"</?",e:"/?>",c:[{cN:"title",b:/[^ \/><\n\t]+/,r:0},n]}]}}),n.registerLanguage("css",function(e){var t="[a-zA-Z-][a-zA-Z0-9_-]*",n={cN:"function",b:t+"\\(",rB:!0,eE:!0,e:"\\("};return{cI:!0,i:"[=/|']",c:[e.CBCM,{cN:"id",b:"\\#[A-Za-z0-9_-]+"},{cN:"class",b:"\\.[A-Za-z0-9_-]+",r:0},{cN:"attr_selector",b:"\\[",e:"\\]",i:"$"},{cN:"pseudo",b:":(:)?[a-zA-Z0-9\\_\\-\\+\\(\\)\\\"\\']+"},{cN:"at_rule",b:"@(font-face|page)",l:"[a-z-]+",k:"font-face page"},{cN:"at_rule",b:"@",e:"[{;]",c:[{cN:"keyword",b:/\S+/},{b:/\s/,eW:!0,eE:!0,r:0,c:[n,e.ASM,e.QSM,e.CSSNM]}]},{cN:"tag",b:t,r:0},{cN:"rules",b:"{",e:"}",i:"[^\\s]",r:0,c:[e.CBCM,{cN:"rule",b:"[^\\s]",rB:!0,e:";",eW:!0,c:[{cN:"attribute",b:"[A-Z\\_\\.\\-]+",e:":",eE:!0,i:"[^\\s]",starts:{cN:"value",eW:!0,eE:!0,c:[n,e.CSSNM,e.QSM,e.ASM,e.CBCM,{cN:"hexcolor",b:"#[0-9A-Fa-f]+"},{cN:"important",b:"!important"}]}}]}]}]}}),n.registerLanguage("cpp",function(e){var t={keyword:"false int float while private char catch export virtual operator sizeof dynamic_cast|10 typedef const_cast|10 const struct for static_cast|10 union namespace unsigned long throw volatile static protected bool template mutable if public friend do return goto auto void enum else break new extern using true class asm case typeid short reinterpret_cast|10 default double register explicit signed typename try this switch continue wchar_t inline delete alignof char16_t char32_t constexpr decltype noexcept nullptr static_assert thread_local restrict _Bool complex _Complex _Imaginary",built_in:"std string cin cout cerr clog stringstream istringstream ostringstream auto_ptr deque list queue stack vector map set bitset multiset multimap unordered_set unordered_map unordered_multiset unordered_multimap array shared_ptr abort abs acos asin atan2 atan calloc ceil cosh cos exit exp fabs floor fmod fprintf fputs free frexp fscanf isalnum isalpha iscntrl isdigit isgraph islower isprint ispunct isspace isupper isxdigit tolower toupper labs ldexp log10 log malloc memchr memcmp memcpy memset modf pow printf putchar puts scanf sinh sin snprintf sprintf sqrt sscanf strcat strchr strcmp strcpy strcspn strlen strncat strncmp strncpy strpbrk strrchr strspn strstr tanh tan vfprintf vprintf vsprintf"};return{aliases:["c","h","c++","h++"],k:t,i:"</",c:[e.CLCM,e.CBCM,e.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},e.CNM,{cN:"preprocessor",b:"#",e:"$",k:"if else elif endif define undef warning error line pragma",c:[{b:'include\\s*[<"]',e:'[>"]',k:"include",i:"\\n"},e.CLCM]},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:t,c:["self"]},{b:e.IR+"::"}]}}),n.registerLanguage("json",function(e){var t={literal:"true false null"},n=[e.QSM,e.CNM],i={cN:"value",e:",",eW:!0,eE:!0,c:n,k:t},r={b:"{",e:"}",c:[{cN:"attribute",b:'\\s*"',e:'"\\s*:\\s*',eB:!0,eE:!0,c:[e.BE],i:"\\n",starts:i}],i:"\\S"},o={b:"\\[",e:"\\]",c:[e.inherit(i,{cN:null})],i:"\\S"};return n.splice(n.length,0,r,o),{c:n,k:t,i:"\\S"}}),n.registerLanguage("coffeescript",function(e){var t={keyword:"in if for while finally new do return else break catch instanceof throw try this switch continue typeof delete debugger super then unless until loop of by when and or is isnt not",literal:"true false null undefined yes no on off",reserved:"case default function var void with const let enum export import native __hasProp __extends __slice __bind __indexOf",built_in:"npm require console print module global window document"},n="[A-Za-z$_][0-9A-Za-z$_]*",i={cN:"subst",b:/#\{/,e:/}/,k:t},r=[e.BNM,e.inherit(e.CNM,{starts:{e:"(\\s*/)?",r:0}}),{cN:"string",v:[{b:/'''/,e:/'''/,c:[e.BE]},{b:/'/,e:/'/,c:[e.BE]},{b:/"""/,e:/"""/,c:[e.BE,i]},{b:/"/,e:/"/,c:[e.BE,i]}]},{cN:"regexp",v:[{b:"///",e:"///",c:[i,e.HCM]},{b:"//[gim]*",r:0},{b:/\/(?![ *])(\\\/|.)*?\/[gim]*(?=\W|$)/}]},{cN:"property",b:"@"+n},{b:"`",e:"`",eB:!0,eE:!0,sL:"javascript"}];i.c=r;var o=e.inherit(e.TM,{b:n}),a="(\\(.*\\))?\\s*\\B[-=]>",s={cN:"params",b:"\\([^\\(]",rB:!0,c:[{b:/\(/,e:/\)/,k:t,c:["self"].concat(r)}]};return{aliases:["coffee","cson","iced"],k:t,i:/\/\*/,c:r.concat([{cN:"comment",b:"###",e:"###",c:[e.PWM]},e.HCM,{cN:"function",b:"^\\s*"+n+"\\s*=\\s*"+a,e:"[-=]>",rB:!0,c:[o,s]},{b:/[:\(,=]\s*/,r:0,c:[{cN:"function",b:a,e:"[-=]>",rB:!0,c:[s]}]},{cN:"class",bK:"class",e:"$",i:/[:="\[\]]/,c:[{bK:"extends",eW:!0,i:/[:="\[\]]/,c:[o]},o]},{cN:"attribute",b:n+":",e:":",rB:!0,rE:!0,r:0}])}}),n.registerLanguage("php",function(e){var t={cN:"variable",b:"\\$+[a-zA-Z_-ÿ][a-zA-Z0-9_-ÿ]*"},n={cN:"preprocessor",b:/<\?(php)?|\?>/},i={cN:"string",c:[e.BE,n],v:[{b:'b"',e:'"'},{b:"b'",e:"'"},e.inherit(e.ASM,{i:null}),e.inherit(e.QSM,{i:null})]},r={v:[e.BNM,e.CNM]};return{aliases:["php3","php4","php5","php6"],cI:!0,k:"and include_once list abstract global private echo interface as static endswitch array null if endwhile or const for endforeach self var while isset public protected exit foreach throw elseif include __FILE__ empty require_once do xor return parent clone use __CLASS__ __LINE__ else break print eval new catch __METHOD__ case exception default die require __FUNCTION__ enddeclare final try switch continue endfor endif declare unset true false trait goto instanceof insteadof __DIR__ __NAMESPACE__ yield finally",c:[e.CLCM,e.HCM,{cN:"comment",b:"/\\*",e:"\\*/",c:[{cN:"phpdoc",b:"\\s@[A-Za-z]+"},n]},{cN:"comment",b:"__halt_compiler.+?;",eW:!0,k:"__halt_compiler",l:e.UIR},{cN:"string",b:"<<<['\"]?\\w+['\"]?$",e:"^\\w+;",c:[e.BE]},n,t,{b:/->+[a-zA-Z_\x7f-\xff][a-zA-Z0-9_\x7f-\xff]*/},{cN:"function",bK:"function",e:/[;{]/,eE:!0,i:"\\$|\\[|%",c:[e.UTM,{cN:"params",b:"\\(",e:"\\)",c:["self",t,e.CBCM,i,r]}]},{cN:"class",bK:"class interface",e:"{",eE:!0,i:/[:\(\$"]/,c:[{bK:"extends implements"},e.UTM]},{bK:"namespace",e:";",i:/[\.']/,c:[e.UTM]},{bK:"use",e:";",c:[e.UTM]},{b:"=>"},i,r]}}),n.registerLanguage("swift",function(e){var t={keyword:"class deinit enum extension func import init let protocol static struct subscript typealias var break case continue default do else fallthrough if in for return switch where while as dynamicType is new super self Self Type __COLUMN__ __FILE__ __FUNCTION__ __LINE__ associativity didSet get infix inout left mutating none nonmutating operator override postfix precedence prefix right set unowned unowned safe unsafe weak willSet",literal:"true false nil",built_in:"abs advance alignof alignofValue assert bridgeFromObjectiveC bridgeFromObjectiveCUnconditional bridgeToObjectiveC bridgeToObjectiveCUnconditional c contains count countElements countLeadingZeros debugPrint debugPrintln distance dropFirst dropLast dump encodeBitsAsWords enumerate equal false filter find getBridgedObjectiveCType getVaList indices insertionSort isBridgedToObjectiveC isBridgedVerbatimToObjectiveC isUniquelyReferenced join lexicographicalCompare map max maxElement min minElement nil numericCast partition posix print println quickSort reduce reflect reinterpretCast reverse roundUpToAlignment sizeof sizeofValue sort split startsWith strideof strideofValue swap swift toString transcode true underestimateCount unsafeReflect withExtendedLifetime withObjectAtPlusZero withUnsafePointer withUnsafePointerToObject withUnsafePointers withVaList"
},n={cN:"type",b:"\\b[A-Z][\\w']*",r:0},i={cN:"comment",b:"/\\*",e:"\\*/",c:[e.PWM,"self"]},r={cN:"subst",b:/\\\(/,e:"\\)",k:t,c:[]},o={cN:"number",b:"\\b([\\d_]+(\\.[\\deE_]+)?|0x[a-fA-F0-9_]+(\\.[a-fA-F0-9p_]+)?|0b[01_]+|0o[0-7_]+)\\b",r:0},a=e.inherit(e.QSM,{c:[r,e.BE]});return r.c=[o],{k:t,c:[a,e.CLCM,i,n,o,{cN:"func",bK:"func",e:"{",eE:!0,c:[e.inherit(e.TM,{b:/[A-Za-z$_][0-9A-Za-z$_]*/,i:/\(/}),{cN:"generics",b:/\</,e:/\>/,i:/\>/},{cN:"params",b:/\(/,e:/\)/,k:t,c:["self",o,a,e.CBCM,{b:":"}],i:/["']/}],i:/\[|%/},{cN:"class",k:"struct protocol class extension enum",b:"(struct|protocol|class(?! (func|var))|extension|enum)",e:"\\{",eE:!0,c:[e.inherit(e.TM,{b:/[A-Za-z$_][0-9A-Za-z$_]*/})]},{cN:"preprocessor",b:"(@assignment|@class_protocol|@exported|@final|@lazy|@noreturn|@NSCopying|@NSManaged|@objc|@optional|@required|@auto_closure|@noreturn|@IBAction|@IBDesignable|@IBInspectable|@IBOutlet|@infix|@prefix|@postfix)"}]}}),n.registerLanguage("nginx",function(e){var t={cN:"variable",v:[{b:/\$\d+/},{b:/\$\{/,e:/}/},{b:"[\\$\\@]"+e.UIR}]},n={eW:!0,l:"[a-z/_]+",k:{built_in:"on off yes no true false none blocked debug info notice warn error crit select break last permanent redirect kqueue rtsig epoll poll /dev/poll"},r:0,i:"=>",c:[e.HCM,{cN:"string",c:[e.BE,t],v:[{b:/"/,e:/"/},{b:/'/,e:/'/}]},{cN:"url",b:"([a-z]+):/",e:"\\s",eW:!0,eE:!0,c:[t]},{cN:"regexp",c:[e.BE,t],v:[{b:"\\s\\^",e:"\\s|{|;",rE:!0},{b:"~\\*?\\s+",e:"\\s|{|;",rE:!0},{b:"\\*(\\.[a-z\\-]+)+"},{b:"([a-z\\-]+\\.)+\\*"}]},{cN:"number",b:"\\b\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}(:\\d{1,5})?\\b"},{cN:"number",b:"\\b\\d+[kKmMgGdshdwy]*\\b",r:0},t]};return{aliases:["nginxconf"],c:[e.HCM,{b:e.UIR+"\\s",e:";|{",rB:!0,c:[{cN:"title",b:e.UIR,starts:n}],r:0}],i:"[^\\s\\}]"}}),n.registerLanguage("diff",function(){return{aliases:["patch"],c:[{cN:"chunk",r:10,v:[{b:/^\@\@ +\-\d+,\d+ +\+\d+,\d+ +\@\@$/},{b:/^\*\*\* +\d+,\d+ +\*\*\*\*$/},{b:/^\-\-\- +\d+,\d+ +\-\-\-\-$/}]},{cN:"header",v:[{b:/Index: /,e:/$/},{b:/=====/,e:/=====$/},{b:/^\-\-\-/,e:/$/},{b:/^\*{3} /,e:/$/},{b:/^\+\+\+/,e:/$/},{b:/\*{5}/,e:/\*{5}$/}]},{cN:"addition",b:"^\\+",e:"$"},{cN:"deletion",b:"^\\-",e:"$"},{cN:"change",b:"^\\!",e:"$"}]}}),n.registerLanguage("objectivec",function(e){var t={keyword:"int float while char export sizeof typedef const struct for union unsigned long volatile static bool mutable if do return goto void enum else break extern asm case short default double register explicit signed typename this switch continue wchar_t inline readonly assign readwrite self @synchronized id typeof nonatomic super unichar IBOutlet IBAction strong weak copy in out inout bycopy byref oneway __strong __weak __block __autoreleasing @private @protected @public @try @property @end @throw @catch @finally @autoreleasepool @synthesize @dynamic @selector @optional @required",literal:"false true FALSE TRUE nil YES NO NULL",built_in:"NSString NSData NSDictionary CGRect CGPoint UIButton UILabel UITextView UIWebView MKMapView NSView NSViewController NSWindow NSWindowController NSSet NSUUID NSIndexSet UISegmentedControl NSObject UITableViewDelegate UITableViewDataSource NSThread UIActivityIndicator UITabbar UIToolBar UIBarButtonItem UIImageView NSAutoreleasePool UITableView BOOL NSInteger CGFloat NSException NSLog NSMutableString NSMutableArray NSMutableDictionary NSURL NSIndexPath CGSize UITableViewCell UIView UIViewController UINavigationBar UINavigationController UITabBarController UIPopoverController UIPopoverControllerDelegate UIImage NSNumber UISearchBar NSFetchedResultsController NSFetchedResultsChangeType UIScrollView UIScrollViewDelegate UIEdgeInsets UIColor UIFont UIApplication NSNotFound NSNotificationCenter NSNotification UILocalNotification NSBundle NSFileManager NSTimeInterval NSDate NSCalendar NSUserDefaults UIWindow NSRange NSArray NSError NSURLRequest NSURLConnection NSURLSession NSURLSessionDataTask NSURLSessionDownloadTask NSURLSessionUploadTask NSURLResponseUIInterfaceOrientation MPMoviePlayerController dispatch_once_t dispatch_queue_t dispatch_sync dispatch_async dispatch_once"},n=/[a-zA-Z@][a-zA-Z0-9_]*/,i="@interface @class @protocol @implementation";return{aliases:["m","mm","objc","obj-c"],k:t,l:n,i:"</",c:[e.CLCM,e.CBCM,e.CNM,e.QSM,{cN:"string",v:[{b:'@"',e:'"',i:"\\n",c:[e.BE]},{b:"'",e:"[^\\\\]'",i:"[^\\\\][^']"}]},{cN:"preprocessor",b:"#",e:"$",c:[{cN:"title",v:[{b:'"',e:'"'},{b:"<",e:">"}]}]},{cN:"class",b:"("+i.split(" ").join("|")+")\\b",e:"({|$)",eE:!0,k:i,l:n,c:[e.UTM]},{cN:"variable",b:"\\."+e.UIR,r:0}]}}),n.registerLanguage("makefile",function(e){var t={cN:"variable",b:/\$\(/,e:/\)/,c:[e.BE]};return{aliases:["mk","mak"],c:[e.HCM,{b:/^\w+\s*\W*=/,rB:!0,r:0,starts:{cN:"constant",e:/\s*\W*=/,eE:!0,starts:{e:/$/,r:0,c:[t]}}},{cN:"title",b:/^[\w]+:\s*$/},{cN:"phony",b:/^\.PHONY:/,e:/$/,k:".PHONY",l:/[\.\w]+/},{b:/^\t+/,e:/$/,r:0,c:[e.QSM,t]}]}}),n.registerLanguage("ruby",function(e){var t="[a-zA-Z_]\\w*[!?=]?|[-+~]\\@|<<|>>|=~|===?|<=>|[<>]=?|\\*\\*|[-/+%^&*~`|]|\\[\\]=?",n="and false then defined module in return redo if BEGIN retry end for true self when next until do begin unless END rescue nil else break undef not super class case require yield alias while ensure elsif or include attr_reader attr_writer attr_accessor",i={cN:"yardoctag",b:"@[A-Za-z]+"},r={cN:"value",b:"#<",e:">"},o={cN:"comment",v:[{b:"#",e:"$",c:[i]},{b:"^\\=begin",e:"^\\=end",c:[i],r:10},{b:"^__END__",e:"\\n$"}]},a={cN:"subst",b:"#\\{",e:"}",k:n},s={cN:"string",c:[e.BE,a],v:[{b:/'/,e:/'/},{b:/"/,e:/"/},{b:/`/,e:/`/},{b:"%[qQwWx]?\\(",e:"\\)"},{b:"%[qQwWx]?\\[",e:"\\]"},{b:"%[qQwWx]?{",e:"}"},{b:"%[qQwWx]?<",e:">"},{b:"%[qQwWx]?/",e:"/"},{b:"%[qQwWx]?%",e:"%"},{b:"%[qQwWx]?-",e:"-"},{b:"%[qQwWx]?\\|",e:"\\|"},{b:/\B\?(\\\d{1,3}|\\x[A-Fa-f0-9]{1,2}|\\u[A-Fa-f0-9]{4}|\\?\S)\b/}]},l={cN:"params",b:"\\(",e:"\\)",k:n},c=[s,r,o,{cN:"class",bK:"class module",e:"$|;",i:/=/,c:[e.inherit(e.TM,{b:"[A-Za-z_]\\w*(::\\w+)*(\\?|\\!)?"}),{cN:"inheritance",b:"<\\s*",c:[{cN:"parent",b:"("+e.IR+"::)?"+e.IR}]},o]},{cN:"function",bK:"def",e:" |$|;",r:0,c:[e.inherit(e.TM,{b:t}),l,o]},{cN:"constant",b:"(::)?(\\b[A-Z]\\w*(::)?)+",r:0},{cN:"symbol",b:e.UIR+"(\\!|\\?)?:",r:0},{cN:"symbol",b:":",c:[s,{b:t}],r:0},{cN:"number",b:"(\\b0[0-7_]+)|(\\b0x[0-9a-fA-F_]+)|(\\b[1-9][0-9_]*(\\.[0-9_]+)?)|[0_]\\b",r:0},{cN:"variable",b:"(\\$\\W)|((\\$|\\@\\@?)(\\w+))"},{b:"("+e.RSR+")\\s*",c:[r,o,{cN:"regexp",c:[e.BE,a],i:/\n/,v:[{b:"/",e:"/[a-z]*"},{b:"%r{",e:"}[a-z]*"},{b:"%r\\(",e:"\\)[a-z]*"},{b:"%r!",e:"![a-z]*"},{b:"%r\\[",e:"\\][a-z]*"}]}],r:0}];a.c=c,l.c=c;var d=[{b:/^\s*=>/,cN:"status",starts:{e:"$",c:c}},{cN:"prompt",b:/^\S[^=>\n]*>+/,starts:{e:"$",c:c}}];return{aliases:["rb","gemspec","podspec","thor","irb"],k:n,c:[o].concat(d).concat(c)}}),n.registerLanguage("bash",function(e){var t={cN:"variable",v:[{b:/\$[\w\d#@][\w\d_]*/},{b:/\$\{(.*?)\}/}]},n={cN:"string",b:/"/,e:/"/,c:[e.BE,t,{cN:"variable",b:/\$\(/,e:/\)/,c:[e.BE]}]},i={cN:"string",b:/'/,e:/'/};return{aliases:["sh","zsh"],l:/-?[a-z\.]+/,k:{keyword:"if then else elif fi for break continue while in do done exit return set declare case esac export exec function",literal:"true false",built_in:"printf echo read cd pwd pushd popd dirs let eval unset typeset readonly getopts source shopt caller type hash bind help sudo",operator:"-ne -eq -lt -gt -f -d -e -s -l -a"},c:[{cN:"shebang",b:/^#![^\n]+sh\s*$/,r:10},{cN:"function",b:/\w[\w\d_]*\s*\(\s*\)\s*\{/,rB:!0,c:[e.inherit(e.TM,{b:/\w[\w\d_]*/})],r:0},e.HCM,e.NM,n,i,t]}}),n.registerLanguage("cs",function(e){var t="abstract as base bool break byte case catch char checked const continue decimal default delegate do double else enum event explicit extern false finally fixed float for foreach goto if implicit in int interface internal is lock long new null object operator out override params private protected public readonly ref return sbyte sealed short sizeof stackalloc static string struct switch this throw true try typeof uint ulong unchecked unsafe ushort using virtual volatile void while async await protected public private internal ascending descending from get group into join let orderby partial select set value var where yield",n=e.IR+"(<"+e.IR+">)?";return{aliases:["csharp"],k:t,i:/::/,c:[{cN:"comment",b:"///",e:"$",rB:!0,c:[{cN:"xmlDocTag",v:[{b:"///",r:0},{b:"<!--|-->"},{b:"</?",e:">"}]}]},e.CLCM,e.CBCM,{cN:"preprocessor",b:"#",e:"$",k:"if else elif endif define undef warning error line region endregion pragma checksum"},{cN:"string",b:'@"',e:'"',c:[{b:'""'}]},e.ASM,e.QSM,e.CNM,{bK:"class namespace interface",e:/[{;=]/,i:/[^\s:]/,c:[e.TM,e.CLCM,e.CBCM]},{bK:"new",e:/\s/,r:0},{cN:"function",b:"("+n+"\\s+)+"+e.IR+"\\s*\\(",rB:!0,e:/[{;=]/,eE:!0,k:t,c:[{b:e.IR+"\\s*\\(",rB:!0,c:[e.TM]},{cN:"params",b:/\(/,e:/\)/,k:t,c:[e.ASM,e.QSM,e.CNM,e.CBCM]},e.CLCM,e.CBCM]}]}}),n.registerLanguage("markdown",function(){return{aliases:["md","mkdown","mkd"],c:[{cN:"header",v:[{b:"^#{1,6}",e:"$"},{b:"^.+?\\n[=-]{2,}$"}]},{b:"<",e:">",sL:"xml",r:0},{cN:"bullet",b:"^([*+-]|(\\d+\\.))\\s+"},{cN:"strong",b:"[*_]{2}.+?[*_]{2}"},{cN:"emphasis",v:[{b:"\\*.+?\\*"},{b:"_.+?_",r:0}]},{cN:"blockquote",b:"^>\\s+",e:"$"},{cN:"code",v:[{b:"`.+?`"},{b:"^( {4}|	)",e:"$",r:0}]},{cN:"horizontal_rule",b:"^[-\\*]{3,}",e:"$"},{b:"\\[.+?\\][\\(\\[].*?[\\)\\]]",rB:!0,c:[{cN:"link_label",b:"\\[",e:"\\]",eB:!0,rE:!0,r:0},{cN:"link_url",b:"\\]\\(",e:"\\)",eB:!0,eE:!0},{cN:"link_reference",b:"\\]\\[",e:"\\]",eB:!0,eE:!0}],r:10},{b:"^\\[.+\\]:",rB:!0,c:[{cN:"link_reference",b:"\\[",e:"\\]:",eB:!0,eE:!0,starts:{cN:"link_url",e:"$"}}]}]}}),n.registerLanguage("ini",function(e){return{cI:!0,i:/\S/,c:[{cN:"comment",b:";",e:"$"},{cN:"title",b:"^\\[",e:"\\]"},{cN:"setting",b:"^[a-z0-9\\[\\]_-]+[ \\t]*=[ \\t]*",e:"$",c:[{cN:"value",eW:!0,k:"on off true false yes no",c:[e.QSM,e.NM],r:0}]}]}}),n.registerLanguage("scss",function(e){var t="[a-zA-Z-][a-zA-Z0-9_-]*",n={cN:"variable",b:"(\\$"+t+")\\b"},i={cN:"function",b:t+"\\(",rB:!0,eE:!0,e:"\\("},r={cN:"hexcolor",b:"#[0-9A-Fa-f]+"};return{cN:"attribute",b:"[A-Z\\_\\.\\-]+",e:":",eE:!0,i:"[^\\s]",starts:{cN:"value",eW:!0,eE:!0,c:[i,r,e.CSSNM,e.QSM,e.ASM,e.CBCM,{cN:"important",b:"!important"}]}},{cI:!0,i:"[=/|']",c:[e.CLCM,e.CBCM,i,{cN:"id",b:"\\#[A-Za-z0-9_-]+",r:0},{cN:"class",b:"\\.[A-Za-z0-9_-]+",r:0},{cN:"attr_selector",b:"\\[",e:"\\]",i:"$"},{cN:"tag",b:"\\b(a|abbr|acronym|address|area|article|aside|audio|b|base|big|blockquote|body|br|button|canvas|caption|cite|code|col|colgroup|command|datalist|dd|del|details|dfn|div|dl|dt|em|embed|fieldset|figcaption|figure|footer|form|frame|frameset|(h[1-6])|head|header|hgroup|hr|html|i|iframe|img|input|ins|kbd|keygen|label|legend|li|link|map|mark|meta|meter|nav|noframes|noscript|object|ol|optgroup|option|output|p|param|pre|progress|q|rp|rt|ruby|samp|script|section|select|small|span|strike|strong|style|sub|sup|table|tbody|td|textarea|tfoot|th|thead|time|title|tr|tt|ul|var|video)\\b",r:0},{cN:"pseudo",b:":(visited|valid|root|right|required|read-write|read-only|out-range|optional|only-of-type|only-child|nth-of-type|nth-last-of-type|nth-last-child|nth-child|not|link|left|last-of-type|last-child|lang|invalid|indeterminate|in-range|hover|focus|first-of-type|first-line|first-letter|first-child|first|enabled|empty|disabled|default|checked|before|after|active)"},{cN:"pseudo",b:"::(after|before|choices|first-letter|first-line|repeat-index|repeat-item|selection|value)"},n,{cN:"attribute",b:"\\b(z-index|word-wrap|word-spacing|word-break|width|widows|white-space|visibility|vertical-align|unicode-bidi|transition-timing-function|transition-property|transition-duration|transition-delay|transition|transform-style|transform-origin|transform|top|text-underline-position|text-transform|text-shadow|text-rendering|text-overflow|text-indent|text-decoration-style|text-decoration-line|text-decoration-color|text-decoration|text-align-last|text-align|tab-size|table-layout|right|resize|quotes|position|pointer-events|perspective-origin|perspective|page-break-inside|page-break-before|page-break-after|padding-top|padding-right|padding-left|padding-bottom|padding|overflow-y|overflow-x|overflow-wrap|overflow|outline-width|outline-style|outline-offset|outline-color|outline|orphans|order|opacity|object-position|object-fit|normal|none|nav-up|nav-right|nav-left|nav-index|nav-down|min-width|min-height|max-width|max-height|mask|marks|margin-top|margin-right|margin-left|margin-bottom|margin|list-style-type|list-style-position|list-style-image|list-style|line-height|letter-spacing|left|justify-content|initial|inherit|ime-mode|image-orientation|image-resolution|image-rendering|icon|hyphens|height|font-weight|font-variant-ligatures|font-variant|font-style|font-stretch|font-size-adjust|font-size|font-language-override|font-kerning|font-feature-settings|font-family|font|float|flex-wrap|flex-shrink|flex-grow|flex-flow|flex-direction|flex-basis|flex|filter|empty-cells|display|direction|cursor|counter-reset|counter-increment|content|column-width|column-span|column-rule-width|column-rule-style|column-rule-color|column-rule|column-gap|column-fill|column-count|columns|color|clip-path|clip|clear|caption-side|break-inside|break-before|break-after|box-sizing|box-shadow|box-decoration-break|bottom|border-width|border-top-width|border-top-style|border-top-right-radius|border-top-left-radius|border-top-color|border-top|border-style|border-spacing|border-right-width|border-right-style|border-right-color|border-right|border-radius|border-left-width|border-left-style|border-left-color|border-left|border-image-width|border-image-source|border-image-slice|border-image-repeat|border-image-outset|border-image|border-color|border-collapse|border-bottom-width|border-bottom-style|border-bottom-right-radius|border-bottom-left-radius|border-bottom-color|border-bottom|border|background-size|background-repeat|background-position|background-origin|background-image|background-color|background-clip|background-attachment|background|backface-visibility|auto|animation-timing-function|animation-play-state|animation-name|animation-iteration-count|animation-fill-mode|animation-duration|animation-direction|animation-delay|animation|align-self|align-items|align-content)\\b",i:"[^\\s]"},{cN:"value",b:"\\b(whitespace|wait|w-resize|visible|vertical-text|vertical-ideographic|uppercase|upper-roman|upper-alpha|underline|transparent|top|thin|thick|text|text-top|text-bottom|tb-rl|table-header-group|table-footer-group|sw-resize|super|strict|static|square|solid|small-caps|separate|se-resize|scroll|s-resize|rtl|row-resize|ridge|right|repeat|repeat-y|repeat-x|relative|progress|pointer|overline|outside|outset|oblique|nowrap|not-allowed|normal|none|nw-resize|no-repeat|no-drop|newspaper|ne-resize|n-resize|move|middle|medium|ltr|lr-tb|lowercase|lower-roman|lower-alpha|loose|list-item|line|line-through|line-edge|lighter|left|keep-all|justify|italic|inter-word|inter-ideograph|inside|inset|inline|inline-block|inherit|inactive|ideograph-space|ideograph-parenthesis|ideograph-numeric|ideograph-alpha|horizontal|hidden|help|hand|groove|fixed|ellipsis|e-resize|double|dotted|distribute|distribute-space|distribute-letter|distribute-all-lines|disc|disabled|default|decimal|dashed|crosshair|collapse|col-resize|circle|char|center|capitalize|break-word|break-all|bottom|both|bolder|bold|block|bidi-override|below|baseline|auto|always|all-scroll|absolute|table|table-cell)\\b"},{cN:"value",b:":",e:";",c:[i,n,r,e.CSSNM,e.QSM,e.ASM,{cN:"important",b:"!important"}]},{cN:"at_rule",b:"@",e:"[{;]",k:"mixin include extend for if else each while charset import debug media page content font-face namespace warn",c:[i,n,e.QSM,e.ASM,r,e.CSSNM,{cN:"preprocessor",b:"\\s[A-Za-z0-9_.-]+",r:0}]}]}}),n.registerLanguage("http",function(){return{i:"\\S",c:[{cN:"status",b:"^HTTP/[0-9\\.]+",e:"$",c:[{cN:"number",b:"\\b\\d{3}\\b"}]},{cN:"request",b:"^[A-Z]+ (.*?) HTTP/[0-9\\.]+$",rB:!0,e:"$",c:[{cN:"string",b:" ",e:" ",eB:!0,eE:!0}]},{cN:"attribute",b:"^\\w",e:": ",eE:!0,i:"\\n|\\s|=",starts:{cN:"string",e:"$"}},{b:"\\n\\n",starts:{sL:"",eW:!0}}]}}),n.registerLanguage("java",function(e){var t=e.UIR+"(<"+e.UIR+">)?",n="false synchronized int abstract float private char boolean static null if const for true while long throw strictfp finally protected import native final return void enum else break transient new catch instanceof byte super volatile case assert short package default double public try this switch continue throws protected public private";return{aliases:["jsp"],k:n,i:/<\//,c:[{cN:"javadoc",b:"/\\*\\*",e:"\\*/",r:0,c:[{cN:"javadoctag",b:"(^|\\s)@[A-Za-z]+"}]},e.CLCM,e.CBCM,e.ASM,e.QSM,{cN:"class",bK:"class interface",e:/[{;=]/,eE:!0,k:"class interface",i:/[:"\[\]]/,c:[{bK:"extends implements"},e.UTM]},{bK:"new throw",e:/\s/,r:0},{cN:"function",b:"("+t+"\\s+)+"+e.UIR+"\\s*\\(",rB:!0,e:/[{;=]/,eE:!0,k:n,c:[{b:e.UIR+"\\s*\\(",rB:!0,c:[e.UTM]},{cN:"params",b:/\(/,e:/\)/,k:n,c:[e.ASM,e.QSM,e.CNM,e.CBCM]},e.CLCM,e.CBCM]},e.CNM,{cN:"annotation",b:"@[A-Za-z]+"}]}}),n.registerLanguage("actionscript",function(e){var t="[a-zA-Z_$][a-zA-Z0-9_$]*",n="([*]|[a-zA-Z_$][a-zA-Z0-9_$]*)",i={cN:"rest_arg",b:"[.]{3}",e:t,r:10};return{aliases:["as"],k:{keyword:"as break case catch class const continue default delete do dynamic each else extends final finally for function get if implements import in include instanceof interface internal is namespace native new override package private protected public return set static super switch this throw try typeof use var void while with",literal:"true false null undefined"},c:[e.ASM,e.QSM,e.CLCM,e.CBCM,e.CNM,{cN:"package",bK:"package",e:"{",c:[e.TM]},{cN:"class",bK:"class interface",e:"{",eE:!0,c:[{bK:"extends implements"},e.TM]},{cN:"preprocessor",bK:"import include",e:";"},{cN:"function",bK:"function",e:"[{;]",eE:!0,i:"\\S",c:[e.TM,{cN:"params",b:"\\(",e:"\\)",c:[e.ASM,e.QSM,e.CLCM,e.CBCM,i]},{cN:"type",b:":",e:n,r:10}]}]}}),e.exports=n},function(e,t,n){var i,r;(function(o){i=[n(38),n(44),n(43),n(62)],r=function(e,t,n,i){return e.directiveModule.directive("issueDetails",["$rootScope","$stateParams","$location","$http","$timeout","API","NOTIFY",function(e,t,r,a,s,l,c){return{restrict:"A",replace:!0,link:function(t,a,d){var u,p,h;return u="issue",p=null,t.notFound=!1,t.editing=!1,t.assetPreviewer={show:!1},t.showAlwaysTop=!0,h=function(e){return p.comment().create({content:e.content}).then(function(e){return c.success("评论保存成功"),t.$broadcast("comment:list:reload")})},t.onClickStatus=function(e,n){t.$emit("issue:status-dropdown:show",e,n)},t.onClickCloseAssetPreviewer=function(){return t.assetPreviewer.show=!1},t.onClickIssue=function(e){t.editing&&e.stopPropagation()},t.$watch("issue",function(){return t.issue?(p=l.project(t.issue.project_id).issue(t.issue.id),t.uploadUrl="/api/project/"+t.issue.project_id+"/attachment","true"===r.$$search.editing?t.onClickEdit():void 0):void 0}),t.$on("asset:bundle:preview",function(e,n,i){return t.assetPreviewer.show=!0,t.assetPreviewer.bundleName=i,p.assets(n).retrieve().then(function(e){return t.$broadcast("asset:bundle:load",e)})}),t.$on("dropdown:selected",function(n,i,r){var o,a;switch(a=null,i){case"issue:owner":~~r!==t.issue.owner&&(a="owner");break;case"issue:priority":~~r!==t.issue.priority&&(a="priority");break;case"issue:category":~~r!==t.issue.category_id&&(a="category_id");break;case"issue:version":~~r!==t.issue.version_id&&(a="version_id")}return a?(o={},o[a]=r,p.update(o).then(function(){return t.issue[a]=r,e.$broadcast("issue:list:reload")})):void 0}),t.$on("issue:status:change",function(n,i,r,o,a){var s;if(r!==o)return s=p,a&&(s=l.project(t.issue.project_id).issue(t.issue.id).split(i)),s.update({status:o}).then(function(){return e.$broadcast("issue:list:reload"),e.$broadcast("issue:detail:reload")})}),t.$on("datetime:change",function(e,n,i){switch(n){case"plan_finish_time":return p.update({plan_finish_time:i}).then(function(e){return e?t.issue.plan_finish_time=i:void 0})}}),t.onClickSplit=function(){return t.splitShow=!0,s(function(){return o("#split-text").focus()},100),t.issue.splited?void 0:p.update({splited:1}).then(function(n){return t.splitShow=!0,n?e.$broadcast("issue:detail:reload"):void 0})},t.onClickDelete=function(){return confirm("您确定要删除这条记录吗")?p.update({status:"trash"}).then(function(){var t;return c.success("删除成功"),t=r.$$path.replace(/(.+)\/\d+$/,"$1"),r.path(t),e.$broadcast("issue:change")}):void 0},t.onClickEdit=function(){t.splitShow=!1,"form"!==t.issue.tag?(t.editing=!0,window.setTimeout(function(){return t.$broadcast("editor:content",u,t.issue.id,t.issue.content,t.uploadUrl)},1),o("body").one("click",function(){return t.$broadcast("editor:will:cancel",u)})):e.$broadcast("issue:form:show",t.issue.id,JSON.parse(t.issue.content).uuid)},t.$on("editor:submit",function(r,o,a){var l;return"comment"===o?h(a):(t.editing=!1,t.issue.content=a.content,l=n.pick(t.issue,["content","title"]),p.update(l).then(function(t){return c.success("更新成功"),s(i.initHighlighting,100),e.$broadcast("issue:list:reload")}))}),t.$on("editor:cancel",function(e,n){return u===n?(t.editing=!1,t.$$phase?void 0:t.$apply()):void 0}),t.$on("issue:editor:show",function(){return t.onClickEdit()}),t.followIssue=function(){return p.follow().create().then(function(e){})}}}}])}.apply(t,i),!(void 0!==r&&(e.exports=r))}).call(t,n(33))},function(e,t,n){var i,r;i=[n(65)],r=function(){}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;(function(o){i=[n(38),n(44),n(66),n(62)],r=function(e,t,n,i){return e.directiveModule.directive("commentList",["$rootScope","$stateParams","API","$timeout",function(e,r,o,a){return{restrict:"E",scope:{data:"="},replace:!0,template:t.extractTemplate("#tmpl-comment-list",n),link:function(t,n,s){var l;return l=function(e,n){return o.project(r.project_id).issue(r.issue_id).comment().retrieve({pageSize:20,pageIndex:e}).then(function(e){return t.comments=e,a(i.initHighlighting,200)})},t.$on("comment:list:reload",function(){return l(1,null)}),e.$on("pagination:change",function(e,t,n,i){return"comment_list"===n?l(t):void 0}),l()}}}]).directive("commentCell",["$stateParams","API","NOTIFY",function(e,i,r){return{restrict:"E",scope:{data:"="},replace:!0,template:t.extractTemplate("#tmpl-comment-cell",n),link:function(t,n,o){return t.onClickEdit=function(e,t){},t.onClickDelete=function(t,o){confirm("您确定要删除这个评论么，删除将无法恢复")&&i.project(e.project_id).issue(e.issue_id).comment(o.id)["delete"]().then(function(){return r.success("删除评论成功"),n.fadeOut()})}}}}]).directive("commentEditor",["$stateParams","$timeout","API",function(e,i,r){return{restrict:"E",replace:!0,scope:{},template:t.extractTemplate("#tmpl-comment-editor",n),link:function(t,n,r){var a,s,l;return a="active",s="comment",l=function(){return n.parent()?n.css("width",n.parent().css("width")):void 0},t.onFocusEditor=function(){var i;return i=e.issue_id||null,n.addClass(a),t.$broadcast("editor:content",s,i,null,r.uploadUrl),o("body").one("click",function(){return t.$broadcast("editor:will:cancel",s)}),!0},t.$on("editor:cancel",function(e,t){return s===t?n.removeClass(a):void 0}),t.$on("editor:submit",function(e,t,i){return s===t?n.removeClass(a):void 0}),n.bind("click",function(e){return e.stopPropagation()}),o(window).on("onResizeEx",l),t.$on("$destroy",function(){return o(window).off("onResizeEx",l)}),i(l,1e3)}}}])}.apply(t,i),!(void 0!==r&&(e.exports=r))}).call(t,n(33))},function(e,t){var n,i=window.angular;try{n=i.module(["ng"])}catch(r){n=i.module("ng",[])}var o='<div> <textarea id="tmpl-comment-cell">\n        <div class="row">\n            <div class="information">\n                <span class="floor">{{$index + 1}}楼</span> ->\n                <span class="owner">{{data.creator_name}}在</span>&nbsp;\n                <span class="timestamp">{{data.timestamp | date: \'yyyy-MM-dd HH:mm:ss\'}}</span>\n                说：\n                <div class="toolbar">\n                    <a class="edit" href="javascript:void(0)" ng-click="onClickEdit($event, data)" ng-hide="true">编辑</a>\n                    <a class="delete" href="javascript:void(0)" ng-click="onClickDelete($event, data)">删除</a>\n                </div>\n            </div>\n\n            <div class="content editor-style" ng-bind-html="data.content | unsafe" full-size-image-previewer></div>\n        </div>\n    </textarea> <textarea id="tmpl-comment-list">\n        <div>\n            <div ng-repeat="comment in comments.items">\n                \n                <comment-cell data="comment"></comment-cell>\n            </div>\n            <pagination data-uuid="comment_list" ng-hide="comments.pagination.pageCount<2" data-paginations="{{comments.pagination}}"></pagination>\n        </div>\n    </textarea>  <textarea id="tmpl-comment-editor">\n        <div class="comment-editor">\n            <div class="full-editor">\n                <header>添加评论</header>\n                \n                <editor data-name="comment" data-show-always-top="false" data-upload-url="{{uploadUrl}}" data-member-list=""></editor>\n            </div>\n            \n            <div class="simple">\n                <input type="text" placeholder="来，说点什么？" ng-focus="onFocusEditor($event)"/>\n                \n                <div class="top"></div>\n            </div>\n        </div>\n    </textarea> </div>';n.run(["$templateCache",function(e){e.put("comment-all.html",o)}]),e.exports=o},function(e,t,n){var i,r;i=[n(68),n(73),n(74)],r=function(){}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;(function(o){i=[n(38),n(44),n(69),n(71),n(72)],r=function(e,t,n,i){return e.directiveModule.directive("memberSetting",["$rootScope","API",function(e,i){return{restrict:"E",replace:!0,scope:{},template:t.extractTemplate("#tmpl-member-setting",n),link:function(t,n,i){var r;return t.activeIndex=0,r=o(n),e.$on("member:setting:show",function(e,n){return t.activeIndex=n,r.modal({showClose:!1}),t.$broadcast("member:setting:bindAll"),t.$broadcast("member:notification:bindAll")}),e.$on("member:setting:hide",function(){return o.modal.close()})}}}]).directive("memberProfile",["$location","API","NOTIFY","$rootScope",function(e,i,r,o){return{restrict:"E",replace:!0,scope:{},template:t.extractTemplate("#tmpl-member-profile",n),link:function(e,t,n){return e.contextName="memberProfile",e.bean={setGits:function(t){return e.gits=t}},e.onClickSave=function(){return e.profile.gits=e.gits,e.profile.email?e.profile.username?("account-profile"===n.action&&i.account().profile().update(e.profile).then(function(){return r.success("保存成功！"),e.$emit("member:setting:hide")}),"create-member"===n.action?(e.profile.password="888888",i.member().create(e.profile).then(function(t){return r.success("创建成员成功！"),e.$emit("member:creator:hide"),o.$broadcast("lookup:update"),o.$broadcast("member:created:save",t.id)})):void 0):r.warn("用户名必需输入"):r.warn("请输入您的邮箱")},e.onClickCancel=function(){e.$emit("member:setting:hide")},e.$on("member:setting:bindAll",function(){return i.account().profile().retrieve().then(function(t){return e.profile=t,e.gits=_.map(t.gits,function(e){return e.git}),e.$broadcast("gitList:load",e.gits)})}),e.$on("member:creator:bindAll",function(t,n){e.profile=n,e.$apply()})}}}]).directive("memberChangePassword",["$location","API","NOTIFY",function(e,i,r){return{restrict:"E",replace:!0,scope:!0,template:t.extractTemplate("#tmpl-member-change-password",n),link:function(e,t,n){return e.profile={},e.onClickCancel=function(){e.$emit("member:setting:hide")},e.onClickSave=function(){return e.profile.new_password!==e.profile.new_password2?void r.warn("您两次输入的密码不一致"):void i.account().changePassword().update(e.profile).then(function(){return r.success("您的密码修改成功！"),e.profile={},e.onClickCancel()})}}}}]).directive("memberNotification",["$location","API","$stateParams","NOTIFY",function(e,i,r,o){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-member-notification",n),link:function(e,t,n){return e.onClickCancel=function(){return e.$emit("member:setting:hide")},e.onClickSave=function(){return e.profile.notification=JSON.stringify(e.profile.notification),i.account().profile().update(e.profile).then(function(){return o.success("保存成功！"),e.$emit("member:setting:hide")})},e.$on("member:notification:bindAll",function(){return i.account().profile().retrieve().then(function(t){return e.profile=t,t.notification&&(e.profile.notification=JSON.parse(t.notification)),e.profile.notification&&null==e.profile.notification.weixin&&(e.profile.notification.weixin=1),e.profile.notification&&null==e.profile.notification.realtime&&(e.profile.notification.realtime=1),e.profile.notification&&null==e.profile.notification.email&&(e.profile.notification.email=1),e.profile.notification&&null==e.profile.notification.client?e.profile.notification.client=1:void 0})})}}}]).directive("memberWeixin",["API","NOTIFY",function(e,i){return{scope:{},restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-member-weixin",n),link:function(t,n,r){return t.onClickCancel=function(){t.$emit("member:setting:hide")},t.onClickSaveWeixin=function(){e.account().weixin().create({weixin:t.weixin}).then(function(){return i.success("微信绑定成功！"),t.onClickCancel()})}}}}]).directive("membersLookup",["$stateParams","API","STORE",function(e,t,n){return{restrict:"AC",link:function(n,i,r){var a,s,l,c,d,u,p;return a=o(i),e.project_id&&(u=t.project(e.project_id).member()),e.team_id&&(u=t.team(e.team_id).member()),s=function(t){var i;return i={member_id:t,role:"d",status:0},u.create(i).then(function(){return a.val(""),n.selectSuggestion="",e.project_id&&n.$emit("project:member:request"),e.team_id&&n.$emit("team:member:request"),d()})},c=function(){var e;return e=a.val(),a.val(""),n.$emit("member:creator:toshow",e)},a.on("keyup",function(e){return 13===e.keyCode&&n.selectSuggestion&&s(n.selectSuggestion),13!==e.keyCode||n.selectSuggestion?void 0:c()}),p={lookup:[],showNoSuggestionNotice:!0,noSuggestionNotice:"未找到该用户，按回车键添加该用户",onSelect:function(e){return n.selectSuggestion=e.data}},l=function(e){return u.retrieve().then(function(t){return _.remove(e,function(e){var n;return n=_.findIndex(t,function(t){return e.id===t.member_id})>=0,n||(e.value=e.realname+" -> "+(e.username||"未设置")+" -> "+e.email,e.data=e.id,delete e.realname,delete e.username,delete e.id,delete e.role),n})}),e},d=function(){return t.member().retrieve({pageSize:9999}).then(function(e){return p.lookup=l(e.items),a.autocomplete(p)})},n.$on("lookup:update",function(){return d()}),n.$on("member:created:save",function(e,t){return s(t)}),d()}}}]).directive("memberCreatorModel",["$location","API",function(e,i){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-member-creator",n),link:function(e,t,n){var i;return i=o(t),e.$on("member:creator:show",function(t,n){return e.$broadcast("member:creator:bindAll",{username:n,realname:n}),i.modal({showClose:!1})}),e.$on("member:creator:hide",function(){return o.modal.close()})}}}]).directive("projectMemberItem",["$stateParams","API",function(e,i){return{restrict:"AE",replace:!0,template:t.extractTemplate("#tmpl-project-member-item",n),link:function(t,n,r){return t.removeProjectMember=function(n){return i.project(e.project_id).member(n.member_id)["delete"]().then(function(){return t.$emit("project:member:request")})}}}}]).directive("projectMemberRoleDropdown",["$stateParams","API",function(e,i){return{restrict:"AE",replace:!0,template:t.extractTemplate("#tmpl-project-member-role-dropdown",n),link:function(t,n,r){return t.$on("dropdown:selected",function(n,r,o){return"project-member-item"===r?i.project(e.project_id).member(t.member.member_id).update({role:o}).then(function(){return t.$emit("project:member:request")}):void 0})}}}]).directive("teamMemberItem",["$stateParams","API",function(e,i){return{restrict:"AE",replace:!0,template:t.extractTemplate("#tmpl-team-member-item",n),link:function(t,n,r){return t.removeTeamMember=function(n){return i.team(e.team_id).member(n.member_id)["delete"]().then(function(){return t.$emit("team:member:request")})}}}}]).directive("teamMemberRoleDropdown",["$stateParams","API",function(e,i){
return{restrict:"AE",replace:!0,template:t.extractTemplate("#tmpl-team-member-role-dropdown",n),link:function(t,n,r){return t.$on("dropdown:selected",function(n,r,o){return"team-member-item"===r?i.team(e.team_id).member(t.member.member_id).update({role:o}).then(function(){return t.$emit("team:member:request")}):void 0})}}}]).directive("memberMessageNotifier",["$stateParams","API",function(e,i){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-member-message-notifier",n),link:function(e,t,n){var r,a;return r=o(t).find("div.message-list"),r.bind("click",function(e){return e.stopPropagation()}),r.bind("mouseleave",function(){return e.onCloseNotifier()}),e.onCloseNotifier=function(){return r.fadeOut()},e.onClickNotifier=function(t){t.stopPropagation(),r.fadeIn(),o("body").one("click",function(){return e.onCloseNotifier()})},e.onClickItem=function(t,n){return n&&e.onCloseNotifier(),i.message(t.id).update().then(function(){return a()})},e.onClickReadAll=function(){return e.onCloseNotifier(),i.message().update().then(function(){return a()})},a=function(){return i.message().retrieve({pageSize:10,status:"new"}).then(function(t){return e.message=t})},e.$on("member:message:reload",function(){return a()}),a()}}}])}.apply(t,i),!(void 0!==r&&(e.exports=r))}).call(t,n(33))},function(e,t,n){var i,r=window.angular;try{i=r.module(["ng"])}catch(o){i=r.module("ng",[])}var a='<div>                              <textarea id="tmpl-project-member-list">\n        <member-creator-model></member-creator-model>\n        <div class="list project-list-panel member-list">\n            <header>\n                <h3>项目成员</h3>\n            </header>\n            <div class="create">\n                <input type="text" placeholder="请输入将要添加用户的姓名" members-lookup autofocus/>\n            </div>\n            <ul class="details">\n                <project-member-item></project-member-item>\n            </ul>\n        </div>\n    </textarea>  <textarea id="tmpl-project-member-item">\n        <li ng-repeat="member in projectMember" class="row">\n            <span class="name">{{member.realname}}</span>\n            <span class="email">{{member.email}}</span>\n\n            <div class="control">\n                <a class="remove" ng-if="member.member_id!=user.member_id" ng-click="removeProjectMember(member)">删除</a>\n                <a class="remove" ng-if="member.member_id==user.member_id" ng-click="removeProjectMember(member)">退出</a>\n                <div class="role" dropdown data-name="project-member-item">\n                    {{ member.role | projectMemberRole }}\n                    <i class="small icon cell"></i>\n                    <project-member-role-dropdown></project-member-role-dropdown>\n                </div>\n            </div>\n        </li>\n    </textarea>  <textarea id="tmpl-project-member-role-dropdown">\n        <div class="dropdown dropdown-tip">\n            <ul class="dropdown-menu">\n                <li><a data-value="d">开发</a></li>\n                <li><a data-value="l">Leader</a></li>\n                <li><a data-value="p">产品</a></li>\n                <li><a data-value="t">测试</a></li>\n                <li><a data-value="g">客人</a></li>\n            </ul>\n        </div>\n    </textarea>  <textarea id="tmpl-team-member-item">\n        <li ng-repeat="member in teamMember" class="row">\n            <span class="name">{{member.realname}}</span>\n            <span class="email">{{member.email}}</span>\n\n            <div class="control">\n                <span class="email">{{member.status | teamMemberStatus}}</span>\n                <a class="remove" ng-click="removeTeamMember(member)">删除</a>\n                <div class="role" dropdown data-name="team-member-item">\n                    {{ member.role | teamMemberRole }}\n                    <i class="small icon cell"></i>\n                    <team-member-role-dropdown></team-member-role-dropdown>\n                </div>\n            </div>\n        </li>\n    </textarea>  <textarea id="tmpl-team-member-role-dropdown">\n        <div class="dropdown dropdown-tip">\n            <ul class="dropdown-menu">\n                <li><a data-value="m">成员</a></li>\n                <li><a data-value="l">Leader</a></li>\n            </ul>\n        </div>\n    </textarea>  <textarea id="tmpl-member-change-password">\n        <div class="panel">\n            <form class="standard-form" ng-submit="onClickSave()">\n                <div class="row">\n                    <label class="caption">\n                        原密码\n                    </label>\n                    <input class="medium text" type="password" placeholder="您的旧密码" ng-model="profile.old_password" required/>\n                </div>\n\n                <div class="row">\n                    <label class="caption">\n                        新密码\n                    </label>\n                    <input class="medium text" type="password" placeholder="请输入新密码" ng-model="profile.new_password" required ng-minlength="6"/>\n                </div>\n\n                <div class="row">\n                    <label class="caption">\n                        重复密码\n                    </label>\n                    <input class="medium text" type="password" placeholder="两次输入的密码必需一致" ng-model="profile.new_password2" required ng-minlength="6"/>\n                </div>\n\n                <div class="row control">\n                    <button class="primary default">保存</button>\n                    <button class="cancel default" ng-click="onClickCancel()">取消</button>\n                </div>\n            </form>\n        </div>\n    </textarea>  <textarea id="tmpl-member-profile">\n        <div class="panel">\n            <form class="standard-form">\n                <div class="row">\n                    <label class="caption">\n                        用户名\n                    </label>\n                    <input class="medium text" type="text" placeholder="用于登录的用户名" ng-model="profile.username"/>\n                </div>\n\n                <div class="row">\n                    <label class="caption">\n                        姓名\n                    </label>\n                    <input class="medium text" type="text" placeholder="用户姓名" ng-model="profile.realname"/>\n                </div>\n\n                <div class="row">\n                    <label class="caption">\n                        <a href="http://git.hunantv.com/profile/account" target="_blank" title="gitlab的个人密钥，用于BHF创建项目时自动新建git仓库. 点击查看自己的token">Git Token</a>\n                    </label>\n                    <input class="medium text" type="text" placeholder="用于创建项目自动新建git仓库" ng-model="profile.gitlab_token"/>\n                </div>\n\n                <div class="row">\n                  <label class="caption">\n                    邮箱\n                  </label>\n                  <input class="medium text" type="text" placeholder="用于接收邮件通知" ng-model="profile.email"/>\n                </div>\n                <div class="row">\n                    <label class="caption">\n                        Git帐号\n                    </label>\n                    <div class="inline">\n                        <git-list-editor bean="bean" max-count="5">\n                        </git-list-editor>\n                    </div>\n                </div>\n\n                <div class="row control">\n                    <button class="primary default" ng-click="onClickSave()">保存</button>\n                    <button class="cancel default" ng-click="onClickCancel()">取消</button>\n                </div>\n            </form>\n        </div>\n    </textarea> <textarea id="tmpl-member-notification">\n        <div class="panel">\n            <form class="standard-form">\n                <div class="row">\n                    <label class="caption">\n                        微信通知\n                    </label>\n                        <input type="checkbox" name="weixin" ng-true-value="1" ng-false-value="0" ng-model="profile.notification.weixin"/>\n                    <label class="caption">\n                        客户端推送\n                    </label>\n                        <input type="checkbox" name="client" ng-true-value="1" ng-false-value="0" ng-model="profile.notification.client"/>\n                </div>\n                <div class="row">\n                    <label class="caption">\n                        邮件通知\n                    </label>\n                        <input type="checkbox" name="email" ng-true-value="1" ng-false-value="0" ng-model="profile.notification.email"/>\n                    <label class="caption">\n                        实时通知\n                    </label>\n                        <input type="checkbox" name="realtime" ng-true-value="1" ng-false-value="0" ng-model="profile.notification.realtime"/>\n                </div>\n                <div class="row control">\n                    <button class="primary default" ng-click="onClickSave()">保存</button>\n                    <button class="cancel default" ng-click="onClickCancel()">取消</button>\n                </div>\n            </form>\n        </div>\n    </textarea> <textarea id="tmpl-member-weixin">\n        <div class="panel">\n            <form class="standard-form">\n                <p class="title">扫一扫下面二维码，关注企业微信号，然后绑定自己的微信</p>\n\n                <div class="row">\n                    <img src="'+n(70)+'">\n                </div>\n\n                <div class="row">\n                    <label class="caption">\n                        <a href="http://bhf.hunantv.com/wiki/17/category/89/issue/7230?title=FAQs" target="_blank" title="微信号用于接收任务通知等，微信号不是昵称，点击查看如何获取自己的微信号">\n                            微信号\n                        </a>\n                    </label>\n                    <input class="medium text" type="text" placeholder="用于接收微信通知" ng-model="weixin"/>\n                </div>\n                <div class="row control">\n                    <button class="primary default" ng-click="onClickSaveWeixin()">保存</button>\n                    <button class="cancel default" ng-click="onClickCancel()">取消</button>\n                </div>\n            </form>\n        </div>\n    </textarea> <textarea id="tmpl-member-setting">\n        <div class="modal">\n            <div class="inner">\n                <a class="close-modal" rel="modal:close"><i class="icon"></i></a>\n                <div class="simple-tab" simple-tab data-active-index="{{activeIndex}}">\n                    <ul class="nav" data-field="nav">\n                        <li>个人资料</li>\n                        <li>修改密码</li>\n                        <li>微信绑定</li>\n                        <li>通知设置</li>\n                    </ul>\n                    <div class="content" data-field="content">\n                        <member-profile action="account-profile"></member-profile>\n                        <member-change-password></member-change-password>\n                        <member-weixin></member-weixin>\n                        <member-notification></member-notification>\n\n                    </div>\n                </div>\n            </div>\n        </div>\n    </textarea>  <textarea id="tmpl-member-creator">\n        <div class="modal">\n            <div class="inner">\n                <a class="close-modal" rel="modal:close"><i class="icon"></i></a>\n                <header>\n                    创建项目成员\n                </header>\n                <section>\n                    <member-profile action="create-member"></member-profile>\n                </section>\n            </div>\n        </div>\n    </textarea>  <textarea id="tmpl-member-message-notifier">\n        <div class="notify" ng-click="onClickNotifier($event)">\n            <i class="small icon">\n                <span class="badge red small" ng-show="message.pagination.recordCount > 0">{{message.pagination.recordCount}}</span>\n            </i>\n            <span>消息</span>\n            <div class="message-list">\n                <ul>\n                    <li class="title">\n                        您有{{message.pagination.recordCount}}条新消息\n                    </li>\n                    <li class="empty" ng-show="message.items.length == 0">没有任何新消息哦</li>\n                    <li ng-repeat="item in message.items">\n                        <p class="content">\n                            <a href="{{item.link}}" ng-click="onClickItem(item, true)" class="title">{{item.content | limitTo: 60}}</a>\n                            <a href="javascript:void(0)" class="readit" ng-click="onClickItem(item, false)">已读</a>\n                        </p>\n                    </li>\n                    <li class="footer" ng-show="message.items.length > 0">>\n                        <a href="javascript:void(0)" ng-click="onClickReadAll()">全部已读</a>\n                        <a href="javascript:void(0)">查看全部{{message.pagination.recordCount}}条消息</a>\n                    </li>\n                </ul>\n            </div>\n        </div>\n    </textarea> </div>';i.run(["$templateCache",function(e){e.put("member-all.html",a)}]),e.exports=a},function(e,t,n){e.exports=n.p+"../images/weixin-qy-qrcode.jpg"},function(e,t,n){var i,r,o;!function(a){"use strict";r=[n(33)],i=a,o="function"==typeof i?i.apply(t,r):i,!(void 0!==o&&(e.exports=o))}(function(e){"use strict";function t(n,i){var r=function(){},o=this,a={ajaxSettings:{},autoSelectFirst:!1,appendTo:document.body,serviceUrl:null,lookup:null,onSelect:null,width:"auto",minChars:1,maxHeight:300,deferRequestBy:0,params:{},formatResult:t.formatResult,delimiter:null,zIndex:9999,type:"GET",noCache:!1,onSearchStart:r,onSearchComplete:r,onSearchError:r,containerClass:"autocomplete-suggestions",tabDisabled:!1,dataType:"text",currentRequest:null,triggerSelectOnValidInput:!0,preventBadQueries:!0,lookupFilter:function(e,t,n){return-1!==e.value.toLowerCase().indexOf(n)},paramName:"query",transformResult:function(t){return"string"==typeof t?e.parseJSON(t):t},showNoSuggestionNotice:!1,noSuggestionNotice:"No results",orientation:"bottom",forceFixPosition:!1};o.element=n,o.el=e(n),o.suggestions=[],o.badQueries=[],o.selectedIndex=-1,o.currentValue=o.element.value,o.intervalId=0,o.cachedResponse={},o.onChangeInterval=null,o.onChange=null,o.isLocal=!1,o.suggestionsContainer=null,o.noSuggestionsContainer=null,o.options=e.extend({},a,i),o.classes={selected:"autocomplete-selected",suggestion:"autocomplete-suggestion"},o.hint=null,o.hintValue="",o.selection=null,o.initialize(),o.setOptions(i)}var n=function(){return{escapeRegExChars:function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},createNode:function(e){var t=document.createElement("div");return t.className=e,t.style.position="absolute",t.style.display="none",t}}}(),i={ESC:27,TAB:9,RETURN:13,LEFT:37,UP:38,RIGHT:39,DOWN:40};t.utils=n,e.Autocomplete=t,t.formatResult=function(e,t){var i="("+n.escapeRegExChars(t)+")";return e.value.replace(new RegExp(i,"gi"),"<strong>$1</strong>")},t.prototype={killerFn:null,initialize:function(){var n,i=this,r="."+i.classes.suggestion,o=i.classes.selected,a=i.options;i.element.setAttribute("autocomplete","off"),i.killerFn=function(t){0===e(t.target).closest("."+i.options.containerClass).length&&(i.killSuggestions(),i.disableKillerFn())},i.noSuggestionsContainer=e('<div class="autocomplete-no-suggestion"></div>').html(this.options.noSuggestionNotice).get(0),i.suggestionsContainer=t.utils.createNode(a.containerClass),n=e(i.suggestionsContainer),n.appendTo(a.appendTo),"auto"!==a.width&&n.width(a.width),n.on("mouseover.autocomplete",r,function(){i.activate(e(this).data("index"))}),n.on("mouseout.autocomplete",function(){i.selectedIndex=-1,n.children("."+o).removeClass(o)}),n.on("click.autocomplete",r,function(){i.select(e(this).data("index"))}),i.fixPositionCapture=function(){i.visible&&i.fixPosition()},e(window).on("resize.autocomplete",i.fixPositionCapture),i.el.on("keydown.autocomplete",function(e){i.onKeyPress(e)}),i.el.on("keyup.autocomplete",function(e){i.onKeyUp(e)}),i.el.on("blur.autocomplete",function(){i.onBlur()}),i.el.on("focus.autocomplete",function(){i.onFocus()}),i.el.on("change.autocomplete",function(e){i.onKeyUp(e)})},onFocus:function(){var e=this;e.fixPosition(),e.options.minChars<=e.el.val().length&&e.onValueChange()},onBlur:function(){this.enableKillerFn()},setOptions:function(t){var n=this,i=n.options;e.extend(i,t),n.isLocal=e.isArray(i.lookup),n.isLocal&&(i.lookup=n.verifySuggestionsFormat(i.lookup)),i.orientation=n.validateOrientation(i.orientation,"bottom"),e(n.suggestionsContainer).css({"max-height":i.maxHeight+"px",width:i.width+"px","z-index":i.zIndex})},clearCache:function(){this.cachedResponse={},this.badQueries=[]},clear:function(){this.clearCache(),this.currentValue="",this.suggestions=[]},disable:function(){var e=this;e.disabled=!0,clearInterval(e.onChangeInterval),e.currentRequest&&e.currentRequest.abort()},enable:function(){this.disabled=!1},fixPosition:function(){var t=this,n=e(t.suggestionsContainer),i=n.parent().get(0);if(i===document.body||t.options.forceFixPosition){var r=t.options.orientation,o=n.outerHeight(),a=t.el.outerHeight(),s=t.el.offset(),l={top:s.top,left:s.left};if("auto"==r){var c=e(window).height(),d=e(window).scrollTop(),u=-d+s.top-o,p=d+c-(s.top+a+o);r=Math.max(u,p)===u?"top":"bottom"}if("top"===r?l.top+=-o:l.top+=a,i!==document.body){var h,m=n.css("opacity");t.visible||n.css("opacity",0).show(),h=n.offsetParent().offset(),l.top-=h.top,l.left-=h.left,t.visible||n.css("opacity",m).hide()}"auto"===t.options.width&&(l.width=t.el.outerWidth()-2+"px"),n.css(l)}},enableKillerFn:function(){var t=this;e(document).on("click.autocomplete",t.killerFn)},disableKillerFn:function(){var t=this;e(document).off("click.autocomplete",t.killerFn)},killSuggestions:function(){var e=this;e.stopKillSuggestions(),e.intervalId=window.setInterval(function(){e.hide(),e.stopKillSuggestions()},50)},stopKillSuggestions:function(){window.clearInterval(this.intervalId)},isCursorAtEnd:function(){var e,t=this,n=t.el.val().length,i=t.element.selectionStart;return"number"==typeof i?i===n:document.selection?(e=document.selection.createRange(),e.moveStart("character",-n),n===e.text.length):!0},onKeyPress:function(e){var t=this;if(!t.disabled&&!t.visible&&e.which===i.DOWN&&t.currentValue)return void t.suggest();if(!t.disabled&&t.visible){switch(e.which){case i.ESC:t.el.val(t.currentValue),t.hide();break;case i.RIGHT:if(t.hint&&t.options.onHint&&t.isCursorAtEnd()){t.selectHint();break}return;case i.TAB:if(t.hint&&t.options.onHint)return void t.selectHint();case i.RETURN:if(-1===t.selectedIndex)return void t.hide();if(t.select(t.selectedIndex),e.which===i.TAB&&t.options.tabDisabled===!1)return;break;case i.UP:t.moveUp();break;case i.DOWN:t.moveDown();break;default:return}e.stopImmediatePropagation(),e.preventDefault()}},onKeyUp:function(e){var t=this;if(!t.disabled){switch(e.which){case i.UP:case i.DOWN:return}clearInterval(t.onChangeInterval),t.currentValue!==t.el.val()&&(t.findBestHint(),t.options.deferRequestBy>0?t.onChangeInterval=setInterval(function(){t.onValueChange()},t.options.deferRequestBy):t.onValueChange())}},onValueChange:function(){var t,n=this,i=n.options,r=n.el.val(),o=n.getQuery(r);return n.selection&&n.currentValue!==o&&(n.selection=null,(i.onInvalidateSelection||e.noop).call(n.element)),clearInterval(n.onChangeInterval),n.currentValue=r,n.selectedIndex=-1,i.triggerSelectOnValidInput&&(t=n.findSuggestionIndex(o),-1!==t)?void n.select(t):void(o.length<i.minChars?n.hide():n.getSuggestions(o))},findSuggestionIndex:function(t){var n=this,i=-1,r=t.toLowerCase();return e.each(n.suggestions,function(e,t){return t.value.toLowerCase()===r?(i=e,!1):void 0}),i},getQuery:function(t){var n,i=this.options.delimiter;return i?(n=t.split(i),e.trim(n[n.length-1])):t},getSuggestionsLocal:function(t){var n,i=this,r=i.options,o=t.toLowerCase(),a=r.lookupFilter,s=parseInt(r.lookupLimit,10);return n={suggestions:e.grep(r.lookup,function(e){return a(e,t,o)})},s&&n.suggestions.length>s&&(n.suggestions=n.suggestions.slice(0,s)),n},getSuggestions:function(t){var n,i,r,o,a=this,s=a.options,l=s.serviceUrl;s.params[s.paramName]=t,i=s.ignoreParams?null:s.params,s.onSearchStart.call(a.element,s.params)!==!1&&(a.isLocal?n=a.getSuggestionsLocal(t):(e.isFunction(l)&&(l=l.call(a.element,t)),r=l+"?"+e.param(i||{}),n=a.cachedResponse[r]),n&&e.isArray(n.suggestions)?(a.suggestions=n.suggestions,a.suggest(),s.onSearchComplete.call(a.element,t,n.suggestions)):a.isBadQuery(t)?s.onSearchComplete.call(a.element,t,[]):(a.currentRequest&&a.currentRequest.abort(),o={url:l,data:i,type:s.type,dataType:s.dataType},e.extend(o,s.ajaxSettings),a.currentRequest=e.ajax(o).done(function(e){var n;a.currentRequest=null,n=s.transformResult(e),a.processResponse(n,t,r),s.onSearchComplete.call(a.element,t,n.suggestions)}).fail(function(e,n,i){s.onSearchError.call(a.element,t,e,n,i)})))},isBadQuery:function(e){if(!this.options.preventBadQueries)return!1;for(var t=this.badQueries,n=t.length;n--;)if(0===e.indexOf(t[n]))return!0;return!1},hide:function(){var t=this;t.visible=!1,t.selectedIndex=-1,clearInterval(t.onChangeInterval),e(t.suggestionsContainer).hide(),t.signalHint(null)},suggest:function(){if(0===this.suggestions.length)return void(this.options.showNoSuggestionNotice?this.noSuggestions():this.hide());var t,n,i=this,r=i.options,o=r.groupBy,a=r.formatResult,s=i.getQuery(i.currentValue),l=i.classes.suggestion,c=i.classes.selected,d=e(i.suggestionsContainer),u=e(i.noSuggestionsContainer),p=r.beforeRender,h="",m=function(e,n){var i=e.data[o];return t===i?"":(t=i,'<div class="autocomplete-group"><strong>'+t+"</strong></div>")};return r.triggerSelectOnValidInput&&(n=i.findSuggestionIndex(s),-1!==n)?void i.select(n):(e.each(i.suggestions,function(e,t){o&&(h+=m(t,s,e)),h+='<div class="'+l+'" data-index="'+e+'">'+a(t,s)+"</div>"}),this.adjustContainerWidth(),u.detach(),d.html(h),r.autoSelectFirst&&(i.selectedIndex=0,d.children().first().addClass(c)),e.isFunction(p)&&p.call(i.element,d),i.fixPosition(),d.show(),i.visible=!0,void i.findBestHint())},noSuggestions:function(){var t=this,n=e(t.suggestionsContainer),i=e(t.noSuggestionsContainer);this.adjustContainerWidth(),i.detach(),n.empty(),n.append(i),t.fixPosition(),n.show(),t.visible=!0},adjustContainerWidth:function(){var t,n=this,i=n.options,r=e(n.suggestionsContainer);"auto"===i.width&&(t=n.el.outerWidth()-2,r.width(t>0?t:300))},findBestHint:function(){var t=this,n=t.el.val().toLowerCase(),i=null;n&&(e.each(t.suggestions,function(e,t){var r=0===t.value.toLowerCase().indexOf(n);return r&&(i=t),!r}),t.signalHint(i))},signalHint:function(t){var n="",i=this;t&&(n=i.currentValue+t.value.substr(i.currentValue.length)),i.hintValue!==n&&(i.hintValue=n,i.hint=t,(this.options.onHint||e.noop)(n))},verifySuggestionsFormat:function(t){return t.length&&"string"==typeof t[0]?e.map(t,function(e){return{value:e,data:null}}):t},validateOrientation:function(t,n){return t=e.trim(t||"").toLowerCase(),-1===e.inArray(t,["auto","bottom","top"])&&(t=n),t},processResponse:function(e,t,n){var i=this,r=i.options;e.suggestions=i.verifySuggestionsFormat(e.suggestions),r.noCache||(i.cachedResponse[n]=e,r.preventBadQueries&&0===e.suggestions.length&&i.badQueries.push(t)),t===i.getQuery(i.currentValue)&&(i.suggestions=e.suggestions,i.suggest())},activate:function(t){var n,i=this,r=i.classes.selected,o=e(i.suggestionsContainer),a=o.find("."+i.classes.suggestion);return o.find("."+r).removeClass(r),i.selectedIndex=t,-1!==i.selectedIndex&&a.length>i.selectedIndex?(n=a.get(i.selectedIndex),e(n).addClass(r),n):null},selectHint:function(){var t=this,n=e.inArray(t.hint,t.suggestions);t.select(n)},select:function(e){var t=this;t.hide(),t.onSelect(e)},moveUp:function(){var t=this;if(-1!==t.selectedIndex)return 0===t.selectedIndex?(e(t.suggestionsContainer).children().first().removeClass(t.classes.selected),t.selectedIndex=-1,t.el.val(t.currentValue),void t.findBestHint()):void t.adjustScroll(t.selectedIndex-1)},moveDown:function(){var e=this;e.selectedIndex!==e.suggestions.length-1&&e.adjustScroll(e.selectedIndex+1)},adjustScroll:function(t){var n,i,r,o=this,a=o.activate(t),s=25;a&&(n=a.offsetTop,i=e(o.suggestionsContainer).scrollTop(),r=i+o.options.maxHeight-s,i>n?e(o.suggestionsContainer).scrollTop(n):n>r&&e(o.suggestionsContainer).scrollTop(n-o.options.maxHeight+s),o.el.val(o.getValue(o.suggestions[t].value)),o.signalHint(null))},onSelect:function(t){var n=this,i=n.options.onSelect,r=n.suggestions[t];n.currentValue=n.getValue(r.value),n.currentValue!==n.el.val()&&n.el.val(n.currentValue),n.signalHint(null),n.suggestions=[],n.selection=r,e.isFunction(i)&&i.call(n.element,r)},getValue:function(e){var t,n,i=this,r=i.options.delimiter;return r?(t=i.currentValue,n=t.split(r),1===n.length?e:t.substr(0,t.length-n[n.length-1].length)+e):e},dispose:function(){var t=this;t.el.off(".autocomplete").removeData("autocomplete"),t.disableKillerFn(),e(window).off("resize.autocomplete",t.fixPositionCapture),e(t.suggestionsContainer).remove()}},e.fn.autocomplete=e.fn.devbridgeAutocomplete=function(n,i){var r="autocomplete";return 0===arguments.length?this.first().data(r):this.each(function(){var o=e(this),a=o.data(r);"string"==typeof n?a&&"function"==typeof a[n]&&a[n](i):(a&&a.dispose&&a.dispose(),a=new t(this,n),o.data(r,a))})}})},function(e,t,n){var i=n(33);!function(e){var t=null;e.modal=function(n,i){e.modal.close();var r,o;if(this.$body=e("body"),this.options=e.extend({},e.modal.defaults,i),this.options.doFade=!isNaN(parseInt(this.options.fadeDuration,10)),n.is("a"))if(o=n.attr("href"),/^#/.test(o)){if(this.$elm=e(o),1!==this.$elm.length)return null;this.open()}else this.$elm=e("<div>"),this.$body.append(this.$elm),r=function(e,t){t.elm.remove()},this.showSpinner(),n.trigger(e.modal.AJAX_SEND),e.get(o).done(function(i){t&&(n.trigger(e.modal.AJAX_SUCCESS),t.$elm.empty().append(i).on(e.modal.CLOSE,r),t.hideSpinner(),t.open(),n.trigger(e.modal.AJAX_COMPLETE))}).fail(function(){n.trigger(e.modal.AJAX_FAIL),t.hideSpinner(),n.trigger(e.modal.AJAX_COMPLETE)});else this.$elm=n,this.open()},e.modal.prototype={constructor:e.modal,open:function(){var t=this;this.options.doFade?(this.block(),setTimeout(function(){t.show()},this.options.fadeDuration*this.options.fadeDelay)):(this.block(),this.show()),this.options.escapeClose&&e(document).on("keydown.modal",function(t){27==t.which&&e.modal.close()}),this.options.clickClose&&this.blocker.click(e.modal.close)},close:function(){this.unblock(),this.hide(),e(document).off("keydown.modal")},block:function(){var t=this.options.doFade?0:this.options.opacity;this.$elm.trigger(e.modal.BEFORE_BLOCK,[this._ctx()]),this.blocker=e('<div class="jquery-modal blocker"></div>').css({top:0,right:0,bottom:0,left:0,width:"100%",height:"100%",position:"fixed",zIndex:this.options.zIndex,background:this.options.overlay,opacity:t}),this.$body.append(this.blocker),this.options.doFade&&this.blocker.animate({opacity:this.options.opacity},this.options.fadeDuration),this.$elm.trigger(e.modal.BLOCK,[this._ctx()])},unblock:function(){this.options.doFade?this.blocker.fadeOut(this.options.fadeDuration,function(){e(this).remove()}):this.blocker.remove()},show:function(){this.$elm.trigger(e.modal.BEFORE_OPEN,[this._ctx()]),this.options.showClose&&(this.closeButton=e('<a href="#close-modal" rel="modal:close" class="close-modal '+this.options.closeClass+'">'+this.options.closeText+"</a>"),this.$elm.append(this.closeButton)),this.$elm.addClass(this.options.modalClass+" current"),this.center(),this.options.doFade?this.$elm.fadeIn(this.options.fadeDuration):this.$elm.show(),this.$elm.trigger(e.modal.OPEN,[this._ctx()])},hide:function(){this.$elm.trigger(e.modal.BEFORE_CLOSE,[this._ctx()]),this.closeButton&&this.closeButton.remove(),this.$elm.removeClass("current"),this.options.doFade?this.$elm.fadeOut(this.options.fadeDuration):this.$elm.hide(),this.$elm.trigger(e.modal.CLOSE,[this._ctx()])},showSpinner:function(){this.options.showSpinner&&(this.spinner=this.spinner||e('<div class="'+this.options.modalClass+'-spinner"></div>').append(this.options.spinnerHtml),this.$body.append(this.spinner),this.spinner.show())},hideSpinner:function(){this.spinner&&this.spinner.remove()},center:function(){this.$elm.css({position:"fixed",top:"50%",left:"50%",marginTop:-(this.$elm.outerHeight()/2),marginLeft:-(this.$elm.outerWidth()/2),zIndex:this.options.zIndex+1})},_ctx:function(){return{elm:this.$elm,blocker:this.blocker,options:this.options}}},e.modal.prototype.resize=e.modal.prototype.center,e.modal.close=function(e){if(t){e&&e.preventDefault(),t.close();var n=t.$elm;return t=null,n}},e.modal.resize=function(){t&&t.resize()},e.modal.isActive=function(){return!!t},e.modal.defaults={overlay:"#000",opacity:.75,zIndex:1e3,escapeClose:!0,clickClose:!0,closeText:"Close",closeClass:"",modalClass:"modal",spinnerHtml:null,showSpinner:!0,showClose:!0,fadeDuration:null,fadeDelay:1},e.modal.BEFORE_BLOCK="modal:before-block",e.modal.BLOCK="modal:block",e.modal.BEFORE_OPEN="modal:before-open",e.modal.OPEN="modal:open",e.modal.BEFORE_CLOSE="modal:before-close",e.modal.CLOSE="modal:close",e.modal.AJAX_SEND="modal:ajax:send",e.modal.AJAX_SUCCESS="modal:ajax:success",e.modal.AJAX_FAIL="modal:ajax:fail",e.modal.AJAX_COMPLETE="modal:ajax:complete",e.fn.modal=function(n){return 1===this.length&&(t=new e.modal(this,n)),this},e(document).on("click.modal",'a[rel="modal:close"]',e.modal.close),e(document).on("click.modal",'a[rel="modal:open"]',function(t){t.preventDefault(),e(this).modal()})}(i)},function(e,t,n){var i,r;i=[n(38),n(44)],r=function(e,t){return e.controllerModule.controller("projectMemberListController",["$scope","$stateParams","API",function(e,t,n){}]).controller("loginController",["$scope","API",function(e,t){}])}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;(function(o){i=[n(38),n(44),n(75)],r=function(e,t,n){return e.directiveModule.directive("signIn",["$location","$state","API","NOTIFY","STORE",function(e,i,r,o,a){return{restrict:"E",replace:!0,scope:!0,template:t.extractTemplate("#tmpl-member-signin",n),link:function(t,n,s){return t.model={},e.$$search.openid_token&&(t.model.openid_token=e.$$search.openid_token),t.model.openid_token&&alert("这是您第一次使用openid登录请登录您的BHF账号来进行绑定"),t.onSubmitSignIn=function(){return t.model.account?t.model.password?r.session().create(t.model).then(function(t){return a.user.data=t,e.path(i.params.next||"/myproject/all/issue/myself")}):t.error="请输入您的密码":t.error="请输入您的E-mail或者用户名"},t.onClickResetPassword=function(){return t.model.account?r.account().resetPassword().retrieve({account:t.model.account}).then(function(e){var t;return t=e.email.replace(/(.)(.+)(@.+)/i,function(e,t,n,i){return t+_.repeat("*",n.length)+i}),o.success("您的密码已经被重置，新密码已经发送至："+t,{timeout:6e4})}):t.error="请输入您的E-mail或者用户名"},t.openidLogin=function(){return window.location="http://openids.intra.hunantv.com/oauth/login/?return_to=http://"+window.location.host+"/api/member/git-token&days=7"}}}}]).directive("signUp",["$stateParams","API","NOTIFY",function(e,i,r){return{restrict:"E",replace:!0,scope:!0,template:t.extractTemplate("#tmpl-member-signup",n),link:function(t,n,o){var a;return a=t.model={token:e.token},t.onClickSignUp=function(){return t.model.realname?t.model.password?t.model.password!==t.model.confirmPassword?t.error="您两次的密码输入不一致":i.member().create(a).then(function(){return r.success("恭喜您注册成功，请登录"),t.onClickSwitchPanel("0px")}):t.error="密码没有输入或者密码太短":t.error="请输入您的真实姓名"}}}}]).directive("authorityPanel",["$stateParams",function(e){return{restrict:"A",replace:!0,link:function(t,n,i){return t.onClickSwitchPanel=function(e){o(n).find(".sign-up").css("visibility","visible"),o(n).css("margin-left",e)},e.token?t.onClickSwitchPanel("-350px"):void 0}}}]).directive("inviteMember",["$location","$stateParams","NOTIFY","API","HOST",function(e,i,r,o,a){return{restrict:"E",replace:!0,scope:{},template:t.extractTemplate("#tmpl-member-invite",n),link:function(e,t,n){var s,l;return e.host=a,s=o.project(i.project_id).member().invite(),
l=function(t){return s.retrieve().then(function(n){return e.invitedMember=n,"function"==typeof t?t():void 0})},e.onClickInvite=function(){return s.create().then(function(){return r.success("您的邀请码已经成功创建，请将链接发给要邀请的同事"),l()})},e.$on("member:invite:show",function(){return l(function(){return t.modal({showClose:!1})})})}}}])}.apply(t,i),!(void 0!==r&&(e.exports=r))}).call(t,n(33))},function(e,t){var n,i=window.angular;try{n=i.module(["ng"])}catch(r){n=i.module("ng",[])}var o='<div>  <textarea id="tmpl-member-authority">\n        <div class="frame login-view full">\n            <div class="box">\n                <div class="welcome">\n                    <div class="logo"></div>\n                    <h3>\n                        欢迎登录Kiteam\n                    </h3>\n                    <p class="slogan">\n                        Just for fun\n                    </p>\n                </div>\n\n                <div class="body-form">\n                    <div class="inner" authority-panel>\n                        <div class="sign-in">\n                            <sign-in></sign-in>\n                        </div>\n                        <div class="sign-up">\n                            <sign-up></sign-up>\n                        </div>\n                    </div>\n                </div>\n\n            </div>\n        </div>\n    </textarea>  <textarea id="tmpl-member-signin">\n        <form>\n            <ul>\n                <li class="error">\n                    <span>{{error}}</span>\n                </li>\n                <li>\n                    <input type="text" autofocus="true" ng-model="model.account" class="text" placeholder="E-mail或者用户名">\n                </li>\n                <li>\n                    <input type="password" maxlength="16" ng-model="model.password" class="text" placeholder="密码">\n                </li>\n                <li class="additional">\n                    <label>\n                        <input type="checkbox" ng-model="model.remember"/>记住密码\n                    </label>\n                    <a href="javascript:void(0)" ng-click="onClickResetPassword()">忘记密码</a>\n                </li>\n                <li>\n                    <button ng-click="onSubmitSignIn()">登&nbsp;&nbsp;&nbsp;&nbsp;录\n                    </button>\n                </li>\n            </ul>\n        </form>\n    </textarea>  <textarea id="tmpl-member-signup">\n        <form ng-submit="onClickSignUp()">\n            <ul sign-up>\n                <li class="error">\n                    <span>{{error}}</span>\n                </li>\n                <li>\n                    <input type="text" autofocus="true" ng-model="model.realname" class="text" placeholder="您的真实姓名" required ng-minlength="2" ng-maxlength="4" name="realname">\n                </li>\n                <li>\n                    <input type="email" class="text" placeholder="请输入您的常用邮箱" ng-model="model.email" required name="email">\n                </li>\n                <li>\n                    <input type="password" ng-minlength="6" ng-maxlength="16" class="text" placeholder="设置您的密码" ng-model="model.password" required name="password">\n                </li>\n                <li>\n                    <input type="password" ng-minlength="6" ng-maxlength="16" class="text" placeholder="请重复您的密码" ng-model="model.confirmPassword" required name="confirmPassword">\n                </li>\n                <li>\n                    <button>\n                        注&nbsp;&nbsp;&nbsp;&nbsp;册\n                    </button>\n                </li>\n                <li class="right additional">\n                    <a href="javascript:void(0)" ng-click="onClickSwitchPanel(\'0px\')">已经注册？马上登录</a>\n                </li>\n            </ul>\n        </form>\n    </textarea>  <textarea id="tmpl-member-invite">\n        <div class="modal">\n            <div class="inner">\n                <a class="close-modal" rel="modal:close"><i class="icon"></i></a>\n                <header>\n                    邀请新成员\n                </header>\n                <section>\n                    <form class="standard-form">\n                        <div class="row">\n                            将邀请链接发给其它同事，他们就可以用这个邀请链接注册并加入此项目\n                        </div>\n                        <div class="row" ng-repeat="item in invitedMember">\n                            <input class="text large" value="{{host}}/invite/{{item.token}}">\n                        </div>\n                        <div class="row">\n                            <button class="primary default" ng-click="onClickInvite()">生成</button>\n                        </div>\n                    </form>\n                </section>\n            </div>\n        </div>\n    </textarea> </div>';n.run(["$templateCache",function(e){e.put("authority.html",o)}]),e.exports=o},function(e,t,n){var i,r;i=[n(77),n(79)],r=function(){}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;(function(o){i=[n(38),n(44),n(78)],r=function(e,t,n){return e.directiveModule.directive("commitIssueList",["$stateParams","API",function(e,i){return{restrict:"E",replace:!0,scope:!1,template:t.extractTemplate("#tmpl-commit-issue-list",n),link:function(t,n,r){var o;return(o=function(){return i.project(e.project_id).issue(e.issue_id).commit().retrieve({pageSize:9999}).then(function(e){return t.commits=e.items})})()}}}]).directive("commitImportModal",["$stateParams","API","NOTIFY","LOADING",function(e,i,r,a){return{restrict:"E",replace:!0,scope:!1,template:t.extractTemplate("#tmpl-commit-import",n),link:function(t,n,s){var l,c,d;return d=e.project_id,l=o(n),t.$on("commit:import:modal:show",function(){return c(function(){return l.modal({showClose:!1})})}),c=function(e){return i.project(d).ownedGits().retrieve().then(function(n){return t.git_project=n[0],t.gits=n,t.git_project_branch=n[0].branches[0],e&&e()})},t.gitChanges=function(){return t.git_project_branch=t.git_project.branches[0]},t.onClickSave=function(){var e,n;return a.loading(),e=parseInt(t.limit)||0,n={project_id:d,git_project_id:t.git_project.id,git_project_branch:t.git_project_branch,limit:e},i.commit()["import"]().retrieve(n).then(function(){return a.loaded(),r.success("导入完成，如未显示请刷新页面"),o.modal.close(),t.$emit("commit:refresh:ready")})},t.onClickCancel=function(){return o.modal.close(),!1}}}}])}.apply(t,i),!(void 0!==r&&(e.exports=r))}).call(t,n(33))},function(e,t){var n,i=window.angular;try{n=i.module(["ng"])}catch(r){n=i.module("ng",[])}var o='<div> <textarea id="tmpl-commit-list">\n        <div class="commit-list list">\n            <header>\n                <h3>Commit列表 <button class="primary default btn_import" ng-click="showImportModal()">同步</button></h3>\n            </header>\n            <ul class="details">\n                <li class="row" ng-repeat="item in commit.items">\n                    <a href="/{{item | projectLink:\'normal\'}}/commit/{{item.sha}}?url={{item.url}}">{{item.message}}</a>\n                    <div class="info">\n                        <span class="memo">\n                            {{item.sha | limitTo: 10}}\n                        </span>\n                        <span class="memo">{{item.realname}}</span>\n                        <span class="memo">{{item.timestamp | date: \'yyyy-MM-dd hh:mm\'}}</span>\n                    </div>\n                </li>\n            </ul>\n\n            <div class="empty" ng-show="commit.items.length == 0">\n                没有任何Commit，需要<a href="/wiki/17/issue/2993">了解如何同步到Commit到BHF吗？</a>\n            </div>\n            <commit-import-modal></commit-import-modal>\n\n            <pagination ng-hide="commit.pagination.pageCount<2" data-uuid="commit_pagination" data-paginations="{{commit.pagination}}"></pagination>\n        </div>\n    </textarea> <textarea id="tmpl-commit-details">\n        <iframe frameborder="0" width="100%" height="100%" ng-src="{{url}}" equal-parent-height></iframe>\n    </textarea>  <textarea id="tmpl-commit-issue-list">\n        <div>\n            <ul class="list">\n                <li ng-repeat="item in commits" class="row">\n                    <span class="timestamp gray">{{item.timestamp | date: \'medium\'}}</span>\n                    <span class="realname gray">{{item.realname}}</span>\n\n                    <a href="{{item.url}}" target="_blank">{{item.message}}</a>\n                </li>\n            </ul>\n\n            <div class="empty" ng-show="commits.length == 0">\n                哟，此任务还没有提交任何代码呢\n            </div>\n        </div>\n    </textarea>  <textarea id="tmpl-commit-import">\n      <div class="modal modal_import-commit">\n          <div class="inner">\n              <a class="close-modal" rel="modal:close"><i class="icon"></i></a>\n              <header>\n                  Commits Import\n              </header>\n              <section>\n                  <form class="standard-form">\n                      <div class="row">\n                          <label class="caption">\n                              git仓库:\n                          </label>\n                          <select class="form-select" ng-options="item as item.path_with_namespace for item in gits track by item.id" ng-model="git_project" ng-change="gitChanges()">\n                          </select>\n                      </div>\n                      <div class="row">\n                          <label class="caption">\n                              分支名:\n                          </label>\n                          <select class="form-select" ng-options="item for item in git_project.branches" ng-model="git_project_branch">\n                          </select>\n                      </div>\n                      <div class="row">\n                          <label class="caption">\n                              导入条数：\n                          </label>\n                          <input class="small text" type="text" placeholder="最多支持最近100条导入(默认50)" ng-model="limit" maxlength="40"/>\n                      </div>\n                      <div class="row control">\n                          <button class="primary default" ng-click="onClickSave()">导入</button>\n                          <button class="cancel default" ng-click="onClickCancel()">取消</button>\n                      </div>\n                  </form>\n              </section>\n          </div>\n      </div>\n    </textarea> </div>';n.run(["$templateCache",function(e){e.put("commit-all.html",o)}]),e.exports=o},function(e,t,n){var i,r;i=[n(38),n(44)],r=function(e,t){return e.controllerModule.controller("commitListController",["$rootScope","$scope","$stateParams","API",function(e,t,n,i){var r,o;return r={pageSize:20},o=function(){return i.project(n.project_id).issue(0).commit().retrieve({pageSize:20}).then(function(e){return t.commit=e})},o(),t.$on("commit:refresh:ready",function(){return o()}),t.showImportModal=function(){return t.$broadcast("commit:import:modal:show")},e.$on("pagination:change",function(e,r,o,a){return"commit_pagination"===o?i.project(n.project_id).issue(0).commit().retrieve({pageSize:20,pageIndex:r}).then(function(e){return t.commit=e}):void 0})}]).controller("commitDetailsController",["$scope","$sce","$state",function(e,t,n){return e.url=t.trustAsResourceUrl(n.params.url)}])}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(81),n(82)],r=function(){}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(38),n(44),n(43)],r=function(e,t,n){return e.controllerModule.controller("assetsListController",["$rootScope","$scope","$stateParams","API",function(e,t,i,r){var o;return t.condition={},o=function(e){return t.condition=n.extend({pageSize:20},e),r.project(i.project_id).assets().retrieve(t.condition).then(function(e){return t.assets=e})},e.$on("pagination:change",function(e,t,n,i){return"asset_pagination"===n?o({pageIndex:t}):void 0}),t.$on("instant-search:change",function(e,n){return t.condition.keyword!==n?o({keyword:n}):void 0}),o()}]).controller("assetsDetailsController",["$scope","$stateParams","$filter","API",function(e,n,i,r){return r.project(n.project_id).issue(0).assets(n.asset_id).retrieve().then(function(n){return e.asset=n,(e.assetIsBundle=i("assetIsBundle")(n.file_name))?e.$broadcast("asset:bundle:load",n):e.assetType=t.detectFileType(n.original_name)})}])}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;(function(o){i=[n(38),n(44),n(43),n(83),n(84),n(62),n(85)],r=function(e,t,i,r,a,s){return e.directiveModule.directive("uploadAssets",["$stateParams","API","NOTIFY",function(e,t,i){return{restrict:"A",replace:!0,link:function(t,r,a){var s,l,c,d,u,p;return c=o(r).find(".progress"),l=o(r).find(".percent"),s=o(r).find(".mask"),d=function(e,t){var n,i;return n=Math.pow(2,28),i=Math.pow(2,30),e.size>n?confirm("上传大文件浏览器可能会出现卡死的情况，你确定要上传么"):e.size>i?(alert("上传文件不能超过"+i/1024/1024+"M"),!1):!0},u=function(){return c.text("0%"),l.css("width","0"),s.hide()},p=function(n,r){return 0===n.length?void i.warn("无可上传的文件"):(s.show(),FileAPI.upload({url:"/api/project/"+e.project_id+"/issue/"+e.issue_id+"/assets",files:{assets:n},complete:function(e,n){return u(),t.$emit("assets:upload:finish"),e?i.error("文件上传失败"):i.success("所有文件已经上传成功啦")},progress:function(e,t,n,i){var r;return r=e.loaded/e.total*100,c.text(r.toFixed(2)+"%"),l.css("width",r+"%")}}))},n.e(2,function(e){var t=[e(59)];(function(){var e;return e=r[0],FileAPI.event.on(e,"change",function(e){var t;return t=FileAPI.getFiles(e),FileAPI.filterFiles(t,d,p)})}).apply(null,t)})}}}]).directive("assetThumbnails",["$stateParams","API",function(e,n){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-asset-thumbnails",a),link:function(t,i,r){var a,s;return a=n.project(e.project_id).issue(e.issue_id),s=function(){return a.assets().retrieve({pageSize:10}).then(function(e){return t.assets=e})},t.onClickRemove=function(e,t){return confirm("您确定要删除这个素材吗？")?a.assets(t.id)["delete"]().then(function(){return s()}):void 0},t.onClickPreviewPicture=function(e,t){return o(e.target).colorbox({maxWidth:1024,photo:!0}),e.preventDefault(),!1},t.onClickPreviewBundle=function(e,n){return t.$emit("asset:bundle:preview",n.id,n.original_name)},t.$on("assets:list:update",function(){return s()}),s()}}}]).directive("assetUnwindPreviewer",["$sce","$state",function(e,n){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-asset-unwind-previewer",a),link:function(e,t,n){}}}]).directive("assetFilePreviewer",["$stateParams","$http","API",function(e,n,i){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-asset-file-previewer",a),link:function(t,i,a){var l,c,d;return c=function(e){return t.markdownContent=r(e)},l=function(e){var t;return t=o(i).find("code"),t.text(e),s.highlightBlock(t[0])},d=function(){var i;return i="/api/project/"+e.project_id+"/asset/"+e.asset_id+"/read",t.assetUrl=i,"image"!==t.assetType?n.get(i).success(function(e){switch(t.assetType){case"markdown":return c(e);case"code":return l(e)}}):void 0},t.$watch("assetType",function(){return t.assetType?d():void 0})}}}]).directive("assetPreviewerHeader",[function(){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-asset-previewer-header",a),link:function(e,t,n){}}}]).directive("assetBundleUnwind",["$stateParams","$filter","API",function(e,n,r){return{restrict:"E",replace:!0,scope:{},template:t.extractTemplate("#tmpl-assets-unwind",a),link:function(t,o,a){var s;return t.bundleName="",t.subdir=[],t.onClickNav=function(e,n){return t.subdir=t.subdir.slice(0,n+1),s()},t.onClickAsset=function(e,n){n.is_dir&&(t.subdir.push(n.original_name),s())},t.$on("asset:bundle:load",function(e,n){return t.asset=n,t.unwind=[],s()}),s=function(){var o;return o={subdir:t.subdir.join("/")},r.project(e.project_id).assets(t.asset.id).unwind().retrieve(o).then(function(e){return i.map(e,function(e){var i;if(!e.is_dir)return i="?dig="+t.subdir.join("/")+"/"+e.original_name,e.url=n("assetLink")(t.asset,!1)+i}),t.unwind=e})}}}}])}.apply(t,i),!(void 0!==r&&(e.exports=r))}).call(t,n(33))},function(e,t,n){(function(t){(function(){function t(e){this.tokens=[],this.tokens.links={},this.options=e||d.defaults,this.rules=u.normal,this.options.gfm&&(this.options.tables?this.rules=u.tables:this.rules=u.gfm)}function n(e,t){if(this.options=t||d.defaults,this.links=e,this.rules=p.normal,this.renderer=this.options.renderer||new i,this.renderer.options=this.options,!this.links)throw new Error("Tokens array requires a `links` property.");this.options.gfm?this.options.breaks?this.rules=p.breaks:this.rules=p.gfm:this.options.pedantic&&(this.rules=p.pedantic)}function i(e){this.options=e||{}}function r(e){this.tokens=[],this.token=null,this.options=e||d.defaults,this.options.renderer=this.options.renderer||new i,this.renderer=this.options.renderer,this.renderer.options=this.options}function o(e,t){return e.replace(t?/&/g:/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function a(e){return e.replace(/&([#\w]+);/g,function(e,t){return t=t.toLowerCase(),"colon"===t?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""})}function s(e,t){return e=e.source,t=t||"",function n(i,r){return i?(r=r.source||r,r=r.replace(/(^|[^\[])\^/g,"$1"),e=e.replace(i,r),n):new RegExp(e,t)}}function l(){}function c(e){for(var t,n,i=1;i<arguments.length;i++){t=arguments[i];for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}function d(e,n,i){if(i||"function"==typeof n){i||(i=n,n=null),n=c({},d.defaults,n||{});var a,s,l=n.highlight,u=0;try{a=t.lex(e,n)}catch(p){return i(p)}s=a.length;var h=function(e){if(e)return n.highlight=l,i(e);var t;try{t=r.parse(a,n)}catch(o){e=o}return n.highlight=l,e?i(e):i(null,t)};if(!l||l.length<3)return h();if(delete n.highlight,!s)return h();for(;u<a.length;u++)!function(e){return"code"!==e.type?--s||h():l(e.text,e.lang,function(t,n){return t?h(t):null==n||n===e.text?--s||h():(e.text=n,e.escaped=!0,void(--s||h()))})}(a[u])}else try{return n&&(n=c({},d.defaults,n)),r.parse(t.lex(e,n),n)}catch(p){if(p.message+="\nPlease report this to https://github.com/chjj/marked.",(n||d.defaults).silent)return"<p>An error occured:</p><pre>"+o(p.message+"",!0)+"</pre>";throw p}}var u={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:l,hr:/^( *[-*_]){3,} *(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *#* *(?:\n+|$)/,nptable:l,lheading:/^([^\n]+)\n *(=|-){2,} *(?:\n+|$)/,blockquote:/^( *>[^\n]+(\n(?!def)[^\n]+)*\n*)+/,list:/^( *)(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:/^ *(?:comment *(?:\n|\s*$)|closed *(?:\n{2,}|\s*$)|closing *(?:\n{2,}|\s*$))/,def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +["(]([^\n]+)[")])? *(?:\n+|$)/,table:l,paragraph:/^((?:[^\n]+\n?(?!hr|heading|lheading|blockquote|tag|def))+)\n*/,text:/^[^\n]+/};u.bullet=/(?:[*+-]|\d+\.)/,u.item=/^( *)(bull) [^\n]*(?:\n(?!\1bull )[^\n]*)*/,u.item=s(u.item,"gm")(/bull/g,u.bullet)(),u.list=s(u.list)(/bull/g,u.bullet)("hr","\\n+(?=\\1?(?:[-*_] *){3,}(?:\\n+|$))")("def","\\n+(?="+u.def.source+")")(),u.blockquote=s(u.blockquote)("def",u.def)(),u._tag="(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:/|[^\\w\\s@]*@)\\b",u.html=s(u.html)("comment",/<!--[\s\S]*?-->/)("closed",/<(tag)[\s\S]+?<\/\1>/)("closing",/<tag(?:"[^"]*"|'[^']*'|[^'">])*?>/)(/tag/g,u._tag)(),u.paragraph=s(u.paragraph)("hr",u.hr)("heading",u.heading)("lheading",u.lheading)("blockquote",u.blockquote)("tag","<"+u._tag)("def",u.def)(),u.normal=c({},u),u.gfm=c({},u.normal,{fences:/^ *(`{3,}|~{3,}) *(\S+)? *\n([\s\S]+?)\s*\1 *(?:\n+|$)/,paragraph:/^/}),u.gfm.paragraph=s(u.paragraph)("(?!","(?!"+u.gfm.fences.source.replace("\\1","\\2")+"|"+u.list.source.replace("\\1","\\3")+"|")(),u.tables=c({},u.gfm,{nptable:/^ *(\S.*\|.*)\n *([-:]+ *\|[-| :]*)\n((?:.*\|.*(?:\n|$))*)\n*/,table:/^ *\|(.+)\n *\|( *[-:]+[-| :]*)\n((?: *\|.*(?:\n|$))*)\n*/}),t.rules=u,t.lex=function(e,n){var i=new t(n);return i.lex(e)},t.prototype.lex=function(e){return e=e.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,"\n"),this.token(e,!0)},t.prototype.token=function(e,t,n){for(var i,r,o,a,s,l,c,d,p,e=e.replace(/^ +$/gm,"");e;)if((o=this.rules.newline.exec(e))&&(e=e.substring(o[0].length),o[0].length>1&&this.tokens.push({type:"space"})),o=this.rules.code.exec(e))e=e.substring(o[0].length),o=o[0].replace(/^ {4}/gm,""),this.tokens.push({type:"code",text:this.options.pedantic?o:o.replace(/\n+$/,"")});else if(o=this.rules.fences.exec(e))e=e.substring(o[0].length),this.tokens.push({type:"code",lang:o[2],text:o[3]});else if(o=this.rules.heading.exec(e))e=e.substring(o[0].length),this.tokens.push({type:"heading",depth:o[1].length,text:o[2]});else if(t&&(o=this.rules.nptable.exec(e))){for(e=e.substring(o[0].length),l={type:"table",header:o[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:o[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:o[3].replace(/\n$/,"").split("\n")},d=0;d<l.align.length;d++)/^ *-+: *$/.test(l.align[d])?l.align[d]="right":/^ *:-+: *$/.test(l.align[d])?l.align[d]="center":/^ *:-+ *$/.test(l.align[d])?l.align[d]="left":l.align[d]=null;for(d=0;d<l.cells.length;d++)l.cells[d]=l.cells[d].split(/ *\| */);this.tokens.push(l)}else if(o=this.rules.lheading.exec(e))e=e.substring(o[0].length),this.tokens.push({type:"heading",depth:"="===o[2]?1:2,text:o[1]});else if(o=this.rules.hr.exec(e))e=e.substring(o[0].length),this.tokens.push({type:"hr"});else if(o=this.rules.blockquote.exec(e))e=e.substring(o[0].length),this.tokens.push({type:"blockquote_start"}),o=o[0].replace(/^ *> ?/gm,""),this.token(o,t,!0),this.tokens.push({type:"blockquote_end"});else if(o=this.rules.list.exec(e)){for(e=e.substring(o[0].length),a=o[2],this.tokens.push({type:"list_start",ordered:a.length>1}),o=o[0].match(this.rules.item),i=!1,p=o.length,d=0;p>d;d++)l=o[d],c=l.length,l=l.replace(/^ *([*+-]|\d+\.) +/,""),~l.indexOf("\n ")&&(c-=l.length,l=this.options.pedantic?l.replace(/^ {1,4}/gm,""):l.replace(new RegExp("^ {1,"+c+"}","gm"),"")),this.options.smartLists&&d!==p-1&&(s=u.bullet.exec(o[d+1])[0],a===s||a.length>1&&s.length>1||(e=o.slice(d+1).join("\n")+e,d=p-1)),r=i||/\n\n(?!\s*$)/.test(l),d!==p-1&&(i="\n"===l.charAt(l.length-1),r||(r=i)),this.tokens.push({type:r?"loose_item_start":"list_item_start"}),this.token(l,!1,n),this.tokens.push({type:"list_item_end"});this.tokens.push({type:"list_end"})}else if(o=this.rules.html.exec(e))e=e.substring(o[0].length),this.tokens.push({type:this.options.sanitize?"paragraph":"html",pre:"pre"===o[1]||"script"===o[1]||"style"===o[1],text:o[0]});else if(!n&&t&&(o=this.rules.def.exec(e)))e=e.substring(o[0].length),this.tokens.links[o[1].toLowerCase()]={href:o[2],title:o[3]};else if(t&&(o=this.rules.table.exec(e))){for(e=e.substring(o[0].length),l={type:"table",header:o[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:o[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:o[3].replace(/(?: *\| *)?\n$/,"").split("\n")},d=0;d<l.align.length;d++)/^ *-+: *$/.test(l.align[d])?l.align[d]="right":/^ *:-+: *$/.test(l.align[d])?l.align[d]="center":/^ *:-+ *$/.test(l.align[d])?l.align[d]="left":l.align[d]=null;for(d=0;d<l.cells.length;d++)l.cells[d]=l.cells[d].replace(/^ *\| *| *\| *$/g,"").split(/ *\| */);this.tokens.push(l)}else if(t&&(o=this.rules.paragraph.exec(e)))e=e.substring(o[0].length),this.tokens.push({type:"paragraph",text:"\n"===o[1].charAt(o[1].length-1)?o[1].slice(0,-1):o[1]});else if(o=this.rules.text.exec(e))e=e.substring(o[0].length),this.tokens.push({type:"text",text:o[0]});else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0));return this.tokens};var p={escape:/^\\([\\`*{}\[\]()#+\-.!_>])/,autolink:/^<([^ >]+(@|:\/)[^ >]+)>/,url:l,tag:/^<!--[\s\S]*?-->|^<\/?\w+(?:"[^"]*"|'[^']*'|[^'">])*?>/,link:/^!?\[(inside)\]\(href\)/,reflink:/^!?\[(inside)\]\s*\[([^\]]*)\]/,nolink:/^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]/,strong:/^__([\s\S]+?)__(?!_)|^\*\*([\s\S]+?)\*\*(?!\*)/,em:/^\b_((?:__|[\s\S])+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/,code:/^(`+)\s*([\s\S]*?[^`])\s*\1(?!`)/,br:/^ {2,}\n(?!\s*$)/,del:l,text:/^[\s\S]+?(?=[\\<!\[_*`]| {2,}\n|$)/};p._inside=/(?:\[[^\]]*\]|[^\[\]]|\](?=[^\[]*\]))*/,p._href=/\s*<?([\s\S]*?)>?(?:\s+['"]([\s\S]*?)['"])?\s*/,p.link=s(p.link)("inside",p._inside)("href",p._href)(),p.reflink=s(p.reflink)("inside",p._inside)(),p.normal=c({},p),p.pedantic=c({},p.normal,{strong:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/}),p.gfm=c({},p.normal,{escape:s(p.escape)("])","~|])")(),url:/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/,del:/^~~(?=\S)([\s\S]*?\S)~~/,text:s(p.text)("]|","~]|")("|","|https?://|")()}),p.breaks=c({},p.gfm,{br:s(p.br)("{2,}","*")(),text:s(p.gfm.text)("{2,}","*")()}),n.rules=p,n.output=function(e,t,i){var r=new n(t,i);return r.output(e)},n.prototype.output=function(e){for(var t,n,i,r,a="";e;)if(r=this.rules.escape.exec(e))e=e.substring(r[0].length),a+=r[1];else if(r=this.rules.autolink.exec(e))e=e.substring(r[0].length),"@"===r[2]?(n=":"===r[1].charAt(6)?this.mangle(r[1].substring(7)):this.mangle(r[1]),i=this.mangle("mailto:")+n):(n=o(r[1]),i=n),a+=this.renderer.link(i,null,n);else if(this.inLink||!(r=this.rules.url.exec(e))){if(r=this.rules.tag.exec(e))!this.inLink&&/^<a /i.test(r[0])?this.inLink=!0:this.inLink&&/^<\/a>/i.test(r[0])&&(this.inLink=!1),e=e.substring(r[0].length),a+=this.options.sanitize?o(r[0]):r[0];else if(r=this.rules.link.exec(e))e=e.substring(r[0].length),this.inLink=!0,a+=this.outputLink(r,{href:r[2],title:r[3]}),this.inLink=!1;else if((r=this.rules.reflink.exec(e))||(r=this.rules.nolink.exec(e))){if(e=e.substring(r[0].length),t=(r[2]||r[1]).replace(/\s+/g," "),t=this.links[t.toLowerCase()],!t||!t.href){a+=r[0].charAt(0),e=r[0].substring(1)+e;continue}this.inLink=!0,a+=this.outputLink(r,t),this.inLink=!1}else if(r=this.rules.strong.exec(e))e=e.substring(r[0].length),a+=this.renderer.strong(this.output(r[2]||r[1]));else if(r=this.rules.em.exec(e))e=e.substring(r[0].length),a+=this.renderer.em(this.output(r[2]||r[1]));else if(r=this.rules.code.exec(e))e=e.substring(r[0].length),a+=this.renderer.codespan(o(r[2],!0));else if(r=this.rules.br.exec(e))e=e.substring(r[0].length),a+=this.renderer.br();else if(r=this.rules.del.exec(e))e=e.substring(r[0].length),a+=this.renderer.del(this.output(r[1]));else if(r=this.rules.text.exec(e))e=e.substring(r[0].length),a+=o(this.smartypants(r[0]));else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0))}else e=e.substring(r[0].length),n=o(r[1]),i=n,a+=this.renderer.link(i,null,n);return a},n.prototype.outputLink=function(e,t){var n=o(t.href),i=t.title?o(t.title):null;return"!"!==e[0].charAt(0)?this.renderer.link(n,i,this.output(e[1])):this.renderer.image(n,i,o(e[1]))},n.prototype.smartypants=function(e){return this.options.smartypants?e.replace(/--/g,"—").replace(/(^|[-\u2014\/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014\/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…"):e},n.prototype.mangle=function(e){for(var t,n="",i=e.length,r=0;i>r;r++)t=e.charCodeAt(r),Math.random()>.5&&(t="x"+t.toString(16)),n+="&#"+t+";";return n},i.prototype.code=function(e,t,n){if(this.options.highlight){var i=this.options.highlight(e,t);null!=i&&i!==e&&(n=!0,e=i)}return t?'<pre><code class="'+this.options.langPrefix+o(t,!0)+'">'+(n?e:o(e,!0))+"\n</code></pre>\n":"<pre><code>"+(n?e:o(e,!0))+"\n</code></pre>"},i.prototype.blockquote=function(e){return"<blockquote>\n"+e+"</blockquote>\n"},i.prototype.html=function(e){return e},i.prototype.heading=function(e,t,n){return"<h"+t+' id="'+this.options.headerPrefix+n.toLowerCase().replace(/[^\w]+/g,"-")+'">'+e+"</h"+t+">\n"},i.prototype.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},i.prototype.list=function(e,t){var n=t?"ol":"ul";return"<"+n+">\n"+e+"</"+n+">\n"},i.prototype.listitem=function(e){return"<li>"+e+"</li>\n"},i.prototype.paragraph=function(e){return"<p>"+e+"</p>\n"},i.prototype.table=function(e,t){return"<table>\n<thead>\n"+e+"</thead>\n<tbody>\n"+t+"</tbody>\n</table>\n"},i.prototype.tablerow=function(e){return"<tr>\n"+e+"</tr>\n"},i.prototype.tablecell=function(e,t){var n=t.header?"th":"td",i=t.align?"<"+n+' style="text-align:'+t.align+'">':"<"+n+">";return i+e+"</"+n+">\n"},i.prototype.strong=function(e){return"<strong>"+e+"</strong>"},i.prototype.em=function(e){return"<em>"+e+"</em>"},i.prototype.codespan=function(e){return"<code>"+e+"</code>"},i.prototype.br=function(){return this.options.xhtml?"<br/>":"<br>"},i.prototype.del=function(e){return"<del>"+e+"</del>"},i.prototype.link=function(e,t,n){if(this.options.sanitize){try{var i=decodeURIComponent(a(e)).replace(/[^\w:]/g,"").toLowerCase()}catch(r){return""}if(0===i.indexOf("javascript:"))return""}var o='<a href="'+e+'"';return t&&(o+=' title="'+t+'"'),o+=">"+n+"</a>"},i.prototype.image=function(e,t,n){var i='<img src="'+e+'" alt="'+n+'"';return t&&(i+=' title="'+t+'"'),i+=this.options.xhtml?"/>":">"},r.parse=function(e,t,n){var i=new r(t,n);return i.parse(e)},r.prototype.parse=function(e){this.inline=new n(e.links,this.options,this.renderer),this.tokens=e.reverse();for(var t="";this.next();)t+=this.tok();return t},r.prototype.next=function(){return this.token=this.tokens.pop()},r.prototype.peek=function(){return this.tokens[this.tokens.length-1]||0},r.prototype.parseText=function(){for(var e=this.token.text;"text"===this.peek().type;)e+="\n"+this.next().text;return this.inline.output(e)},r.prototype.tok=function(){switch(this.token.type){case"space":return"";case"hr":return this.renderer.hr();case"heading":return this.renderer.heading(this.inline.output(this.token.text),this.token.depth,this.token.text);case"code":return this.renderer.code(this.token.text,this.token.lang,this.token.escaped);case"table":var e,t,n,i,r,o="",a="";for(n="",e=0;e<this.token.header.length;e++)i={header:!0,align:this.token.align[e]},n+=this.renderer.tablecell(this.inline.output(this.token.header[e]),{header:!0,align:this.token.align[e]});for(o+=this.renderer.tablerow(n),e=0;e<this.token.cells.length;e++){for(t=this.token.cells[e],n="",r=0;r<t.length;r++)n+=this.renderer.tablecell(this.inline.output(t[r]),{header:!1,align:this.token.align[r]});a+=this.renderer.tablerow(n)}return this.renderer.table(o,a);case"blockquote_start":for(var a="";"blockquote_end"!==this.next().type;)a+=this.tok();return this.renderer.blockquote(a);case"list_start":for(var a="",s=this.token.ordered;"list_end"!==this.next().type;)a+=this.tok();return this.renderer.list(a,s);case"list_item_start":for(var a="";"list_item_end"!==this.next().type;)a+="text"===this.token.type?this.parseText():this.tok();return this.renderer.listitem(a);case"loose_item_start":for(var a="";"list_item_end"!==this.next().type;)a+=this.tok();return this.renderer.listitem(a);case"html":var l=this.token.pre||this.options.pedantic?this.token.text:this.inline.output(this.token.text);return this.renderer.html(l);case"paragraph":return this.renderer.paragraph(this.inline.output(this.token.text));case"text":return this.renderer.paragraph(this.parseText())}},l.exec=l,d.options=d.setOptions=function(e){return c(d.defaults,e),d},d.defaults={gfm:!0,tables:!0,breaks:!1,pedantic:!1,sanitize:!1,smartLists:!1,silent:!1,highlight:null,langPrefix:"lang-",smartypants:!1,headerPrefix:"",renderer:new i,xhtml:!1},d.Parser=r,d.parser=r.parse,d.Renderer=i,d.Lexer=t,d.lexer=t.lex,d.InlineLexer=n,d.inlineLexer=n.output,d.parse=d,e.exports=d}).call(function(){return this||("undefined"!=typeof window?window:t)}())}).call(t,function(){return this}())},function(e,t){var n,i=window.angular;try{n=i.module(["ng"])}catch(r){n=i.module("ng",[])}var o='<div>  <textarea id="tmpl-asset-thumbnails">\n        <ul class="asset-thumbnails">\n            <li ng-repeat="asset in assets.items" title="{{asset.original_name}}">\n                <div ng-class="asset.url | getAssetThumbnailClass" style="background-image: url({{asset | assetThumbnail}})">\n                </div>\n                <div class="description">\n                    <p class="filename">\n                        {{asset.original_name}}\n                    </p>\n                    <p class="secondary">\n                        {{asset.timestamp | date: \'MM月dd日 hh:mm\'}}\n                    </p>\n                    <p class="secondary">\n                        {{asset.realname}}/{{asset.file_size | friendlyFileSize}}\n                    </p>\n                </div>\n                <div class="overlay">\n                    <ul>\n                        <li ng-show="asset.url | assetIsPicture">\n                            <a href="{{asset | assetLink}}" ng-click="onClickPreviewPicture($event, asset)">预览</a>\n                        </li>\n\n                        <li ng-show="asset.url | assetIsBundle">\n                            <a href="javascript:void(0)" ng-click="onClickPreviewBundle($event, asset)">预览</a>\n                        </li>\n\n                  \n\n                        <li><a href="{{asset | assetLink:true}}" target="_blank">下载</a></li>\n                        <li><a href="javascript:void(0)" ng-click="onClickRemove($event, asset)">删除</a></li>\n                    </ul>\n                </div>\n            </li>\n            <li>\n                <div class="create asset-uploader" upload-assets>\n                    <input type="file" multiple="multiple"/>\n                    <div class="mask">\n                        <div class="progress">0%</div>\n                        <div class="percent-bar">\n                            <div class="percent"></div>\n                        </div>\n                        <div>上传中</div>\n                    </div>\n                </div>\n            </li>\n        </ul>\n    </textarea>  <textarea id="tmpl-assets-list">\n        <div class="list">\n            <header>\n                <h3>素材库({{assets.pagination.recordCount}})</h3>\n            </header>\n            <ul class="details">\n                <li ng-repeat="item in assets.items" class="row">\n                    <a href="/{{item | projectLink: \'normal\'}}/assets/previewer/{{item.id}}" class="title" ng-bind-html="item.original_name | highlightKeyword: condition.keyword | unsafe">\n                    </a>\n\n                    <div class="info">\n                        <span class="memo">{{item.file_size | friendlyFileSize}}</span>\n                        <span class="memo">{{item.creator_name}}</span>\n                        <span class="memo">{{item.timestamp | date}}</span>\n                    </div>\n                </li>\n            </ul>\n\n            <div ng-show="assets.pagination.recordCount == 0" class="empty">\n                没有任何素材哦\n            </div>\n\n            <pagination ng-hide="assets.pagination.pageCount<2" data-uuid="asset_pagination" data-paginations="{{assets.pagination}}"></pagination>\n        </div>\n    </textarea>  <textarea id="tmpl-assets-details">\n        <div class="inner-view">\n            <asset-unwind-previewer ng-show="assetIsBundle"></asset-unwind-previewer>\n            <asset-file-previewer ng-show="!assetIsBundle" data-type="{{assetType}}" data-asset-id="{{asset.id}}" data-project-id="{{asset.project_id}}"></asset-file-previewer>\n        </div>\n    </textarea>  <textarea id="tmpl-asset-file-previewer">\n        <div class="asset-previewer">\n            <div class="previewer">\n                <asset-previewer-header></asset-previewer-header>\n\n                \n                <div class="download" ng-show="assetType == \'other\'">\n                    很抱歉，此文件无法预览\n                </div>\n\n                \n                <pre ng-show="assetType == \'code\'">\n                    <code ng-bind="contentHTML"></code>\n                </pre>\n\n                <div class="image" ng-show="assetType == \'image\'">\n                    <a ng-href="{{assetUrl}}" target="-_blank"><img ng-src="{{assetUrl}}"/></a>\n                </div>\n\n                \n                <div class="markdown markdown-body" ng-bind-html="markdownContent | unsafe" ng-show="assetType == \'markdown\'"></div>\n            </div>\n        </div>\n    </textarea>  <textarea id="tmpl-asset-unwind-previewer">\n        <div class="asset-unwind-container">\n            <asset-previewer-header></asset-previewer-header>\n            <asset-bundle-unwind></asset-bundle-unwind>\n        </div>\n    </textarea>  <textarea id="tmpl-assets-unwind">\n       <div class="full asset-unwind">\n           <nav>\n               <a href="javascript:void(0)" ng-click="onClickNav($event, -1)">根目录</a>\n               <span ng-repeat="item in subdir">->\n                   <a href="javascript:void(0)" ng-click="onClickNav($event, $index)">{{item}}</a>\n               </span>\n           </nav>\n\n           <ul class="list">\n               <li class="title">\n                   <span class="filename">文件名</span>\n                   <span class="size">文件大小</span>\n                   <span class="size">修改日期</span>\n               </li>\n               <li ng-repeat="asset in unwind">\n                   <span class="filename">\n                       <img ng-src="/images/file-extension-small/{{asset.original_name | extensionImage: asset.is_dir}}.png"/>\n\n                       <a href="javascript:void(0)" ng-click="onClickAsset($event, asset)" ng-show="asset.is_dir">{{asset.original_name}}</a>\n                       <a href="{{asset.url}}" ng-show="!asset.is_dir" target="_blank">{{asset.original_name}}</a>\n                       <a href="{{asset.url}}&download=true" target="_blank" ng-show="!asset.is_dir" class="download">下载</a>\n                   </span>\n                   <span class="size">{{asset.file_size | friendlyFileSize}}</span>\n                   <span class="mtime">{{asset.timestamp | date: \'medium\'}}</span>\n               </li>\n           </ul>\n       </div>\n   </textarea>  <textarea id="tmpl-asset-previewer-header">\n       <header class="asset-previewer-header">\n           <h3>{{asset.original_name}}</h3>\n           <p>\n               <span>文件大小：{{asset.file_size | friendlyFileSize}}</span>\n               |\n               <span>上传日期：{{asset.timestamp | date:\'medium\'}}</span>\n               |\n               <a ng-href="{{asset | assetLink:true}}" target="_blank">下载</a>\n           </p>\n       </header>\n   </textarea> </div>';
n.run(["$templateCache",function(e){e.put("assets-all.html",o)}]),e.exports=o},function(e,t,n){(function(e){/*!
		Colorbox 1.5.14
		license: MIT
		http://www.jacklmoore.com/colorbox
	*/
!function(e,t,n){function i(n,i,r){var o=t.createElement(n);return i&&(o.id=X+i),r&&(o.style.cssText=r),e(o)}function r(){return n.innerHeight?n.innerHeight:e(n).height()}function o(t,n){n!==Object(n)&&(n={}),this.cache={},this.el=t,this.value=function(t){var i;return void 0===this.cache[t]&&(i=e(this.el).attr("data-cbox-"+t),void 0!==i?this.cache[t]=i:void 0!==n[t]?this.cache[t]=n[t]:void 0!==J[t]&&(this.cache[t]=J[t])),this.cache[t]},this.get=function(t){var n=this.value(t);return e.isFunction(n)?n.call(this.el,this):n}}function a(e){var t=j.length,n=(q+e)%t;return 0>n?t+n:n}function s(e,t){return Math.round((/%/.test(e)?("x"===t?A.width():r())/100:1)*parseInt(e,10))}function l(e,t){return e.get("photo")||e.get("photoRegex").test(t)}function c(e,t){return e.get("retinaUrl")&&n.devicePixelRatio>1?t.replace(e.get("photoRegex"),e.get("retinaSuffix")):t}function d(e){"contains"in y[0]&&!y[0].contains(e.target)&&e.target!==b[0]&&(e.stopPropagation(),y.focus())}function u(e){u.str!==e&&(y.add(b).removeClass(u.str).addClass(e),u.str=e)}function p(t){q=0,t&&t!==!1&&"nofollow"!==t?(j=e("."+ee).filter(function(){var n=e.data(this,G),i=new o(this,n);return i.get("rel")===t}),q=j.index(L.el),-1===q&&(j=j.add(L.el),q=j.length-1)):j=e(L.el)}function h(n){e(t).trigger(n),se.triggerHandler(n)}function m(n){var r;if(!K){if(r=e(n).data(G),L=new o(n,r),p(L.get("rel")),!H){H=W=!0,u(L.get("className")),y.css({visibility:"hidden",display:"block",opacity:""}),$=i(le,"LoadedContent","width:0; height:0; overflow:hidden; visibility:hidden"),x.css({width:"",height:""}).append($),O=k.height()+T.height()+x.outerHeight(!0)-x.height(),U=_.width()+C.width()+x.outerWidth(!0)-x.width(),F=$.outerHeight(!0),z=$.outerWidth(!0);var a=s(L.get("initialWidth"),"x"),l=s(L.get("initialHeight"),"y"),c=L.get("maxWidth"),m=L.get("maxHeight");L.w=(c!==!1?Math.min(a,s(c,"x")):a)-z-U,L.h=(m!==!1?Math.min(l,s(m,"y")):l)-F-O,$.css({width:"",height:L.h}),Q.position(),h(te),L.get("onOpen"),B.add(N).hide(),y.focus(),L.get("trapFocus")&&t.addEventListener&&(t.addEventListener("focus",d,!0),se.one(oe,function(){t.removeEventListener("focus",d,!0)})),L.get("returnFocus")&&se.one(oe,function(){e(L.el).focus()})}var f=parseFloat(L.get("opacity"));b.css({opacity:f===f?f:"",cursor:L.get("overlayClose")?"pointer":"",visibility:"visible"}).show(),L.get("closeButton")?R.html(L.get("close")).appendTo(x):R.appendTo("<div/>"),v()}}function f(){y||(Z=!1,A=e(n),y=i(le).attr({id:G,"class":e.support.opacity===!1?X+"IE":"",role:"dialog",tabindex:"-1"}).hide(),b=i(le,"Overlay").hide(),M=e([i(le,"LoadingOverlay")[0],i(le,"LoadingGraphic")[0]]),w=i(le,"Wrapper"),x=i(le,"Content").append(N=i(le,"Title"),E=i(le,"Current"),P=e('<button type="button"/>').attr({id:X+"Previous"}),I=e('<button type="button"/>').attr({id:X+"Next"}),D=i("button","Slideshow"),M),R=e('<button type="button"/>').attr({id:X+"Close"}),w.append(i(le).append(i(le,"TopLeft"),k=i(le,"TopCenter"),i(le,"TopRight")),i(le,!1,"clear:left").append(_=i(le,"MiddleLeft"),x,C=i(le,"MiddleRight")),i(le,!1,"clear:left").append(i(le,"BottomLeft"),T=i(le,"BottomCenter"),i(le,"BottomRight"))).find("div div").css({"float":"left"}),S=i(le,!1,"position:absolute; width:9999px; visibility:hidden; display:none; max-width:none;"),B=I.add(P).add(E).add(D)),t.body&&!y.parent().length&&e(t.body).append(b,y.append(w,S))}function g(){function n(e){e.which>1||e.shiftKey||e.altKey||e.metaKey||e.ctrlKey||(e.preventDefault(),m(this))}return y?(Z||(Z=!0,I.click(function(){Q.next()}),P.click(function(){Q.prev()}),R.click(function(){Q.close()}),b.click(function(){L.get("overlayClose")&&Q.close()}),e(t).bind("keydown."+X,function(e){var t=e.keyCode;H&&L.get("escKey")&&27===t&&(e.preventDefault(),Q.close()),H&&L.get("arrowKey")&&j[1]&&!e.altKey&&(37===t?(e.preventDefault(),P.click()):39===t&&(e.preventDefault(),I.click()))}),e.isFunction(e.fn.on)?e(t).on("click."+X,"."+ee,n):e("."+ee).live("click."+X,n)),!0):!1}function v(){var t,r,o,a=Q.prep,d=++ce;if(W=!0,V=!1,h(ae),h(ne),L.get("onLoad"),L.h=L.get("height")?s(L.get("height"),"y")-F-O:L.get("innerHeight")&&s(L.get("innerHeight"),"y"),L.w=L.get("width")?s(L.get("width"),"x")-z-U:L.get("innerWidth")&&s(L.get("innerWidth"),"x"),L.mw=L.w,L.mh=L.h,L.get("maxWidth")&&(L.mw=s(L.get("maxWidth"),"x")-z-U,L.mw=L.w&&L.w<L.mw?L.w:L.mw),L.get("maxHeight")&&(L.mh=s(L.get("maxHeight"),"y")-F-O,L.mh=L.h&&L.h<L.mh?L.h:L.mh),t=L.get("href"),Y=setTimeout(function(){M.show()},100),L.get("inline")){var u=e(t);o=e("<div>").hide().insertBefore(u),se.one(ae,function(){o.replaceWith(u)}),a(u)}else L.get("iframe")?a(" "):L.get("html")?a(L.get("html")):l(L,t)?(t=c(L,t),V=new Image,e(V).addClass(X+"Photo").bind("error",function(){a(i(le,"Error").html(L.get("imgError")))}).one("load",function(){d===ce&&setTimeout(function(){var t;e.each(["alt","longdesc","aria-describedby"],function(t,n){var i=e(L.el).attr(n)||e(L.el).attr("data-"+n);i&&V.setAttribute(n,i)}),L.get("retinaImage")&&n.devicePixelRatio>1&&(V.height=V.height/n.devicePixelRatio,V.width=V.width/n.devicePixelRatio),L.get("scalePhotos")&&(r=function(){V.height-=V.height*t,V.width-=V.width*t},L.mw&&V.width>L.mw&&(t=(V.width-L.mw)/V.width,r()),L.mh&&V.height>L.mh&&(t=(V.height-L.mh)/V.height,r())),L.h&&(V.style.marginTop=Math.max(L.mh-V.height,0)/2+"px"),j[1]&&(L.get("loop")||j[q+1])&&(V.style.cursor="pointer",V.onclick=function(){Q.next()}),V.style.width=V.width+"px",V.style.height=V.height+"px",a(V)},1)}),V.src=t):t&&S.load(t,L.get("data"),function(t,n){d===ce&&a("error"===n?i(le,"Error").html(L.get("xhrError")):e(this).contents())})}var b,y,w,x,k,_,C,T,j,A,$,S,M,N,E,D,I,P,R,B,L,O,U,F,z,q,V,H,W,K,Y,Q,Z,J={html:!1,photo:!1,iframe:!1,inline:!1,transition:"elastic",speed:300,fadeOut:300,width:!1,initialWidth:"600",innerWidth:!1,maxWidth:!1,height:!1,initialHeight:"450",innerHeight:!1,maxHeight:!1,scalePhotos:!0,scrolling:!0,opacity:.9,preloading:!0,className:!1,overlayClose:!0,escKey:!0,arrowKey:!0,top:!1,bottom:!1,left:!1,right:!1,fixed:!1,data:void 0,closeButton:!0,fastIframe:!0,open:!1,reposition:!0,loop:!0,slideshow:!1,slideshowAuto:!0,slideshowSpeed:2500,slideshowStart:"start slideshow",slideshowStop:"stop slideshow",photoRegex:/\.(gif|png|jp(e|g|eg)|bmp|ico|webp|jxr|svg)((#|\?).*)?$/i,retinaImage:!1,retinaUrl:!1,retinaSuffix:"@2x.$1",current:"image {current} of {total}",previous:"previous",next:"next",close:"close",xhrError:"This content failed to load.",imgError:"This image failed to load.",returnFocus:!0,trapFocus:!0,onOpen:!1,onLoad:!1,onComplete:!1,onCleanup:!1,onClosed:!1,rel:function(){return this.rel},href:function(){return e(this).attr("href")},title:function(){return this.title}},G="colorbox",X="cbox",ee=X+"Element",te=X+"_open",ne=X+"_load",ie=X+"_complete",re=X+"_cleanup",oe=X+"_closed",ae=X+"_purge",se=e("<a/>"),le="div",ce=0,de={},ue=function(){function e(){clearTimeout(a)}function t(){(L.get("loop")||j[q+1])&&(e(),a=setTimeout(Q.next,L.get("slideshowSpeed")))}function n(){D.html(L.get("slideshowStop")).unbind(l).one(l,i),se.bind(ie,t).bind(ne,e),y.removeClass(s+"off").addClass(s+"on")}function i(){e(),se.unbind(ie,t).unbind(ne,e),D.html(L.get("slideshowStart")).unbind(l).one(l,function(){Q.next(),n()}),y.removeClass(s+"on").addClass(s+"off")}function r(){o=!1,D.hide(),e(),se.unbind(ie,t).unbind(ne,e),y.removeClass(s+"off "+s+"on")}var o,a,s=X+"Slideshow_",l="click."+X;return function(){o?L.get("slideshow")||(se.unbind(re,r),r()):L.get("slideshow")&&j[1]&&(o=!0,se.one(re,r),L.get("slideshowAuto")?n():i(),D.show())}}();e[G]||(e(f),Q=e.fn[G]=e[G]=function(t,n){var i,r=this;if(t=t||{},e.isFunction(r))r=e("<a/>"),t.open=!0;else if(!r[0])return r;return r[0]?(f(),g()&&(n&&(t.onComplete=n),r.each(function(){var n=e.data(this,G)||{};e.data(this,G,e.extend(n,t))}).addClass(ee),i=new o(r[0],t),i.get("open")&&m(r[0])),r):r},Q.position=function(t,n){function i(){k[0].style.width=T[0].style.width=x[0].style.width=parseInt(y[0].style.width,10)-U+"px",x[0].style.height=_[0].style.height=C[0].style.height=parseInt(y[0].style.height,10)-O+"px"}var o,a,l,c=0,d=0,u=y.offset();if(A.unbind("resize."+X),y.css({top:-9e4,left:-9e4}),a=A.scrollTop(),l=A.scrollLeft(),L.get("fixed")?(u.top-=a,u.left-=l,y.css({position:"fixed"})):(c=a,d=l,y.css({position:"absolute"})),d+=L.get("right")!==!1?Math.max(A.width()-L.w-z-U-s(L.get("right"),"x"),0):L.get("left")!==!1?s(L.get("left"),"x"):Math.round(Math.max(A.width()-L.w-z-U,0)/2),c+=L.get("bottom")!==!1?Math.max(r()-L.h-F-O-s(L.get("bottom"),"y"),0):L.get("top")!==!1?s(L.get("top"),"y"):Math.round(Math.max(r()-L.h-F-O,0)/2),y.css({top:u.top,left:u.left,visibility:"visible"}),w[0].style.width=w[0].style.height="9999px",o={width:L.w+z+U,height:L.h+F+O,top:c,left:d},t){var p=0;e.each(o,function(e){return o[e]!==de[e]?void(p=t):void 0}),t=p}de=o,t||y.css(o),y.dequeue().animate(o,{duration:t||0,complete:function(){i(),W=!1,w[0].style.width=L.w+z+U+"px",w[0].style.height=L.h+F+O+"px",L.get("reposition")&&setTimeout(function(){A.bind("resize."+X,Q.position)},1),e.isFunction(n)&&n()},step:i})},Q.resize=function(e){var t;H&&(e=e||{},e.width&&(L.w=s(e.width,"x")-z-U),e.innerWidth&&(L.w=s(e.innerWidth,"x")),$.css({width:L.w}),e.height&&(L.h=s(e.height,"y")-F-O),e.innerHeight&&(L.h=s(e.innerHeight,"y")),e.innerHeight||e.height||(t=$.scrollTop(),$.css({height:"auto"}),L.h=$.height()),$.css({height:L.h}),t&&$.scrollTop(t),Q.position("none"===L.get("transition")?0:L.get("speed")))},Q.prep=function(n){function r(){return L.w=L.w||$.width(),L.w=L.mw&&L.mw<L.w?L.mw:L.w,L.w}function s(){return L.h=L.h||$.height(),L.h=L.mh&&L.mh<L.h?L.mh:L.h,L.h}if(H){var d,p="none"===L.get("transition")?0:L.get("speed");$.remove(),$=i(le,"LoadedContent").append(n),$.hide().appendTo(S.show()).css({width:r(),overflow:L.get("scrolling")?"auto":"hidden"}).css({height:s()}).prependTo(x),S.hide(),e(V).css({"float":"none"}),u(L.get("className")),d=function(){function n(){e.support.opacity===!1&&y[0].style.removeAttribute("filter")}var i,r,s=j.length;H&&(r=function(){clearTimeout(Y),M.hide(),h(ie),L.get("onComplete")},N.html(L.get("title")).show(),$.show(),s>1?("string"==typeof L.get("current")&&E.html(L.get("current").replace("{current}",q+1).replace("{total}",s)).show(),I[L.get("loop")||s-1>q?"show":"hide"]().html(L.get("next")),P[L.get("loop")||q?"show":"hide"]().html(L.get("previous")),ue(),L.get("preloading")&&e.each([a(-1),a(1)],function(){var n,i=j[this],r=new o(i,e.data(i,G)),a=r.get("href");a&&l(r,a)&&(a=c(r,a),n=t.createElement("img"),n.src=a)})):B.hide(),L.get("iframe")?(i=t.createElement("iframe"),"frameBorder"in i&&(i.frameBorder=0),"allowTransparency"in i&&(i.allowTransparency="true"),L.get("scrolling")||(i.scrolling="no"),e(i).attr({src:L.get("href"),name:(new Date).getTime(),"class":X+"Iframe",allowFullScreen:!0}).one("load",r).appendTo($),se.one(ae,function(){i.src="//about:blank"}),L.get("fastIframe")&&e(i).trigger("load")):r(),"fade"===L.get("transition")?y.fadeTo(p,1,n):n())},"fade"===L.get("transition")?y.fadeTo(p,0,function(){Q.position(0,d)}):Q.position(p,d)}},Q.next=function(){!W&&j[1]&&(L.get("loop")||j[q+1])&&(q=a(1),m(j[q]))},Q.prev=function(){!W&&j[1]&&(L.get("loop")||q)&&(q=a(-1),m(j[q]))},Q.close=function(){H&&!K&&(K=!0,H=!1,h(re),L.get("onCleanup"),A.unbind("."+X),b.fadeTo(L.get("fadeOut")||0,0),y.stop().fadeTo(L.get("fadeOut")||0,0,function(){y.hide(),b.hide(),h(ae),$.remove(),setTimeout(function(){K=!1,h(oe),L.get("onClosed")},1)}))},Q.remove=function(){y&&(y.stop(),e[G].close(),y.stop(!1,!0).remove(),b.remove(),K=!1,y=null,e("."+ee).removeData(G).removeClass(ee),e(t).unbind("click."+X).unbind("keydown."+X))},Q.element=function(){return e(L.el)},Q.settings=J)}(e,document,window)}).call(t,n(33))},function(e,t,n){var i,r;i=[n(87),n(90),n(94),n(95),n(96)],r=function(){}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(34),n(38),n(88),n(44),n(89)],r=function(e,t,n,i,r){var o;return o="/api/",t.serviceModule.factory("API",["$http","$location","$q","NOTIFY","$sce","$rootScope","LOADING",function(e,t,i,o,a,s,l){var c,d;return c={prefix:"/api",promise:i,ajax:function(t,n,i,r){var a,s;return a={url:t,method:n},"post"===(s=n.toLowerCase())||"put"===s||"patch"===s?a.data=i:a.params=i,e(a).success(r).error(function(e,t){var n;switch(l.loaded(),t){case 404:return o.error("404 Not Found");case 500:return o.error("抱歉，服务器发生错误，请稍候再试");case 406:return n=e.message||e,o.error("提示："+n);case 403:return n=e.message||e,o.error("你没有权限操作此项功能");case 401:return o.error("您需要登录才能使用此功能");case 413:return o.error("文件好象太大，上传失败！");default:return console.error("未知错误")}})}},d=n(c),d.parse(r),d}])}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;(function(n){var o=[].slice;!function(){var a,s,l,c;return a=function(){function e(e,t){this.parent=e,this.segmentModel=t,this.params=[],this._updateProperties(),this._addMethods()}return e.prototype._addMethod=function(e,t){var n;return n=this,this[t]=function(t,i){return"function"==typeof t&&(i=t,t={}),n._doAction(e,t,i)}},e.prototype._addMethods=function(){var e,t,n,i,r;t={post:"create",put:"update",patch:"patch","delete":"delete",get:"retrieve",jsonp:"jsonp"},i=this.segmentModel.options.methods||t,r=[];for(e in i)n=i[e],r.push(this._addMethod(e,n));return r},e.prototype._addPlainParam=function(e,t){var n;return(n=this.segmentModel.placeholders[t])?this.params[t]={key:n.key,value:String(e)}:void 0},e.prototype._addObjectParam=function(e){var t,n,i,r,o,a,s,l,c;l=[];for(o in e){for(c=e[o],t=-1,s=this.segmentModel.placeholders,i=n=0,a=s.length;a>n;i=++n)if(r=s[i],r.key===o){t=i;break}l.push(this._addPlainParam(c,t))}return l},e.prototype._addParams=function(e){var t,n,i,r,o,a;for(a=[],n=t=0,i=e.length;i>t;n=++t)r=e[n],"string"==(o=typeof r)||"number"===o?a.push(this._addPlainParam(r,n)):a.push(this._addObjectParam(r));return a},e.prototype._currentToString=function(){var e,t,n,i,r;for(r=this.segmentModel.name,i=this.params,e=0,t=i.length;t>e;e++)n=i[e],n.value&&(r+="/"+n.value);return r},e.prototype._extractMethodName=function(e){return this.segmentModel.options.rawMethodName?e:e=e.replace(/[\-](\w)/,function(e,t){return t.toUpperCase()})},e.prototype._updateProperties=function(){var t,n,i,r,o,a;for(o=this.segmentModel.children,a=[],n=0,i=o.length;i>n;n++)t=o[n],r=this._extractMethodName(t.name),this[r]||a.push(this[r]=e.create(this,t));return a},e.prototype._doAction=function(e,t,n){var i,r,o,a;return o=this.segmentModel.options.promise,i=this.segmentModel.options.ajax,a=this.toString(),o?(r=o.defer(),i(a,e,t,function(e){return r.resolve(e)},function(e){return r.reject(e)}),r.promise):i(a,e,t,n)},e.prototype.parse=function(e){return this.segmentModel.parse(e),this._updateProperties()},e.prototype.toString=function(e){var t,n,i;return this.parent?(t=this.segmentModel.options,i=(null!=(n=this.parent)?n.toString(!0):void 0)||t.prefix||"",i+="/"+this._currentToString(),!e&&t.suffix&&(i+=t.suffix),i):""},e}(),a.create=function(e,t){return function(){var n,i;return n=1<=arguments.length?o.call(arguments,0):[],i=new a(e,t),i._addParams(n),i}},s=function(){function e(e,t,n){this.parent=e,this.name=t,this.options=n,this.children=[],this.placeholders=[]}return e.prototype.parseUrl=function(e){var t,n,i,r,o,a,s;for(i=this,s=e.url||e,o=s.split("/"),a=[],t=0,n=o.length;n>t;t++)r=o[t],a.push(i=i.addChild(r));return a},e.prototype.parse=function(e){var t,n,i,r;for(e instanceof Array||(e=[e]),r=[],n=0,i=e.length;i>n;n++)t=e[n],r.push(this.parseUrl(t));return r},e.prototype.setPlaceholders=function(e,t){return"object"==typeof e?this.addPlaceholders(e):void 0},e.prototype.addPlaceholder=function(e){return this.placeholders.push({key:e})},e.prototype.addChild=function(e){var t,n,i,r;if(/^:.+/.test(e))return this.addPlaceholder(e.substr(1)),this;for(r=this.children,n=0,i=r.length;i>n;n++)if(t=r[n],t.name===e)return t;return this.createSegmentModel(e)},e.prototype.createSegmentModel=function(t){var n;return n=new e(this,t),n.options=this.options,this.children.push(n),n},e}(),c=function(e,t,i,r){var o;return("undefined"!=typeof n&&null!==n?n.ajax:void 0)?(o="jsonp"===t?"JSONP":"JSON","jsonp"===t&&(t="GET"),n.ajax(e,{type:t,data:i,dataType:o,success:function(e){return"function"==typeof r?r(e):void 0}})):console.error("请设置options.ajax参数或引用jQuery")},l=function(e){var t,n;return e=e||{},e.ajax=e.ajax||c,n=new s(null,null,e),t=new a(null,n)},i=[],r=function(){return l}.apply(t,i),!(void 0!==r&&(e.exports=r))}()}).call(t,n(33))},function(e,t,n){var i,r;i=[],r=function(){return[{url:"mine",methods:{patch:!1}},{url:"session",methods:{put:!1,patch:!1}},{url:"project/:project_id/attachment/:filename",methods:{}},{url:"project",methods:{}},{url:"project/:project_id/category/:category_id",methods:{}},{url:"project/:project_id/version/:version_id",methods:{}},{url:"project/:project_id/webhook/:webhook_id",methods:{}},{url:"project/:project_id/deploy",methods:{get:!1,"delete":!1,patch:!1,put:!1}},{url:"project/git",methods:{"delete":!1,patch:!1,put:!1}},{url:"git/commit",methods:{get:!1,"delete":!1,patch:!1,put:!1}},{url:"project/:project_id/owned-gits",methods:{get:!0,"delete":!1,patch:!1,put:!1}},{url:"project/:project_id/gitlab/:id/fork",methods:{get:!0,"delete":!1,patch:!1,put:!1}},{url:"commit/import",methods:{get:!0,post:!1,"delete":!0,patch:!1,put:!1}},{url:"project/:project_id/git/tags",methods:{post:!1,"delete":!1,patch:!1,put:!1}},{url:"project/:project_id/member/:member_id",methods:{}},{url:"project/:project_id/git/commit",methods:{get:!1,"delete":!1,patch:!1,put:!1}},{url:"project/:project_id/issue/:issue_id/commit",methods:{post:!1,"delete":!1,patch:!1,put:!1}},{url:"project/:project_id/issue/:issue_id/split/:id",methods:{patch:!1}},{url:"project/:project_id/issue/:issue_id/follow/:id",methods:{patch:!1,put:!1}},{url:"project/:project_id/follow",methods:{post:!1,"delete":!1,patch:!1,put:!1}},{url:"project/:project_id/assets",methods:{patch:!1,put:!1}},{url:"project/:project_id/issue/:issue_id/assets/:id",methods:{patch:!1,put:!1}},{url:"project/:project_id/issue/:issue_id/commit",methods:{post:!1,"delete":!1,patch:!1,put:!1}},{url:"project/:project_id/commit",methods:{post:!1,"delete":!1,patch:!1,put:!1}},{url:"assets/:project_id/:zipfile/unwind",methods:{post:!1,"delete":!1,patch:!1,put:!1}},{url:"project/:project_id/issue",methods:{"delete":!1,patch:!1}},{url:"project/:project_id/report",methods:{post:!1,"delete":!1,patch:!1,put:!1}},{url:"report/issue",methods:{post:!1,"delete":!1,patch:!1,put:!1}},{url:"report",methods:{"delete":!1,patch:!1}},{url:"project/:project_id/stat",methods:{post:!1,"delete":!1,patch:!1,put:!1}},{url:"project/:project_id/report/weekly",methods:{post:!1,"delete":!1,patch:!1,put:!1}},{url:"project/:project_id/issue/:issue_id/comment/:comment_id",methods:{}},{url:"project/:project_id/discussion",methods:{put:!1,post:!1,"delete":!1,patch:!1}},{url:"project/:project_id/issue/:issue_id/status",methods:{get:!1,"delete":!1,post:!1,patch:!1}},{url:"project/:project_id/issue/:issue_id/tag",methods:{get:!1,"delete":!1,post:!1,patch:!1}},{url:"project/:project_id/issue/:issue_id/priority",methods:{get:!1,"delete":!1,post:!1}},{url:"project/:project_id/favorite",methods:{get:!1,put:!1}},{url:"account/change-password",methods:{post:!1,"delete":!1,get:!1,patch:!1}},{url:"account/reset-password",methods:{post:!1,"delete":!1,put:!1,patch:!1}},{url:"account/weixin",methods:{"delete":!1,get:!1,patch:!1}},{url:"member/role",methods:{post:!1,"delete":!1,get:!1,patch:!1}},{url:"account/token",methods:{put:!1,"delete":!1,get:!1,patch:!1}},{url:"member",methods:{put:!1,"delete":!1,patch:!1}},{url:"member/mail",methods:{get:!1,put:!1,"delete":!1,patch:!1}},{url:"account/profile",methods:{"delete":!1,post:!1,patch:!1}},{url:"account/avatar/:member_id",methods:{put:!1,"delete":!1,post:!1,patch:!1}},{url:"apis",methods:{}},{url:"project/:project_id/issue/:issue_id/log",methods:{post:!1,"delete":!1,patch:!1,put:!1}},{url:"report/project/issue-finish",methods:{put:!1,post:!1,path:!1,"delete":!1,patch:!1}},{url:"report/member/issue-finish",methods:{put:!1,post:!1,path:!1,"delete":!1,patch:!1}},{url:"report/team/:team_id/issue-finish",methods:{put:!1,post:!1,path:!1,"delete":!1,patch:!1}},{url:"report/weekly",methods:{put:!1,post:!1,path:!1,"delete":!1,patch:!1}},{url:"report/:team_id/weekly",methods:{put:!1,post:!1,path:!1,"delete":!1,patch:!1}},{url:"project/:project_id/member/invite",methods:{}},{url:"project/:project_id/assets/:asset_id/unwind",methods:{post:!1,"delete":!1,patch:!1,put:!1}},{url:"message/:message_id",methods:{post:!1,"delete":!1,patch:!1}},{url:"project/:project_id/issue/stat/test",method:{post:!1,"delete":!1,patch:!1}},{url:"team/:team_id/member/:member_id",method:{patch:!1}},{url:"stream",method:{post:!1,"delete":!1,put:!1,patch:!1}}]}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(34),n(38),n(91),n(39)],r=function(e,t,n,i){return t.serviceModule.factory("NOTIFY",function(){return n}).factory("WEEKLIST",function(){return function(e){var t,n,r,o,a,s,l;for(o=[],a=i().startOf("week"),r=n=0,s=e;s>=0?s>=n:n>=s;r=s>=0?++n:--n)l=a.clone().subtract(r,"weeks"),t=l.clone().add(6,"days"),o.push({text:l.clone().subtract(1,"days").format("YYYY年第W周"),start:l.startOf("days").valueOf(),end:t.endOf("days").valueOf()});return o}}).factory("ENUM",function(){return{projectFlag:{normal:0,wiki:1}}}).factory("HOST",["$location",function(e){var t;return t=[e.$$protocol,"://",e.$$host],80!==e.$$port&&(t.push(":"),t.push(e.$$port)),t.join("")}])}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(92),n(93)],r=function(e,t){var n=function(){},i=function(e,t){t=t||{};for(var n in t)e[n]=t[n];return e},r={success:{type:"success",force:!0},error:{type:"error"},warn:{type:"warning"},info:{type:"information",layout:"topRight",force:!0,timeout:!1}},o=function(e){var t={layout:"top",theme:"defaultTheme",type:"alert",dismissQueue:!0,timeout:4e3,force:!1,modal:!1,maxVisible:3,killer:!1,closeWith:["click"],buttons:!1};return i(t,r[e])},a=function(e,n){var r=i(n,{text:e});t(r)},s=function(e){return function(t,n){var r=o(e);i(r,n);a(t,r)}};n.success=s("success"),n.error=s("error"),n.warn=s("warn"),n.info=s("info"),n.desktop={};var l=e.connect("ws://"+window.location.hostname+":8001"),c=function(e){var t=e.sender.realname;return"\n\n             send by "+t},d=function(e){e.data.link&&(window.location.href=e.data.link)},u=function(e){var t=e.data.title||"",n=e.data.content||"";b(t,n,e)},p=function(e){var t;t="done"!==e.data.issue.status?"将状态改为->"+e.data.issue.status:"完成了任务",t=e.sender.realname+t;var n=e.data.issue.title;b(t,n,e)},h=function(e){var t,n="您有新任务";(t=e.data.issue.plan_finish_time)&&(n+="，于"+moment(t).format("MM月DD日")+"到期");var i=e.data.issue.title;b(n,i,e)},m=function(e){var t=e.data.issue.title;b("有人在提到你了",t,e)},f=function(e){var t=e.sender.realname+"邀请你加入团队【"+e.data.teamName+"】";b(e.sender.realname+"邀请你加入团队",t,e)},g={"talk:project":u,"talk:all":u,"issue:status:change":p,"issue:assigned":h,mention:m,"team:invitation":f};l.on("message",function(e){var t=g[e.event]||function(){console.log("unknown event",e)};t(e)}),l.on("connect",function(){l.emit("ready")});var v=function(){if(!("Notification"in window))return n.warn("您的浏览器不支持桌面通知，建议使用Chrome,Firefox 或者 Safari",{timeout:5e3}),!1;if("default"===Notification.permission&&Notification.requestPermission(function(e){"permission"in Notification||(Notification.permission=e)}),"denied"===Notification.permission){var e="该浏览器桌面通知已被禁用,推荐开启! 点击查看开启方式 ";n.warn(e,{timeout:!1,callback:{onClose:function(){window.open("http://bhf.hunantv.com/project/17/issue/1506","_blank")}}})}return!0}(),b=function(e,t,i){if(e=e?e:"BHF友好提醒: ",t=t?t:"",t+=c(i),!v)return void n.info(e+t);var r={lang:"UTF-8",icon:"/images/desktop.png",body:t},o=function(){var t=new Notification(e,r);t.onclick=function(){d(i)}};return"granted"===Notification.permission?void o():("default"===Notification.permission&&Notification.requestPermission(function(e){"permission"in Notification||(Notification.permission=e),"granted"===e&&o()}),void("denied"===Notification.permission&&n.info(e+t)))},y=function(e,t){var n={event:e,data:t};l.emit("message",n)};return n.desktop.online=function(){l.emit("ready")},n.desktop.offline=function(){l.disconnect()},n.desktop.busy=function(){},n.desktop.toAll=function(e){y("talk:all",e)},n.desktop.toProject=function(e,t){t.project_id=e,y("talk:project",t)},n.desktop.toMember=function(e){broadcast.project_id=project_id,y("talk:member",broadcast)},n}.apply(t,i),!(void 0!==r&&(e.exports=r))},,function(e,t,n){var i,r;(function(o){i=[n(33)],r=function(){"function"!=typeof Object.create&&(Object.create=function(e){function t(){}return t.prototype=e,new t}),function(e){var t={init:function(t){return this.options=e.extend({},e.noty.defaults,t),this.options.layout=this.options.custom?e.noty.layouts.inline:e.noty.layouts[this.options.layout],e.noty.themes[this.options.theme]?this.options.theme=e.noty.themes[this.options.theme]:t.themeClassName=this.options.theme,delete t.layout,delete t.theme,this.options=e.extend({},this.options,this.options.layout.options),this.options.id="noty_"+(new Date).getTime()*Math.floor(1e6*Math.random()),this.options=e.extend({},this.options,t),this._build(),this},_build:function(){var t=e('<div class="noty_bar noty_type_'+this.options.type+'"></div>').attr("id",this.options.id);if(t.append(this.options.template).find(".noty_text").html(this.options.text),this.$bar=null!==this.options.layout.parent.object?e(this.options.layout.parent.object).css(this.options.layout.parent.css).append(t):t,this.options.themeClassName&&this.$bar.addClass(this.options.themeClassName).addClass("noty_container_type_"+this.options.type),this.options.buttons){this.options.closeWith=[],this.options.timeout=!1;var n=e("<div/>").addClass("noty_buttons");null!==this.options.layout.parent.object?this.$bar.find(".noty_bar").append(n):this.$bar.append(n);var i=this;e.each(this.options.buttons,function(t,n){var r=e("<button/>").addClass(n.addClass?n.addClass:"gray").html(n.text).attr("id",n.id?n.id:"button-"+t).appendTo(i.$bar.find(".noty_buttons")).on("click",function(){e.isFunction(n.onClick)&&n.onClick.call(r,i)})})}this.$message=this.$bar.find(".noty_message"),this.$closeButton=this.$bar.find(".noty_close"),this.$buttons=this.$bar.find(".noty_buttons"),e.noty.store[this.options.id]=this},show:function(){var t=this;return t.options.custom?t.options.custom.find(t.options.layout.container.selector).append(t.$bar):e(t.options.layout.container.selector).append(t.$bar),t.options.theme&&t.options.theme.style&&t.options.theme.style.apply(t),"function"===e.type(t.options.layout.css)?this.options.layout.css.apply(t.$bar):t.$bar.css(this.options.layout.css||{}),t.$bar.addClass(t.options.layout.addClass),t.options.layout.container.style.apply(e(t.options.layout.container.selector)),t.showing=!0,t.options.theme&&t.options.theme.style&&t.options.theme.callback.onShow.apply(this),e.inArray("click",t.options.closeWith)>-1&&t.$bar.css("cursor","pointer").one("click",function(e){t.stopPropagation(e),t.options.callback.onCloseClick&&t.options.callback.onCloseClick.apply(t),t.close()}),e.inArray("hover",t.options.closeWith)>-1&&t.$bar.one("mouseenter",function(){t.close()}),e.inArray("button",t.options.closeWith)>-1&&t.$closeButton.one("click",function(e){t.stopPropagation(e),t.close()}),-1==e.inArray("button",t.options.closeWith)&&t.$closeButton.remove(),t.options.callback.onShow&&t.options.callback.onShow.apply(t),t.$bar.animate(t.options.animation.open,t.options.animation.speed,t.options.animation.easing,function(){t.options.callback.afterShow&&t.options.callback.afterShow.apply(t),t.showing=!1,t.shown=!0}),t.options.timeout&&t.$bar.delay(t.options.timeout).promise().done(function(){t.close()}),this},close:function(){if(!(this.closed||this.$bar&&this.$bar.hasClass("i-am-closing-now"))){var t=this;if(this.showing)return void t.$bar.queue(function(){t.close.apply(t)});if(!this.shown&&!this.showing){var n=[];return e.each(e.noty.queue,function(e,i){i.options.id!=t.options.id&&n.push(i)}),void(e.noty.queue=n)}t.$bar.addClass("i-am-closing-now"),t.options.callback.onClose&&t.options.callback.onClose.apply(t),t.$bar.clearQueue().stop().animate(t.options.animation.close,t.options.animation.speed,t.options.animation.easing,function(){t.options.callback.afterClose&&t.options.callback.afterClose.apply(t)}).promise().done(function(){t.options.modal&&(e.notyRenderer.setModalCount(-1),0==e.notyRenderer.getModalCount()&&e(".noty_modal").fadeOut("fast",function(){e(this).remove()})),e.notyRenderer.setLayoutCountFor(t,-1),0==e.notyRenderer.getLayoutCountFor(t)&&e(t.options.layout.container.selector).remove(),"undefined"!=typeof t.$bar&&null!==t.$bar&&(t.$bar.remove(),t.$bar=null,t.closed=!0),delete e.noty.store[t.options.id],t.options.theme.callback&&t.options.theme.callback.onClose&&t.options.theme.callback.onClose.apply(t),t.options.dismissQueue||(e.noty.ontap=!0,e.notyRenderer.render()),t.options.maxVisible>0&&t.options.dismissQueue&&e.notyRenderer.render()})}},setText:function(e){return this.closed||(this.options.text=e,this.$bar.find(".noty_text").html(e)),this},setType:function(e){return this.closed||(this.options.type=e,this.options.theme.style.apply(this),this.options.theme.callback.onShow.apply(this)),this},setTimeout:function(e){if(!this.closed){var t=this;this.options.timeout=e,t.$bar.delay(t.options.timeout).promise().done(function(){t.close()})}return this},stopPropagation:function(e){e=e||window.event,"undefined"!=typeof e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},closed:!1,showing:!1,shown:!1};e.notyRenderer={},e.notyRenderer.init=function(n){var i=Object.create(t).init(n);return i.options.killer&&e.noty.closeAll(),i.options.force?e.noty.queue.unshift(i):e.noty.queue.push(i),e.notyRenderer.render(),"object"==e.noty.returns?i:i.options.id},e.notyRenderer.render=function(){var t=e.noty.queue[0];"object"===e.type(t)?t.options.dismissQueue?t.options.maxVisible>0?e(t.options.layout.container.selector+" li").length<t.options.maxVisible&&e.notyRenderer.show(e.noty.queue.shift()):e.notyRenderer.show(e.noty.queue.shift()):e.noty.ontap&&(e.notyRenderer.show(e.noty.queue.shift()),e.noty.ontap=!1):e.noty.ontap=!0},e.notyRenderer.show=function(t){t.options.modal&&(e.notyRenderer.createModalFor(t),e.notyRenderer.setModalCount(1)),t.options.custom?0==t.options.custom.find(t.options.layout.container.selector).length?t.options.custom.append(e(t.options.layout.container.object).addClass("i-am-new")):t.options.custom.find(t.options.layout.container.selector).removeClass("i-am-new"):0==e(t.options.layout.container.selector).length?e("body").append(e(t.options.layout.container.object).addClass("i-am-new")):e(t.options.layout.container.selector).removeClass("i-am-new"),e.notyRenderer.setLayoutCountFor(t,1),t.show()},e.notyRenderer.createModalFor=function(t){if(0==e(".noty_modal").length){var n=e("<div/>").addClass("noty_modal").addClass(t.options.theme).data("noty_modal_count",0);t.options.theme.modal&&t.options.theme.modal.css&&n.css(t.options.theme.modal.css),n.prependTo(e("body")).fadeIn("fast")}},e.notyRenderer.getLayoutCountFor=function(t){return e(t.options.layout.container.selector).data("noty_layout_count")||0},e.notyRenderer.setLayoutCountFor=function(t,n){return e(t.options.layout.container.selector).data("noty_layout_count",e.notyRenderer.getLayoutCountFor(t)+n)},e.notyRenderer.getModalCount=function(){return e(".noty_modal").data("noty_modal_count")||0},e.notyRenderer.setModalCount=function(t){return e(".noty_modal").data("noty_modal_count",e.notyRenderer.getModalCount()+t)},e.fn.noty=function(t){return t.custom=e(this),e.notyRenderer.init(t)},e.noty={},e.noty.queue=[],e.noty.ontap=!0,e.noty.layouts={},e.noty.themes={},e.noty.returns="object",e.noty.store={},e.noty.get=function(t){return e.noty.store.hasOwnProperty(t)?e.noty.store[t]:!1},e.noty.close=function(t){return e.noty.get(t)?e.noty.get(t).close():!1},e.noty.setText=function(t,n){return e.noty.get(t)?e.noty.get(t).setText(n):!1;
},e.noty.setType=function(t,n){return e.noty.get(t)?e.noty.get(t).setType(n):!1},e.noty.clearQueue=function(){e.noty.queue=[]},e.noty.closeAll=function(){e.noty.clearQueue(),e.each(e.noty.store,function(e,t){t.close()})};var n=window.alert;e.noty.consumeAlert=function(t){window.alert=function(n){t?t.text=n:t={text:n},e.notyRenderer.init(t)}},e.noty.stopConsumeAlert=function(){window.alert=n},e.noty.defaults={layout:"top",theme:"defaultTheme",type:"alert",text:"",dismissQueue:!0,template:'<div class="noty_message"><span class="noty_text"></span><div class="noty_close"></div></div>',animation:{open:{height:"toggle"},close:{height:"toggle"},easing:"swing",speed:500},timeout:!1,force:!1,modal:!1,maxVisible:5,killer:!1,closeWith:["click"],callback:{onShow:function(){},afterShow:function(){},onClose:function(){},afterClose:function(){},onCloseClick:function(){}},buttons:!1},e(window).on("resize",function(){e.each(e.noty.layouts,function(t,n){n.container.style.apply(e(n.container.selector))})})}(o),window.noty=function(e){return o.notyRenderer.init(e)},function(e){e.noty.layouts.bottom={name:"bottom",options:{},container:{object:'<ul id="noty_bottom_layout_container" />',selector:"ul#noty_bottom_layout_container",style:function(){e(this).css({bottom:0,left:"5%",position:"fixed",width:"90%",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:9999999})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none"},addClass:""}}(o),function(e){e.noty.layouts.bottomCenter={name:"bottomCenter",options:{},container:{object:'<ul id="noty_bottomCenter_layout_container" />',selector:"ul#noty_bottomCenter_layout_container",style:function(){e(this).css({bottom:20,left:0,position:"fixed",width:"310px",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:1e7}),e(this).css({left:(e(window).width()-e(this).outerWidth(!1))/2+"px"})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none",width:"310px"},addClass:""}}(o),function(e){e.noty.layouts.bottomLeft={name:"bottomLeft",options:{},container:{object:'<ul id="noty_bottomLeft_layout_container" />',selector:"ul#noty_bottomLeft_layout_container",style:function(){e(this).css({bottom:20,left:20,position:"fixed",width:"310px",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:1e7}),window.innerWidth<600&&e(this).css({left:5})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none",width:"310px"},addClass:""}}(o),function(e){e.noty.layouts.bottomRight={name:"bottomRight",options:{},container:{object:'<ul id="noty_bottomRight_layout_container" />',selector:"ul#noty_bottomRight_layout_container",style:function(){e(this).css({bottom:20,right:20,position:"fixed",width:"310px",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:1e7}),window.innerWidth<600&&e(this).css({right:5})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none",width:"310px"},addClass:""}}(o),function(e){e.noty.layouts.center={name:"center",options:{},container:{object:'<ul id="noty_center_layout_container" />',selector:"ul#noty_center_layout_container",style:function(){e(this).css({position:"fixed",width:"310px",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:1e7});var t=e(this).clone().css({visibility:"hidden",display:"block",position:"absolute",top:0,left:0}).attr("id","dupe");e("body").append(t),t.find(".i-am-closing-now").remove(),t.find("li").css("display","block");var n=t.height();t.remove(),e(this).hasClass("i-am-new")?e(this).css({left:(e(window).width()-e(this).outerWidth(!1))/2+"px",top:(e(window).height()-n)/2+"px"}):e(this).animate({left:(e(window).width()-e(this).outerWidth(!1))/2+"px",top:(e(window).height()-n)/2+"px"},500)}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none",width:"310px"},addClass:""}}(o),function(e){e.noty.layouts.centerLeft={name:"centerLeft",options:{},container:{object:'<ul id="noty_centerLeft_layout_container" />',selector:"ul#noty_centerLeft_layout_container",style:function(){e(this).css({left:20,position:"fixed",width:"310px",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:1e7});var t=e(this).clone().css({visibility:"hidden",display:"block",position:"absolute",top:0,left:0}).attr("id","dupe");e("body").append(t),t.find(".i-am-closing-now").remove(),t.find("li").css("display","block");var n=t.height();t.remove(),e(this).hasClass("i-am-new")?e(this).css({top:(e(window).height()-n)/2+"px"}):e(this).animate({top:(e(window).height()-n)/2+"px"},500),window.innerWidth<600&&e(this).css({left:5})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none",width:"310px"},addClass:""}}(o),function(e){e.noty.layouts.centerRight={name:"centerRight",options:{},container:{object:'<ul id="noty_centerRight_layout_container" />',selector:"ul#noty_centerRight_layout_container",style:function(){e(this).css({right:20,position:"fixed",width:"310px",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:1e7});var t=e(this).clone().css({visibility:"hidden",display:"block",position:"absolute",top:0,left:0}).attr("id","dupe");e("body").append(t),t.find(".i-am-closing-now").remove(),t.find("li").css("display","block");var n=t.height();t.remove(),e(this).hasClass("i-am-new")?e(this).css({top:(e(window).height()-n)/2+"px"}):e(this).animate({top:(e(window).height()-n)/2+"px"},500),window.innerWidth<600&&e(this).css({right:5})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none",width:"310px"},addClass:""}}(o),function(e){e.noty.layouts.inline={name:"inline",options:{},container:{object:'<ul class="noty_inline_layout_container" />',selector:"ul.noty_inline_layout_container",style:function(){e(this).css({width:"100%",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:9999999})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none"},addClass:""}}(o),function(e){e.noty.layouts.top={name:"top",options:{},container:{object:'<ul id="noty_top_layout_container" />',selector:"ul#noty_top_layout_container",style:function(){e(this).css({top:0,left:"5%",position:"fixed",width:"90%",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:9999999})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none"},addClass:""}}(o),function(e){e.noty.layouts.topCenter={name:"topCenter",options:{},container:{object:'<ul id="noty_topCenter_layout_container" />',selector:"ul#noty_topCenter_layout_container",style:function(){e(this).css({top:20,left:0,position:"fixed",width:"310px",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:1e7}),e(this).css({left:(e(window).width()-e(this).outerWidth(!1))/2+"px"})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none",width:"310px"},addClass:""}}(o),function(e){e.noty.layouts.topLeft={name:"topLeft",options:{},container:{object:'<ul id="noty_topLeft_layout_container" />',selector:"ul#noty_topLeft_layout_container",style:function(){e(this).css({top:20,left:20,position:"fixed",width:"310px",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:1e7}),window.innerWidth<600&&e(this).css({left:5})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none",width:"310px"},addClass:""}}(o),function(e){e.noty.layouts.topRight={name:"topRight",options:{},container:{object:'<ul id="noty_topRight_layout_container" />',selector:"ul#noty_topRight_layout_container",style:function(){e(this).css({top:20,right:20,position:"fixed",width:"310px",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:1e7}),window.innerWidth<600&&e(this).css({right:5})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none",width:"310px"},addClass:""}}(o),function(e){e.noty.themes.defaultTheme={name:"defaultTheme",helpers:{borderFix:function(){if(this.options.dismissQueue){var t=this.options.layout.container.selector+" "+this.options.layout.parent.selector;switch(this.options.layout.name){case"top":e(t).css({borderRadius:"0px 0px 0px 0px"}),e(t).last().css({borderRadius:"0px 0px 5px 5px"});break;case"topCenter":case"topLeft":case"topRight":case"bottomCenter":case"bottomLeft":case"bottomRight":case"center":case"centerLeft":case"centerRight":case"inline":e(t).css({borderRadius:"0px 0px 0px 0px"}),e(t).first().css({"border-top-left-radius":"5px","border-top-right-radius":"5px"}),e(t).last().css({"border-bottom-left-radius":"5px","border-bottom-right-radius":"5px"});break;case"bottom":e(t).css({borderRadius:"0px 0px 0px 0px"}),e(t).first().css({borderRadius:"5px 5px 0px 0px"})}}}},modal:{css:{position:"fixed",width:"100%",height:"100%",backgroundColor:"#000",zIndex:1e4,opacity:.6,display:"none",left:0,top:0}},style:function(){switch(this.$bar.css({overflow:"hidden",background:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABsAAAAoCAYAAAAPOoFWAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAPZJREFUeNq81tsOgjAMANB2ov7/7ypaN7IlIwi9rGuT8QSc9EIDAsAznxvY4pXPKr05RUE5MEVB+TyWfCEl9LZApYopCmo9C4FKSMtYoI8Bwv79aQJU4l6hXXCZrQbokJEksxHo9KMOgc6w1atHXM8K9DVC7FQnJ0i8iK3QooGgbnyKgMDygBWyYFZoqx4qS27KqLZJjA1D0jK6QJcYEQEiWv9PGkTsbqxQ8oT+ZtZB6AkdsJnQDnMoHXHLGKOgDYuCWmYhEERCI5gaamW0bnHdA3k2ltlIN+2qKRyCND0bhqSYCyTB3CAOc4WusBEIpkeBuPgJMAAX8Hs1NfqHRgAAAABJRU5ErkJggg==') repeat-x scroll left top #fff"}),this.$message.css({fontSize:"13px",lineHeight:"16px",textAlign:"center",padding:"8px 10px 9px",width:"auto",position:"relative"}),this.$closeButton.css({position:"absolute",top:4,right:4,width:10,height:10,background:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAATpJREFUeNoszrFqVFEUheG19zlz7sQ7ijMQBAvfYBqbpJCoZSAQbOwEE1IHGytbLQUJ8SUktW8gCCFJMSGSNxCmFBJO7j5rpXD6n5/P5vM53H3b3T9LOiB5AQDuDjM7BnA7DMPHDGBH0nuSzwHsRcRVRNRSysuU0i6AOwA/02w2+9Fae00SEbEh6SGAR5K+k3zWWptKepCm0+kpyRoRGyRBcpPkDsn1iEBr7drdP2VJZyQXERGSPpiZAViTBACXKaV9kqd5uVzCzO5KKb/d/UZSDwD/eyxqree1VqSu6zKAF2Z2RPJJaw0rAkjOJT0m+SuT/AbgDcmnkmBmfwAsJL1dXQ8lWY6IGwB1ZbrOOb8zs8thGP4COFwx/mE8Ho9Go9ErMzvJOW/1fY/JZIJSypqZfXX3L13X9fcDAKJct1sx3OiuAAAAAElFTkSuQmCC)",display:"none",cursor:"pointer"}),this.$buttons.css({padding:5,textAlign:"right",borderTop:"1px solid #ccc",backgroundColor:"#fff"}),this.$buttons.find("button").css({marginLeft:5}),this.$buttons.find("button:first").css({marginLeft:0}),this.$bar.on({mouseenter:function(){e(this).find(".noty_close").stop().fadeTo("normal",1)},mouseleave:function(){e(this).find(".noty_close").stop().fadeTo("normal",0)}}),this.options.layout.name){case"top":this.$bar.css({borderRadius:"0px 0px 5px 5px",borderBottom:"2px solid #eee",borderLeft:"2px solid #eee",borderRight:"2px solid #eee",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"});break;case"topCenter":case"center":case"bottomCenter":case"inline":this.$bar.css({borderRadius:"5px",border:"1px solid #eee",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"}),this.$message.css({fontSize:"13px",textAlign:"center"});break;case"topLeft":case"topRight":case"bottomLeft":case"bottomRight":case"centerLeft":case"centerRight":this.$bar.css({borderRadius:"5px",border:"1px solid #eee",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"}),this.$message.css({fontSize:"13px",textAlign:"left"});break;case"bottom":this.$bar.css({borderRadius:"5px 5px 0px 0px",borderTop:"2px solid #eee",borderLeft:"2px solid #eee",borderRight:"2px solid #eee",boxShadow:"0 -2px 4px rgba(0, 0, 0, 0.1)"});break;default:this.$bar.css({border:"2px solid #eee",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"})}switch(this.options.type){case"alert":case"notification":this.$bar.css({backgroundColor:"#FFF",borderColor:"#CCC",color:"#444"});break;case"warning":this.$bar.css({backgroundColor:"#FFEAA8",borderColor:"#FFC237",color:"#826200"}),this.$buttons.css({borderTop:"1px solid #FFC237"});break;case"error":this.$bar.css({backgroundColor:"red",borderColor:"darkred",color:"#FFF"}),this.$message.css({fontWeight:"bold"}),this.$buttons.css({borderTop:"1px solid darkred"});break;case"information":this.$bar.css({backgroundColor:"#57B7E2",borderColor:"#0B90C4",color:"#FFF"}),this.$buttons.css({borderTop:"1px solid #0B90C4"});break;case"success":this.$bar.css({backgroundColor:"lightgreen",borderColor:"#50C24E",color:"darkgreen"}),this.$buttons.css({borderTop:"1px solid #50C24E"});break;default:this.$bar.css({backgroundColor:"#FFF",borderColor:"#CCC",color:"#444"})}},callback:{onShow:function(){e.noty.themes.defaultTheme.helpers.borderFix.apply(this)},onClose:function(){e.noty.themes.defaultTheme.helpers.borderFix.apply(this)}}}}(o)}.apply(t,i),!(void 0!==r&&(e.exports=r)),e.exports=noty}).call(t,n(33))},function(e,t,n){var i,r;i=[n(34),n(38)],r=function(e,t){return t.serviceModule.service("STORE",["$q","API",function(e,t){var n,i;return i={},n=function(){function e(){this.data}return e.prototype.update=function(e,t){var n;return n=this,source instanceof SegmentEntity?source.retrieve(t):void 0},e.prototype.get=function(){return this.data},e.prototype.set=function(e){return this.data=e},e}(),i.user=new n,i.session=new n,i.projectMemberList=new n,i.projectCategory=new n,i.projectVersion=new n,i.teamMemberList=new n,i.teamCategory=new n,i}])}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(34),n(38)],r=function(e,t){return t.serviceModule.service("EDITORSTORE",["$q","API",function(e,t){var n,i,r;return r={},n=function(){function e(){this.storage=JSON.parse(localStorage.getItem("EDITORSTORE"))||[]}return e.prototype.getItem=function(e){var t,n,i,r;if(this.storage=JSON.parse(localStorage.getItem("EDITORSTORE")||[]),this.storage)for(r=this.storage,t=0,i=r.length;i>t;t++)if(n=r[t],n.key===e)return n.value},e.prototype.setItem=function(e,t,n){var i,r,o,a,s;if(s=1*new Date,!(s-this.time<5e3&&n)){if(this.time=s,this.storage)for(a=this.storage,i=0,o=a.length;o>i;i++)if(r=a[i],r.key===e)return r.value=t,r.time=s,void localStorage.setItem("EDITORSTORE",JSON.stringify(this.storage));return this.storage.push({key:e,value:t,time:s}),localStorage.setItem("EDITORSTORE",JSON.stringify(this.storage))}},e.prototype.getList=function(){return JSON.parse(localStorage.getItem("EDITORSTORE"))},e}(),i=new n,r={get:function(e){return i.getItem(e)},set:function(e,t,n){return i.setItem(e,t,n)},list:function(){return i.getList()}}}])}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;(function(o){"use strict";i=[n(34),n(38)],r=function(e,t){return t.serviceModule.factory("LOADING",[function(){var e,t;return t=function(){return o("#loading").fadeIn()},e=function(){return o("#loading").fadeOut()},{loading:t,loaded:e}}])}.apply(t,i),!(void 0!==r&&(e.exports=r))}).call(t,n(33))},function(e,t,n){var i,r;i=[n(98),n(99)],r=function(){}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(38),n(39),n(43),n(44)],r=function(e,t,n,i){return e.controllerModule.controller("teamController",["$rootScope","$scope","$routeParams","$location","$stateParams","API","STORE","NOTIFY",function(e,t,n,i,r,o,a,s){var l,c,d,u,p,h;return u=o.team(r.team_id),t.team_id=r.team_id,t.title=i.$$search.title,h=function(){return u.member().retrieve().then(function(e){return t.teamMember=e.members,t.teamRole=e.role,a.teamMemberList.data=e})},p=function(){return o.team().retrieve().then(function(e){return t.team=l(e),a.teamCategory.data=e})},l=function(e){var t,n,i,r,o;for(r={teamCategory:[],inviteCategory:[]},o=["inviteCategory","teamCategory"],t=0,n=e.length;n>t;t++)i=e[t],r[o[i.status]].push(i);return r},c=function(e){var n;return"-1"===e?alert("新建版本的功能暂未发"):(n="/team/"+r.team_id,t.$apply(function(){return i.path(n)}))},d=function(){return u["delete"]().then(function(e){return s.success("删除成功！"),window.location.href="/team/0/list"})},t.createTeam=function(){return t.$broadcast("team:setting:show")},t.editTeam=function(){return t.$broadcast("team:setting:show",t.title,t.team_id)},t.$on("team:remove",function(){return d()}),t.$on("team:member:request",function(){return h()}),t.$on("team:category:request",function(){return p()}),t.$on("member:creator:toshow",function(e,n){return t.$broadcast("member:creator:show",n)}),t.$on("dropdown:selected",function(e,t,n){switch(t){case"project:version":return c(n)}}),parseInt(r.team_id)>0&&h(),p()}])}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;(function(o){"use strict";i=[n(38),n(44),n(100),n(53)],r=function(e,t,n){return e.directiveModule.directive("teamCategoryMenu",["STORE",function(){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-team-menu-category",n),link:function(e,t,n){}}}]).directive("teamInviteMenu",["STORE",function(){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-team-menu-invite",n),link:function(e,t,n){}}}]).directive("teamMenuBar",[function(){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-team-menu-bar",n),link:function(e,t,n){}}}]).directive("teamCreate",["API",function(e){return{restrict:"AC",link:function(t,n,i){var r,a;return r=o(n),a=function(t){var n;return n={name:r.val()},e.team().create(n).then(function(e){return window.location.href="/team/"+e.id+"/list?title="+e.name})},r.on("keyup",function(e){return 13===e.keyCode&&r.val()?a():void 0})}}}]).directive("teamInviteItem",["API","NOTIFY",function(e,i){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-team-invite-item",n),link:function(t,n,r){return t.inviteAccept=function(n,r){var o,a,s;return s=["update","delete"],o={status:1},a=e.team(n.team_id).member(n.member_id),a[s[r]](o).then(function(e){return i.success("操作成功！"),t.$emit("team:category:request")})}}}}]).directive("teamSetting",["$location","API","NOTIFY",function(e,i,r){return{restrict:"E",replace:!0,scope:{},template:t.extractTemplate("#tmpl-team-setting",n),link:function(t,n,a){var s;return s=o(n),t.$on("team:setting:show",function(e,n,i){return s.modal({showClose:!1}),t.isEdit=n||i,t.profile={teamName:n,team_id:i}}),t.$on("team:setting:hide",function(){return o.modal.close()}),t.onClickCancel=function(){return t.$emit("team:setting:hide")},t.onClickSave=function(){var n,a;if(t.profile.teamName!==t.title)return n={name:t.profile.teamName},a="create",t.isEdit&&(a="update"),i.team(t.profile.team_id)[a](n).then(function(n){return r.success("保存成功！"),t.profile={},o.modal.close(),n.id?e.url("/team/"+n.id+"/list?title="+n.name):void 0})},t.onClickDelete=function(){return confirm("删除团队后，团队的成员关系将不复存在，请慎重操作！")&&confirm("你真的确定要删除该团队了吗？")&&confirm("要不要再考虑一下呢？")?t.$emit("team:remove"):void 0}}}}])}.apply(t,i),!(void 0!==r&&(e.exports=r))}).call(t,n(33))},function(e,t){var n,i=window.angular;try{n=i.module(["ng"])}catch(r){n=i.module("ng",[])}var o='<div> <textarea id="tmpl-team-layout">\n        <div class="frame project-view team-view">\n            <global-message ng-show="false"></global-message>\n            <header-global></header-global>\n            <div class="container">\n                \n                <div class="master-panel">\n                    \n                    <div class="project-menu">\n                        <ul class="master-menu" project-menu-highlight>\n                            <li class="issue-category">\n                                <div class="inner">\n                                    <div class="title">\n                                        <label>\n                                            <a href="/team/0/invite?title=我收到的邀请">我收到的邀请</a>\n                                        </label>\n                                    </div>\n                                </div>\n                            </li>\n                            <li class="issue-category">\n                                <div class="inner">\n                                    <div class="title">\n                                        <label>\n                                            <a>我的团队</a>\n                                        </label>\n                                    </div>\n                                    <div ng-show="team.teamCategory.length == 0" class="empty ng-binding">\n                                        尚未加入任何团队\n                                    </div>\n                                    <team-category-menu></team-category-menu>\n                                </div>\n                            </li>\n                        </ul>\n                        <team-menu-bar></team-menu-bar>\n                    </div>\n                </div>\n\n\n                <project-salve-panel></project-salve-panel>\n            </div>\n        </div>\n    </textarea>  <textarea id="tmpl-team-menu-category">\n        <ul class="sub-menu">\n            <li ng-repeat="item in team.teamCategory">\n                <a href="/team/{{item.team_id}}/list?title={{item.name}}" class="text-overflow">{{item.name}}</a>\n            </li>\n        </ul>\n    </textarea>  <textarea id="tmpl-team-member-list">\n        <member-creator-model></member-creator-model>\n        <div class="list project-list-panel member-list">\n            <header ng-show="title">\n                <h3>\n                    {{title}}-团队成员\n                    <a class="edit" ng-if="teamRole==\'l\'" ng-click="editTeam()">编辑</a>\n                </h3>\n            </header>\n            <div class="create">\n                <input type="text" placeholder="请输入将要添加的组名" ng-if="team_id==-1" team-create/>\n            </div>\n            <div class="create">\n                <input type="text" placeholder="请输入将要添加用户的姓名" ng-if="team_id>0" members-lookup autofocus/>\n            </div>\n            <ul class="details">\n                <team-member-item></team-member-item>\n            </ul>\n\n            <team-setting></team-setting>\n        </div>\n    </textarea>  <textarea id="tmpl-team-invite-list">\n        <member-creator-model></member-creator-model>\n        <div class="list project-list-panel member-list">\n            <header ng-show="title">\n                <h3>\n                    我的邀请\n                </h3>\n            </header>   \n            <div ng-show="team.inviteCategory.length == 0" class="empty ng-binding">\n                    还没有新的团队邀请哦\n            </div>\n            <ul class="details">\n                <team-invite-item></team-invite-item>\n            </ul>\n            <team-setting></team-setting>\n        </div>\n    </textarea>  <textarea id="tmpl-team-invite-item">\n        <li ng-repeat="team in team.inviteCategory" class="row">\n            <span class="invite">{{team.inviter_name}}邀请你加入团队：{{team.name}}</span>\n            <a class="invite" ng-click="inviteAccept(team, 1)">拒绝</a>\n            <a class="invite" ng-click="inviteAccept(team, 0)">接受</a>\n        </li>\n    </textarea>  <textarea id="tmpl-team-menu-bar">\n        <div>\n            <div class="menu-bar">\n                <div class="create item">\n                    <a ng-click="createTeam()" class="team">\n                        <i class="icon create"></i>\n                        <span>创建团队</span>\n                    </a>\n                </div>\n            </div>\n        </div>\n    </textarea> <textarea id="tmpl-team-setting">\n        <div class="modal">\n            <div class="inner">\n                <a class="close-modal" rel="modal:close"><i class="icon"></i></a>\n                <div class="simple-tab" simple-tab="" data-active-index="0">\n                    <div class="nav title" data-field="nav">\n                        <span>编辑团队</span>\n                    </div>\n                </div>\n                <div class="content" data-field="content">\n                    <div class="panel">\n                        <div class="standard-form">\n                            <div class="row">\n                                <label class="caption">\n                                    团队名：\n                                </label>\n                                <input class="medium text" type="text" ng-model="profile.teamName" required/>\n                            </div>\n                            <div class="row">\n                                <label class="caption">\n                                    注意事项：\n                                </label>\n                                <span ng-show="!isEdit">请在保存后继续添加团队成员！</span>\n                                <span ng-show="isEdit">删除团队后，团队的成员关系将不复存在，请慎重操作！</span>\n                            </div>\n\n                            <div class="row control">\n                                <button class="primary default" ng-click="onClickSave()">保存</button>\n                                <button class="delete default" ng-click="onClickDelete()" ng-show="isEdit">删除</button>\n                                <button class="cancel default" ng-click="onClickCancel()">取消</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </textarea> </div>';n.run(["$templateCache",function(e){e.put("team-all.html",o)}]),e.exports=o},function(e,t,n){var i,r;i=[n(102),n(103)],r=function(){}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(38),n(44),n(62)],r=function(e,t,n,i){return e.controllerModule.controller("streamListController",["$scope","$timeout","API",function(e,t,i){var r;return r=function(e){var t,n,i,r,o,a;for(n=[],t={timestamp:0,items:[]},r=i=0,a=e.length;a>i;r=++i)o=e[r],r>0&&new Date(o.timestamp).toDateString()===new Date(e[r-1].timestamp).toDateString()||0===r?t.items.push(o):(n.push({timestamp:t.timestamp,items:t.items}),t.items=[o]),t.timestamp=o.timestamp,r+1===e.length&&n.push(t);return n},i.stream().retrieve().then(function(i){return e.days=r(i),t(n.initHighlighting,500)}),i.session().retrieve().then(function(t){return e.member=t})}])}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(38),n(44),n(104)],r=function(e,t,n){return e.directiveModule.directive("streamList",["$timeout","API",function(e,i){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-stream-list",n),link:function(e,t,n){var r;return r=function(e){var t,n,i,r,o,a;for(n=[],t={timestamp:0,items:[]},r=i=0,a=e.length;a>i;r=++i)o=e[r],r>0&&new Date(o.timestamp).toDateString()===new Date(e[r-1].timestamp).toDateString()||0===r?t.items.push(o):(n.push({timestamp:t.timestamp,items:t.items}),t.items=[o]),t.timestamp=o.timestamp,r+1===e.length&&n.push(t);return n},i.stream().retrieve().then(function(t){return e.days=r(t)})}}}]).directive("streamIssueDay",["API",function(){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-stream-issue-day",n),link:function(e,t,n){return e.day=JSON.parse(n.day),new Date(e.day.timestamp).toDateString()===(new Date).toDateString()?e.today="today":void 0}}}]).directive("streamListCell",["API",function(){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-stream-list-cell",n),link:function(e,t,n){return e.item=JSON.parse(n.item)}}}]).directive("streamIssueAssigned",["API",function(){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-stream-issue-assigned",n),link:function(e,t,n){return e.item=JSON.parse(n.item)}}}]).directive("streamIssueStatusChange",["API",function(){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-stream-issue-status-change",n),link:function(e,t,n){return e.item=JSON.parse(n.item)}}}]).directive("streamIssueCommentPost",["API",function(){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-stream-issue-comment-post",n),link:function(e,t,n){return e.item=JSON.parse(n.item)}}}]).directive("streamIssueAssetPost",["API",function(){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-stream-issue-asset-post",n),link:function(e,t,n){return e.item=JSON.parse(n.item)}}}]).directive("streamIssueMention",["API",function(){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-stream-issue-mention",n),link:function(e,t,n){return e.item=JSON.parse(n.item)}}}]).directive("streamTeamInvitation",["API",function(){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-stream-team-invitation",n),link:function(e,t,n){return e.item=JSON.parse(n.item)}}}])}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t){var n,i=window.angular;try{n=i.module(["ng"])}catch(r){n=i.module("ng",[])}var o='<div> <textarea id="tmpl-stream-list">\n		<div class="stream">\n			<stream-issue-day data-day="{{day}}" ng-repeat="day in days"></stream-issue-day>\n		</div>\n	</textarea> <textarea id="tmpl-stream-issue-day">\n		\n		<div class="stream-day">\n			<div class="date-title" ng-class="today">{{day.timestamp | dateAgo}}</div>\n			<ul class="stream-body">\n				<stream-list-cell data-item="{{item}}" ng-repeat="item in day.items"></stream-list-cell>\n			</ul>\n\n		</div>\n\n	</textarea> <textarea id="tmpl-stream-list-cell">\n		<li class="stream-cell">\n			<stream-issue-assigned data-item="{{item}}" ng-if="item.eventName==\'issue:assigned\'"></stream-issue-assigned>\n			<stream-issue-status-change data-item="{{item}}" ng-if="item.eventName==\'issue:status:change\'"></stream-issue-status-change>\n			<stream-issue-comment-post data-item="{{item}}" ng-if="item.eventName==\'issue:comment:post\'"></stream-issue-comment-post>\n			<stream-issue-asset-post data-item="{{item}}" ng-if="item.eventName==\'issue:asset:post\'"></stream-issue-asset-post>\n			<stream-issue-mention data-item="{{item}}" ng-if="item.eventName==\'issue:mention\'"></stream-issue-mention>\n			<stream-team-invitation data-item="{{item}}" ng-if="item.eventName==\'team:invitation\'"></stream-team-invitation>\n\n		</li>\n	</textarea> <textarea id="tmpl-stream-issue-assigned">\n		<div>\n			<span class="stream-time">{{item.timestamp | timeAgo}}</span>\n			<span ng-if="member.member_id!=item.data.owner_id">{{item.sender}}为{{item.data.owner_name}}指定了任务</span>\n			<span ng-if="member.member_id==item.data.owner_id">{{item.sender}}为你指定了任务</span>\n			<a class="stream-title" href="/project/{{item.data.project_id}}/issue/{{item.data.issue_id}}">{{item.data.title}}</a>\n			<span ng-if="item.data.plan_finish_time">{{item.data.plan_finish_time|date:yyyy-mm-dd}}前完成</span>\n		</div>\n		\n\n	</textarea> <textarea id="tmpl-stream-issue-status-change">\n	    <div>\n			<span class="stream-time">{{item.timestamp | timeAgo}}</span>\n			<i class="icon small pause" ng-class="item.data.status"></i>\n			<span ng-if="item.data.status==\'done\'">\n				{{item.sender}}完成了任务\n			</span>\n			<span ng-if="item.data.status==\'doing\'">\n				{{item.sender}}将任务状态改为正在进行中\n			</span>\n			<span ng-if="item.data.status==\'pause\'">\n				{{item.sender}}暂停了任务\n			</span>\n			<a class="stream-title" href="/project/{{item.data.project_id}}/issue/{{item.data.issue_id}}">{{item.data.title}}</a>\n		</div>\n	</textarea> <textarea id="tmpl-stream-issue-comment-post">\n		<div>\n			<span class="stream-time">{{item.timestamp | timeAgo}}</span>\n			<span>{{item.sender}}添加了评论</span>\n			<a class="stream-title" href="/project/{{item.data.project_id}}/issue/{{item.data.issue_id}}">{{item.data.title}}</a>\n			<div class="comment" ng-bind-html="item.data.comment | unsafe">\n				\n			</div>\n		</div>\n		\n\n	</textarea> <textarea id="tmpl-stream-issue-asset-post">\n		<div>\n			<span class="stream-time">{{item.timestamp | timeAgo}}</span>\n			<span>{{item.sender}}上传了附件</span><span class="file-name">{{item.data.original_name}}</span>\n			<a class="stream-title" href="/project/{{item.data.project_id}}/issue/{{item.data.issue_id}}">{{item.data.title}}</a>\n			<div ng-class="item.data.url | getAssetThumbnailClass" style="background-image: url({{item.data | assetThumbnail}})">\n			</div>\n		</div>\n	</textarea> <textarea id="tmpl-stream-issue-mention">\n		<div>\n			<span class="stream-time">{{item.timestamp | timeAgo}}</span>\n			<span>{{item.sender}}提到了你</span>\n			<a class="stream-title" href="/project/{{item.data.project_id}}/issue/{{item.data.issue_id}}">{{item.data.title}}</a>\n			<div class="comment" ng-bind-html="item.data.content | unsafe">\n				\n			</div>\n		</div>	\n\n	</textarea> <textarea id="tmpl-stream-team-invitation">\n		<div>\n			<span class="stream-time">{{item.timestamp | timeAgo}}</span>\n			<span>{{item.sender}}邀请你加入团队</span>\n			<a class="stream-title" href="/team/0/invite">{{item.data.teamName}}</a>\n		</div>	\n\n	</textarea> </div>';
n.run(["$templateCache",function(e){e.put("stream-all.html",o)}]),e.exports=o},function(e,t,n){var i,r;i=[n(106),n(107),n(108),n(109)],r=function(){}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(38),n(44)],r=function(e,t){return e.controllerModule.controller("gitlabController",["$rootScope","$scope","$stateParams","API","NOTIFY",function(e,t,n,i,r){var o,a,s,l,c,d,u;return u=i.project(n.project_id),d=function(e){return u[e]().retrieve()},l=function(e){return u.gitlab(e)["delete"]().then(function(e){return r.success("删除成功！"),t.$broadcast("component:gitlab:reload")})},c=function(e){return u.gitlab(e).fork().retrieve().then(function(){return r.success("fork成功！"),t.$broadcast("component:gitlab:reload")})},o=function(e){return u.gitlab().update({gitlab_url:e}).then(function(){return r.success("添加成功！"),t.$broadcast("component:gitlab:reload"),t.$broadcast("component:gitlab_add_form:reset")})},a=function(e){return u.gitlab().create({gitlab_name:e}).then(function(){return r.success("创建项目成功"),t.$broadcast("component:gitlab:reload"),t.$broadcast("component:gitlab_create_form:reset")})},s=function(e,t){switch(e){case"fork":return c(t);case"del":return l(t);case"add":return o(t);case"create":return a(t)}},t.bean={getData:d,doAction:s}}])}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(38)],r=function(e){var t,n;return n="<div class='gitlab-list'> <header> <h3><i class='icon small list title'></i>Git仓库列表</h3> </header> <ul> <li ng-repeat='item in gitList' title='{{item.git}}'> {{onlyShowName(item.git)}} <gitlab-action-bar item='item' bean='bean'></gitlab-action-bar> </li> </ul> </div>",t="<div class='action-bar'> <a ng-click='del()'><i class='icon small del action'></i>删除</a> <a ng-click='fork()'><i class='icon small fork action'></i>Fork</a> </div>",e.directiveModule.directive("gitlabList",["$stateParams",function(e){return{restrict:"E",replace:!0,scope:{bean:"=",name:"@"},template:n,link:function(e,t,n){var i;return e.onlyShowName=function(e){return e=e||"",e.split(":")[1]},i=function(){return e.bean.getData(e.name).then(function(t){return e.gitList=t})},e.$on("component:"+e.name+":reload",function(){return i()}),i()}}}]).directive("gitlabActionBar",[function(){return{restrict:"E",replace:!0,scope:{item:"=",bean:"="},template:t,link:function(e,t,n){return e.fork=function(){return e.bean.doAction("fork",e.item.git_id)},e.del=function(){return e.bean.doAction("del",e.item.id)}}}}])}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(38)],r=function(e){var t;return t="<div class='gitlab-add-form'> <header> <h3><i class='icon small add title'></i>添加已有仓库</h3> </header> <p>如果你的gitlab中已经存在与此项目关联的，请在此处添加 <a href='' >如何知道我的Git仓库地址?</a></p> <input type='text' placeholder='git@git.hunantv.com:honey-lab/bhf.git' ng-model='gitlab_url' > <button ng-click='save()'  class='primary default btn_import'>添加</button> </div>",e.directiveModule.directive("gitlabAddToProject",["$stateParams","NOTIFY",function(e,n){return{restrict:"E",replace:!0,scope:{bean:"=",name:"@"},template:t,link:function(e,t,i){var r;return r=/^git@git\.hunantv\.com:.+\/.+\.git$/,e.save=function(){return e.gitlab_url?r.test(e.gitlab_url)?e.bean.doAction("add",e.gitlab_url):n.warn("gitlab地址格式不正确"):n.warn("gitlab地址不能为空")},e.$on("component:"+e.name+":reset",function(){return e.gitlab_url=""})}}}])}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(38)],r=function(e){var t;return t="<div class='gitlab-create-form'> <header> <h3><i class='icon small create title'></i>创建新的仓库</h3> </header> <input type='text' placeholder='字母,数字,_ 的组合' ng-model='gitlab_name' > <button ng-click='save()' class='primary default btn_import'>创建</button> </div>",e.directiveModule.directive("gitlabCreateForProject",["$stateParams","NOTIFY",function(e,n){return{restrict:"E",replace:!0,scope:{bean:"=",name:"@"},template:t,link:function(e,t,i){var r;return r=/^\w+$/,e.save=function(){return e.gitlab_name?r.test(e.gitlab_name)?e.bean.doAction("create",e.gitlab_name):n.warn("只能是字母，数字和下划线组成"):n.warn("仓库名不能为空")},e.$on("component:"+e.name+":reset",function(){return e.gitlab_name=""})}}}])}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t){/**
	 * @license AngularJS v1.3.0-beta.17
	 * (c) 2010-2014 Google, Inc. http://angularjs.org
	 * License: MIT
	 */
!function(e,t,n){"use strict";function i(){function e(e,n){return t.extend(new(t.extend(function(){},{prototype:e})),n)}function n(e,t){var n=t.caseInsensitiveMatch,i={originalPath:e,regexp:e},r=i.keys=[];return e=e.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)([\?\*])?/g,function(e,t,n,i){var o="?"===i?i:null,a="*"===i?i:null;return r.push({name:n,optional:!!o}),t=t||"",""+(o?"":t)+"(?:"+(o?t:"")+(a&&"(.+?)"||"([^/]+)")+(o||"")+")"+(o||"")}).replace(/([\/$\*])/g,"\\$1"),i.regexp=new RegExp("^"+e+"$",n?"i":""),i}var i={};this.when=function(e,r){if(i[e]=t.extend({reloadOnSearch:!0},r,e&&n(e,r)),e){var o="/"==e[e.length-1]?e.substr(0,e.length-1):e+"/";i[o]=t.extend({redirectTo:e},n(o,r))}return this},this.otherwise=function(e){return this.when(null,e),this},this.$get=["$rootScope","$location","$routeParams","$q","$injector","$http","$templateCache","$sce",function(n,r,o,a,s,l,c,d){function u(e,t){var n=t.keys,i={};if(!t.regexp)return null;var r=t.regexp.exec(e);if(!r)return null;for(var o=1,a=r.length;a>o;++o){var s=n[o-1],l=r[o];s&&l&&(i[s.name]=l)}return i}function p(){var e=h(),i=g.current;e&&i&&e.$$route===i.$$route&&t.equals(e.pathParams,i.pathParams)&&!e.reloadOnSearch&&!f?(i.params=e.params,t.copy(i.params,o),n.$broadcast("$routeUpdate",i)):(e||i)&&(f=!1,n.$broadcast("$routeChangeStart",e,i),g.current=e,e&&e.redirectTo&&(t.isString(e.redirectTo)?r.path(m(e.redirectTo,e.params)).search(e.params).replace():r.url(e.redirectTo(e.pathParams,r.path(),r.search())).replace()),a.when(e).then(function(){if(e){var n,i,r=t.extend({},e.resolve);return t.forEach(r,function(e,n){r[n]=t.isString(e)?s.get(e):s.invoke(e,null,null,n)}),t.isDefined(n=e.template)?t.isFunction(n)&&(n=n(e.params)):t.isDefined(i=e.templateUrl)&&(t.isFunction(i)&&(i=i(e.params)),i=d.getTrustedResourceUrl(i),t.isDefined(i)&&(e.loadedTemplateUrl=i,n=l.get(i,{cache:c}).then(function(e){return e.data}))),t.isDefined(n)&&(r.$template=n),a.all(r)}}).then(function(r){e==g.current&&(e&&(e.locals=r,t.copy(e.params,o)),n.$broadcast("$routeChangeSuccess",e,i))},function(t){e==g.current&&n.$broadcast("$routeChangeError",e,i,t)}))}function h(){var n,o;return t.forEach(i,function(i,a){!o&&(n=u(r.path(),i))&&(o=e(i,{params:t.extend({},r.search(),n),pathParams:n}),o.$$route=i)}),o||i[null]&&e(i[null],{params:{},pathParams:{}})}function m(e,n){var i=[];return t.forEach((e||"").split(":"),function(e,t){if(0===t)i.push(e);else{var r=e.match(/(\w+)(.*)/),o=r[1];i.push(n[o]),i.push(r[2]||""),delete n[o]}}),i.join("")}var f=!1,g={routes:i,reload:function(){f=!0,n.$evalAsync(p)}};return n.$on("$locationChangeSuccess",p),g}]}function r(){this.$get=function(){return{}}}function o(e,n,i){return{restrict:"ECA",terminal:!0,priority:400,transclude:"element",link:function(r,o,a,s,l){function c(){h&&(h.remove(),h=null),u&&(u.$destroy(),u=null),p&&(i.leave(p,function(){h=null}),h=p,p=null)}function d(){var a=e.current&&e.current.locals,s=a&&a.$template;if(t.isDefined(s)){var d=r.$new(),h=e.current,g=l(d,function(e){i.enter(e,null,p||o,function(){!t.isDefined(m)||m&&!r.$eval(m)||n()}),c()});p=g,u=h.scope=d,u.$emit("$viewContentLoaded"),u.$eval(f)}else c()}var u,p,h,m=a.autoscroll,f=a.onload||"";r.$on("$routeChangeSuccess",d),d()}}}function a(e,t,n){return{restrict:"ECA",priority:-400,link:function(i,r){var o=n.current,a=o.locals;r.html(a.$template);var s=e(r.contents());if(o.controller){a.$scope=i;var l=t(o.controller,a);o.controllerAs&&(i[o.controllerAs]=l),r.data("$ngControllerController",l),r.children().data("$ngControllerController",l)}s(i)}}}var s=t.module("ngRoute",["ng"]).provider("$route",i);s.provider("$routeParams",r),s.directive("ngView",o),s.directive("ngView",a),o.$inject=["$route","$anchorScroll","$animate"],a.$inject=["$compile","$controller","$route"]}(window,window.angular)},,function(e,t,n){var i,r;i=[n(38),n(44),n(43)],r=function(e,t,n){return e.controllerModule.controller("homeController",["$scope","$stateParams","$rootScope","API",function(e,t,n,i){}])}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(114),n(119),n(120),n(121)],r=function(){}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;(function(o){"use strict";i=[n(38),n(44),n(43),n(115),n(51),n(116),n(117),n(118)],r=function(e,t,n,i,r,a){return e.directiveModule.directive("datetimePicker",function(){return{restrict:"AC",link:function(e,t,n){var i,r,a,s,l,c,d;switch(r={format:"yyyy-mm-dd",startView:2,minView:2},c={format:"hh:ii:ss",startView:1,minView:0,maxView:1},a={format:"yyyy-mm-dd hh:ii:ss",startView:2},l=n.name,d=n.datetype,s=n.format,d){case"time":r=c;break;case"datetime":r=a}return r.showMeridian=!0,r.autoclose=!0,s&&(r.format=s),i=o(t),i.datetimepicker(r),i.on("changeDate",function(t){return e.$emit("datetime:change",l,t.date.valueOf()-288e5)}),i.on("show",function(){var e;return e=n.date,e&&(e=new Date(Number(e))),i.datetimepicker("setDate",e||new Date)})}}}).directive("simpleTab",function(){return{restrict:"A",replace:!1,link:function(e,t,n){var i;return i=o(t).simpleTab(),n.$observe("activeIndex",function(){return i.simpleTab("change",parseInt(n.activeIndex))})}}}).directive("headerToolbar",["$rootScope","$location","API",function(e,n,r){return{restrict:"E",replace:!0,scope:{},template:t.extractTemplate("#tmpl-global-header-toolbar",i),link:function(t,i,o){return t.onClickSetting=function(t){return e.$emit("member:setting:show",t)},t.onClickTeam=function(){return n.url("/team/0/invite?title=我收到的邀请")},t.onClickReport=function(){return n.url("/report/0/weekly-report")},t.onClickIssues=function(){return n.url("/myproject/all/issue/myself")},t.onClickFollow=function(){return n.url("/myfollow/all/issue/follow?title=我的关注")},t.onClickByUrl=function(e){return n.url(e)},t.onClickLogout=function(){return r.session()["delete"]().then(function(){return n.path("/login")})},t.onClickLogin=function(){return n.path("/login")},t.isLogin=e.__member.isLogin}}}]).directive("hotKey",[function(){return{restrict:"A",link:function(e,t,n){var i,r,s;return i=n.key,a.clear.key(i),r=function(){},s=function(){return o(t).click()},a.on(i,r,s)}}}]).directive("reportWeeklyPrint",["API",function(e){return{restrict:"E",replace:!0,template:t.extractTemplate,link:function(e,t,n){}}}]).directive("instantSearch",["$rootScope",function(e){return{restrict:"A",replace:!0,link:function(n,i,r){return i.bind("focus",function(e){return i.css({width:"100%",opacity:1})}),i.bind("blur",function(e){return i.css({width:"80%",opacity:.8})}),i.bind("keyup",function(n){var r;return r=i.val(),e.$broadcast("instant-search:change",t.trim(r))})}}}]).directive("globalMessage",[function(){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-global-message",i),link:function(e,t,n){}}}]).directive("equalParentHeight",[function(){return{restrict:"A",link:function(e,t,n){var i;return i=function(){return t.css("height",t.parent().outerHeight())},o(window).on("onResizeEx",i),e.$on("$destroy",function(){return o(window).off("onResizeEx",i)}),i()}}}]).directive("fullSizeImagePreviewer",[function(){return{restrict:"A",link:function(e,t,n){return t.bind("click",function(e){var t,n;return t=o(e.target),t.is("img")?(n=t.attr("src"),window.open(n)):void 0})}}}]).directive("pagination",["$rootScope",function(e){return{restrict:"EA",replace:!0,template:t.extractTemplate("#tmpl-pagination",i),link:function(t,n,i){var r,o,a;return a=function(e,t,n){return{number:e,text:t,active:n}},o=function(e,t){var n,i,r,o,s,l,c,d,u;for(u=1,n=t,s=5,r=t>s,r&&(u=Math.max(e-Math.floor(s/2),1),n=u+s-1,n>t&&(n=t,u=n-s+1)),n>t&&(n=t,u=n-s+1),l=[],i=o=c=u,d=n;d>=c?d>=o:o>=d;i=d>=c?++o:--o)l.push(a(i,i,i===e));return u>1&&l.unshift(a(u-1,"...",!1)),t>n&&l.push(a(n+1,"...",!1)),l},r=function(e){return t.currentPage=e.pageIndex,t.totalPages=e.pageCount,t.pages=o(e.pageIndex,e.pageCount)},t.selectPage=function(t){return e.$broadcast("pagination:change",t,i.uuid,function(e){return r(e)})},t.nextPage=function(){return t.currentPage+1>t.totalPages?void 0:t.selectPage(t.currentPage+1)},t.previousPage=function(){return 1!==t.currentPage?t.selectPage(t.currentPage-1):void 0},t.noPrevious=function(){return 1===t.page},t.noNext=function(){return t.page===t.totalPages},i.$observe("paginations",function(){var e;if(i.paginations)return e=JSON.parse(i.paginations),r(e)})}}}]).directive("headerGlobal",function(){return{restrict:"E",replace:!0,template:t.extractTemplate("#tmpl-header",i),link:function(e,t,n){return n.project&&(e.project=n.project),n.projectVersion?e.projectVersion=n.projectVersion:void 0}}})}.apply(t,i),!(void 0!==r&&(e.exports=r))}).call(t,n(33))},function(e,t){var n,i=window.angular;try{n=i.module(["ng"])}catch(r){n=i.module("ng",[])}var o='<div>  <textarea id="tmpl-global-blank-page">\n        <div class="blank-page">\n            <div class="inner">\n                \n            </div>\n        </div>\n    </textarea>  <textarea id="tmpl-global-git-list">\n        <ul class="git-list">\n            <li ng-repeat="account in gitAccounts track by $index" ng-click="onClickEdit($event, $index, account)">\n                <label>{{account}}</label>\n                <button ng-click="onClickRemove($event, $index)">\n                    <i class="icon small remove"></i>\n                </button>\n            </li>\n            <li class="create">\n                <input type="text" class="text medium" placeholder="输入git地址后回车" class="medium" ng-keypress="onKeypressAdd($event)" ng-blur="onKeyupAddLastItem($event)" ng-model="currentText"/>\n            </li>\n        </ul>\n    </textarea>  <textarea id="tmpl-global-header-toolbar">\n        <div class="header-toolbar">\n            <div class="search">\n                <input type="text" placeholder="请输入搜索关键字" class="text" instant-search/>\n            </div>\n            <div class="menu">\n                <div class="profile" ng-if="!isLogin">\n                    <a ng-click="onClickLogin()">\n                        <i class="small icon"></i>\n                        <span>登录</span>\n                    </a>\n                </div>\n\n                <div class="profile" dropdown ng-if="isLogin">\n                    <i class="small icon"></i>\n                    <span>我的</span>\n                    <div class="dropdown dropdown-tip">\n                        <ul class="dropdown-menu">\n                            <li>\n                                <a ng-click="onClickIssues()">个人中心</a>\n                            </li>\n                            <li>\n                                <a ng-click="onClickFollow()">我的关注</a>\n                            </li>\n                            <li>\n                                <a ng-click="onClickTeam()">我的团队</a>\n                            </li>\n                            <li class="spliter">\n                                <a ng-click="onClickReport()">我的报表</a>\n                            </li>\n                            <li>\n                                <a ng-click="onClickSetting(0)">个人资料</a>\n                            </li>\n                            <li class="spliter">\n                                <a ng-click="onClickSetting(3)">通知设置</a>\n                            </li>\n                            <li>\n                                <a ng-click="onClickSetting(1)">修改密码</a>\n                            </li>\n                            <li>\n                                <a ng-click="onClickLogout()">退出</a>\n                            </li>\n                        </ul>\n                    </div>\n                </div>\n\n                <member-message-notifier></member-message-notifier>\n                <div class="help" dropdown>\n                    <i class="small icon"></i>\n                    <span>关于</span>\n                    <div class="dropdown dropdown-tip">\n                        <ul class="dropdown-menu">\n                            <li>\n                                <a ng-click="onClickByUrl(\'/wiki/17/issue\')">帮助</a>\n                            </li>\n                            <li>\n                                <a ng-click="onClickByUrl(\'/wiki/17/category/30/issue\')">反馈建议</a>\n                            </li>\n                        </ul>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </textarea> <textarea id="tmpl-global-message">\n        <div class="global-message">\n            <span>公告：</span>\n            <a href="/wiki/17/category/90/issue/2607">BHF 2.0正式发布，新增19项新功能</a>\n        </div>\n    </textarea> <textarea id="tmpl-pagination">\n        <div class="pagination">\n            <ul>\n                <li ng-class="{disabled: noPrevious()}">\n                    <a href ng-click="selectPage(1)">首页</a>\n                </li>\n                <li ng-class="{disabled: noPrevious()}">\n                    <a href ng-click="previousPage()">上一页</a>\n                </li>\n                \n                <li ng-class="{disabled: noNext()}">\n                    <a href ng-click="nextPage()">下一页</a>\n                </li>\n                <li ng-class="{disabled: noNext()}">\n                    <a href ng-click="selectPage(totalPages)">尾页</a>\n                </li>\n            </ul>\n        </div>\n    </textarea> <textarea id="tmpl-header">\n        <header>\n            \n            <div class="overview">\n                <a href="/" class="home">\n                    <i class="icon small"></i>\n                </a>\n                <div class="content" ng-show="project">\n                    <div class="title">\n                        <label>{{project.title}}</label>\n                        <i class="small icon"></i>\n                    </div>\n                    <i class="small icon open"></i>\n                    <div class="version" dropdown data-name="project:version" data-text-container="label.display" data-selected="{{projectVersion}}" data-exclude-value="-1">\n                        <label class="display">{{projectVersion | currentProjectVersion}}</label>\n                        <i class="small icon"></i>\n                        <project-version-dropdown data-show-more="true"></project-version-dropdown>\n                    </div>\n                </div>\n                <div class="content" ng-show="title">\n                    <div class="title">\n                        <label>{{title}}</label>\n                        <i class="small icon"></i>\n                    </div>\n                </div>\n            </div>\n            <div class="logo">\n                <i class="icon"></i>\n            </div>\n                \n            <header-toolbar></header-toolbar>\n        </header>\n    </textarea> </div>';n.run(["$templateCache",function(e){e.put("global-all.html",o)}]),e.exports=o},function(e,t,n){var i,r;!function(o,a){function s(){function e(t){var n;return n=a(t,"amd"),n.fork=e,n}return e(o)}[].indexOf||(Array.prototype.indexOf=function(e,t,n){for(n=this.length,t=(n+~~t)%n;n>t&&(!(t in this)||this[t]!==e);t++);return t^n?t:-1}),i=s,r="function"==typeof i?i.call(t,n,t,e):i,!(void 0!==r&&(e.exports=r))}(this,function(e,t){function n(){e.addEventListener?(e.document.addEventListener("keydown",o,!1),e.document.addEventListener("keyup",a,!1),e.addEventListener("blur",r,!1),e.addEventListener("webkitfullscreenchange",r,!1),e.addEventListener("mozfullscreenchange",r,!1)):e.attachEvent&&(e.document.attachEvent("onkeydown",o),e.document.attachEvent("onkeyup",a),e.attachEvent("onblur",r))}function i(){r(),e.removeEventListener?(e.document.removeEventListener("keydown",o,!1),e.document.removeEventListener("keyup",a,!1),e.removeEventListener("blur",r,!1),e.removeEventListener("webkitfullscreenchange",r,!1),e.removeEventListener("mozfullscreenchange",r,!1)):e.detachEvent&&(e.document.detachEvent("onkeydown",o),e.document.detachEvent("onkeyup",a),e.detachEvent("onblur",r))}function r(e){P=[],p(),v(e)}function o(e){var t,n,i;if(t=s(e.keyCode),!(t.length<1)){for(e.isRepeat=!1,i=0;i<t.length;i+=1)n=t[i],-1!=_().indexOf(n)&&(e.isRepeat=!0),C(n);u(),g(e)}}function a(e){var t,n;if(t=s(e.keyCode),!(t.length<1)){for(n=0;n<t.length;n+=1)T(t[n]);p(),v(e)}}function s(e){return S[e]||[]}function l(e){var t;for(t in S)if(S.hasOwnProperty(t)&&S[t].indexOf(e)>-1)return t;return!1}function c(e,t){if("string"!=typeof e&&("object"!=typeof e||"function"!=typeof e.push))throw new Error("Cannot create macro. The combo must be a string or array.");if("object"!=typeof t||"function"!=typeof t.push)throw new Error("Cannot create macro. The injectedKeys must be an array.");M.push([e,t])}function d(e){var t;if("string"!=typeof e&&("object"!=typeof e||"function"!=typeof e.push))throw new Error("Cannot remove macro. The combo must be a string or array.");for(mI=0;mI<M.length;mI+=1)if(t=M[mI],b(e,t[0])){T(t[1]),M.splice(mI,1);break}}function u(){var e,t,n;for(e=0;e<M.length;e+=1)if(t=x(M[e][0]),-1===L.indexOf(M[e])&&y(t))for(L.push(M[e]),n=0;n<M[e][1].length;n+=1)C(M[e][1][n])}function p(){var e,t,n;for(e=0;e<L.length;e+=1)if(t=x(L[e][0]),y(t)===!1){for(n=0;n<L[e][1].length;n+=1)T(L[e][1][n]);L.splice(e,1),e-=1}}function h(e,t,n){function i(){var e;for(e=0;e<c.length;e+=1)R.splice(R.indexOf(c[e]),1)}function r(e){function t(){var t,i;for(t=0;t<n.length;t+=1)if("function"==typeof n[t])if("keyup"===e)for(i=0;i<c.length;i+=1)c[i].keyUpCallback.splice(c[i].keyUpCallback.indexOf(n[t]),1);else for(i=0;i<c.length;i+=1)c[i].keyDownCallback.splice(c[i].keyDownCallback.indexOf(n[t]),1)}var n,i,r,o={};if("string"!=typeof e)throw new Error("Cannot bind callback. The event name must be a string.");if("keyup"!==e&&"keydown"!==e)throw new Error('Cannot bind callback. The event name must be a "keyup" or "keydown".');for(n=Array.prototype.slice.apply(arguments,[1]),i=0;i<n.length;i+=1)if("function"==typeof n[i])if("keyup"===e)for(r=0;r<c.length;r+=1)c[r].keyUpCallback.push(n[i]);else if("keydown"===e)for(r=0;r<c.length;r+=1)c[r].keyDownCallback.push(n[i]);return o.clear=t,o}var o,a,s,l={},c=[];for("string"==typeof e&&(e=x(e)),a=0;a<e.length;a+=1){if(o={},s=k([e[a]]),"string"!=typeof s)throw new Error("Failed to bind key combo. The key combo must be string.");o.keyCombo=s,o.keyDownCallback=[],o.keyUpCallback=[],t&&o.keyDownCallback.push(t),n&&o.keyUpCallback.push(n),R.push(o),c.push(o)}return l.clear=i,l.on=r,l}function m(e){var t,n;for(t=0;t<R.length;t+=1)n=R[t],b(e,n.keyCombo)&&(R.splice(t,1),t-=1)}function f(e){var t,n,i;if(e){for(t=0;t<R.length;t+=1)for(i=R[t],n=0;n<i.keyCombo.length;n+=1)if(i.keyCombo[n].indexOf(e)>-1){R.splice(t,1),t-=1;break}}else R=[]}function g(e){var t,n,i,r,o,a,s,l,c,d,u,p=[];for(o=[].concat(P),t=0;t<R.length;t+=1)u=w(R[t].keyCombo).length,p[u]||(p[u]=[]),p[u].push(R[t]);for(n=p.length-1;n>=0;n-=1)if(p[n])for(t=0;t<p[n].length;t+=1){for(i=p[n][t],r=w(i.keyCombo),c=!0,l=0;l<r.length;l+=1)if(-1===o.indexOf(r[l])){c=!1;break}if(c&&y(i.keyCombo)){for(B.push(i),l=0;l<r.length;l+=1)d=o.indexOf(r[l]),d>-1&&(o.splice(d,1),l-=1);for(a=0;a<i.keyDownCallback.length;a+=1)i.keyDownCallback[a](e,_(),i.keyCombo)===!1&&(s=!0);s===!0&&(e.preventDefault(),e.stopPropagation())}}}function v(e){var t,n,i,r;for(t=0;t<B.length;t+=1)if(i=B[t],y(i.keyCombo)===!1){for(n=0;n<i.keyUpCallback.length;n+=1)i.keyUpCallback[n](e,_(),i.keyCombo)===!1&&(r=!0);r===!0&&(e.preventDefault(),e.stopPropagation()),B.splice(t,1),t-=1}}function b(e,t){var n,i,r;if(e=x(e),t=x(t),e.length!==t.length)return!1;for(n=0;n<e.length;n+=1){if(e[n].length!==t[n].length)return!1;for(i=0;i<e[n].length;i+=1){if(e[n][i].length!==t[n][i].length)return!1;for(r=0;r<e[n][i].length;r+=1)if(-1===t[n][i].indexOf(e[n][i][r]))return!1}}return!0}function y(e){var t,n,i,r,o,a,s=0;for(e=x(e),t=0;t<e.length;t+=1){for(a=!0,s=0,n=0;n<e[t].length;n+=1){for(i=[].concat(e[t][n]),r=s;r<P.length;r+=1)o=i.indexOf(P[r]),o>-1&&(i.splice(o,1),s=r);if(0!==i.length){a=!1;break}}if(a)return!0}return!1}function w(e){var t,n,i=[];for(e=x(e),t=0;t<e.length;t+=1)for(n=0;n<e[t].length;n+=1)i=i.concat(e[t][n]);return i}function x(e){var t=e,n=0,i=0,r=!1,o=!1,a=[],s=[],l=[],c="";if("object"==typeof e&&"function"==typeof e.push)return e;if("string"!=typeof e)throw new Error('Cannot parse "keyCombo" because its type is "'+typeof e+'". It must be a "string".');for(;" "===t.charAt(n);)n+=1;for(;;){if(" "===t.charAt(n)){for(;" "===t.charAt(n);)n+=1;r=!0}else if(","===t.charAt(n)){if(i||o)throw new Error("Failed to parse key combo. Unexpected , at character index "+n+".");o=!0,n+=1}else if("+"===t.charAt(n)){if(c.length&&(l.push(c),c=""),i||o)throw new Error("Failed to parse key combo. Unexpected + at character index "+n+".");i=!0,n+=1}else if(">"===t.charAt(n)){if(c.length&&(l.push(c),c=""),l.length&&(s.push(l),l=[]),i||o)throw new Error("Failed to parse key combo. Unexpected > at character index "+n+".");i=!0,n+=1}else if(n<t.length-1&&"!"===t.charAt(n)&&(">"===t.charAt(n+1)||","===t.charAt(n+1)||"+"===t.charAt(n+1)))c+=t.charAt(n+1),i=!1,r=!1,o=!1,n+=2;else{if(!(n<t.length&&"+"!==t.charAt(n)&&">"!==t.charAt(n)&&","!==t.charAt(n)&&" "!==t.charAt(n))){n+=1;continue}for((i===!1&&r===!0||o===!0)&&(c.length&&(l.push(c),c=""),l.length&&(s.push(l),l=[]),s.length&&(a.push(s),s=[])),i=!1,r=!1,o=!1;n<t.length&&"+"!==t.charAt(n)&&">"!==t.charAt(n)&&","!==t.charAt(n)&&" "!==t.charAt(n);)c+=t.charAt(n),n+=1}if(n>=t.length){c.length&&(l.push(c),c=""),l.length&&(s.push(l),l=[]),s.length&&(a.push(s),s=[]);break}}return a}function k(e){var t,n,i=[];if("string"==typeof e)return e;if("object"!=typeof e||"function"!=typeof e.push)throw new Error("Cannot stringify key combo.");for(t=0;t<e.length;t+=1){for(i[t]=[],n=0;n<e[t].length;n+=1)i[t][n]=e[t][n].join(" + ");i[t]=i[t].join(" > ")}return i.join(" ")}function _(){return[].concat(P)}function C(e){if(e.match(/\s/))throw new Error("Cannot add key name "+e+" to active keys because it contains whitespace.");P.indexOf(e)>-1||P.push(e)}function T(e){var t=l(e);"91"===t||"92"===t?P=[]:P.splice(P.indexOf(e),1)}function j(e,t){if("string"!=typeof e)throw new Error("Cannot register new locale. The locale name must be a string.");if("object"!=typeof t)throw new Error("Cannot register "+e+" locale. The locale map must be an object.");if("object"!=typeof t.map)throw new Error("Cannot register "+e+" locale. The locale map is invalid.");t.macros||(t.macros=[]),I[e]=t}function A(e){if(e){if("string"!=typeof e)throw new Error("Cannot set locale. The locale name must be a string.");if(!I[e])throw new Error("Cannot set locale to "+e+" because it does not exist. If you would like to submit a "+e+" locale map for KeyboardJS please submit it at https://github.com/RobertWHurst/KeyboardJS/issues.");S=I[e].map,M=I[e].macros,$=e}return $}var $,S,M,N,E,D={},I={},P=[],R=[],B=[],L=[];for(e=e||window,E={map:{3:["cancel"],8:["backspace"],9:["tab"],12:["clear"],13:["enter"],16:["shift"],17:["ctrl"],18:["alt","menu"],19:["pause","break"],20:["capslock"],27:["escape","esc"],32:["space","spacebar"],33:["pageup"],34:["pagedown"],35:["end"],36:["home"],37:["left"],38:["up"],39:["right"],40:["down"],41:["select"],42:["printscreen"],43:["execute"],44:["snapshot"],45:["insert","ins"],46:["delete","del"],47:["help"],91:["command","windows","win","super","leftcommand","leftwindows","leftwin","leftsuper"],92:["command","windows","win","super","rightcommand","rightwindows","rightwin","rightsuper"],145:["scrolllock","scroll"],186:["semicolon",";"],187:["equal","equalsign","="],188:["comma",","],189:["dash","-"],190:["period","."],191:["slash","forwardslash","/"],192:["graveaccent","`"],219:["openbracket","["],220:["backslash","\\"],221:["closebracket","]"],222:["apostrophe","'"],48:["zero","0"],49:["one","1"],50:["two","2"],51:["three","3"],52:["four","4"],53:["five","5"],54:["six","6"],55:["seven","7"],56:["eight","8"],57:["nine","9"],96:["numzero","num0"],97:["numone","num1"],98:["numtwo","num2"],99:["numthree","num3"],100:["numfour","num4"],101:["numfive","num5"],102:["numsix","num6"],103:["numseven","num7"],104:["numeight","num8"],105:["numnine","num9"],106:["nummultiply","num*"],107:["numadd","num+"],108:["numenter"],109:["numsubtract","num-"],110:["numdecimal","num."],111:["numdivide","num/"],144:["numlock","num"],112:["f1"],113:["f2"],114:["f3"],115:["f4"],116:["f5"],117:["f6"],118:["f7"],119:["f8"],120:["f9"],121:["f10"],122:["f11"],123:["f12"]},macros:[["shift + `",["tilde","~"]],["shift + 1",["exclamation","exclamationpoint","!"]],["shift + 2",["at","@"]],["shift + 3",["number","#"]],["shift + 4",["dollar","dollars","dollarsign","$"]],["shift + 5",["percent","%"]],["shift + 6",["caret","^"]],["shift + 7",["ampersand","and","&"]],["shift + 8",["asterisk","*"]],["shift + 9",["openparen","("]],["shift + 0",["closeparen",")"]],["shift + -",["underscore","_"]],["shift + =",["plus","+"]],["shift + (",["opencurlybrace","opencurlybracket","{"]],["shift + )",["closecurlybrace","closecurlybracket","}"]],["shift + \\",["verticalbar","|"]],["shift + ;",["colon",":"]],["shift + '",["quotationmark",'"']],["shift + !,",["openanglebracket","<"]],["shift + .",["closeanglebracket",">"]],["shift + /",["questionmark","?"]]]},N=65;90>=N;N+=1)E.map[N]=String.fromCharCode(N+32),E.macros.push(["shift + "+String.fromCharCode(N+32)+", capslock + "+String.fromCharCode(N+32),[String.fromCharCode(N)]]);return j("us",E),A("us"),n(),D.enable=n,D.disable=i,D.activeKeys=_,D.on=h,D.clear=m,D.clear.key=f,D.locale=A,D.locale.register=j,D.macro=c,D.macro.remove=d,D.key={},D.key.name=s,D.key.code=l,D.combo={},D.combo.active=y,D.combo.parse=x,D.combo.stringify=k,D})},function(e,t,n){(function(e,t){var i=(n(33),[].slice),r=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};!function(e){var t;return t=function(){function t(t,n){var i;i={navExpr:'[data-field="nav"]',panelExpr:'[data-field="content"]',eventName:"click",activeClass:"active",activePanel:null},this.options=e.extend(i,n),this.initElements(t),this.initSelected()}return t.prototype.initElements=function(t){var n,i,r;return r=this,i=this.options,n=this.elements={menus:t.find(i.navExpr),panels:t.find(i.panelExpr)},n.menus.children().bind(i.eventName,function(){var t,n;return t=e(this),n=t.attr("data-value")||t.index(),r.change(n)})},t.prototype.initSelected=function(){var e,t;return this.options.activePanel?this.change(this.options.activePanel):(t=this.elements,e=t.menus.find(">."+this.options.activeClass),0===e.length&&(e=t.menus.eq(0)),this.change(e.index()))},t.prototype.change=function(e){var t,n,i,r,o;return r=this.options.activeClass,t=this.elements,o="number"==typeof e,n=o?">:eq("+e+")":">[data-value='"+e+"']",t.menus.find(">."+r).removeClass(r),i=t.menus.find(n).addClass(r).index(),t.panels.find(">*").hide(),t.panels.find(n).show()},t}(),t.publicMethods=["change"],e.fn.simpleTab=function(){var e,n,o,a;return e=arguments[0],n=2<=arguments.length?i.call(arguments,1):[],a="honey.tab","string"==typeof e&&r.call(t.publicMethods,e)>=0?(o=this.data(a),o&&o[e]?o[e].apply(o,n):console.log("Plugin or Method not defined.")):(o=new t(this,e),this.data(a,o),this)}}(e||t||window.jquery)}).call(t,n(33),n(33))},function(e,t,n){(function(e){!function(e){function t(t){var n=e(t),i=n.add(n.parents()),r=!1;return i.each(function(){return"fixed"===e(this).css("position")?(r=!0,!1):void 0}),r}function n(){return new Date(Date.UTC.apply(Date,arguments))}var i=function(t,n){var i=this;this.element=e(t),this.container=n.container||"body",this.language=n.language||this.element.data("date-language")||"en",this.language=this.language in o?this.language:"en",this.isRTL=o[this.language].rtl||!1,this.formatType=n.formatType||this.element.data("format-type")||"standard",this.format=a.parseFormat(n.format||this.element.data("date-format")||o[this.language].format||a.getDefaultFormat(this.formatType,"input"),this.formatType),this.isInline=!1,this.isVisible=!1,this.isInput=this.element.is("input"),this.fontAwesome=n.fontAwesome||this.element.data("font-awesome")||!1,this.bootcssVer=n.bootcssVer||(this.isInput?this.element.is(".form-control")?3:2:this.bootcssVer=this.element.is(".input-group")?3:2),this.component=this.element.is(".date")?3==this.bootcssVer?this.element.find(".input-group-addon .glyphicon-th, .input-group-addon .glyphicon-time, .input-group-addon .glyphicon-calendar, .input-group-addon .glyphicon-calendar, .input-group-addon .fa-calendar, .input-group-addon .fa-clock-o").parent():this.element.find(".add-on .icon-th, .add-on .icon-time, .add-on .icon-calendar .fa-calendar .fa-clock-o").parent():!1,this.componentReset=this.element.is(".date")?3==this.bootcssVer?this.element.find(".input-group-addon .glyphicon-remove, .input-group-addon .fa-times").parent():this.element.find(".add-on .icon-remove, .add-on .fa-times").parent():!1,this.hasInput=this.component&&this.element.find("input").length,this.component&&0===this.component.length&&(this.component=!1),this.linkField=n.linkField||this.element.data("link-field")||!1,this.linkFormat=a.parseFormat(n.linkFormat||this.element.data("link-format")||a.getDefaultFormat(this.formatType,"link"),this.formatType),this.minuteStep=n.minuteStep||this.element.data("minute-step")||5,this.pickerPosition=n.pickerPosition||this.element.data("picker-position")||"bottom-right",this.showMeridian=n.showMeridian||this.element.data("show-meridian")||!1,this.initialDate=n.initialDate||new Date,this.zIndex=n.zIndex||this.element.data("z-index")||void 0,this.icons={leftArrow:this.fontAwesome?"fa-arrow-left":3===this.bootcssVer?"glyphicon-arrow-left":"icon-arrow-left",rightArrow:this.fontAwesome?"fa-arrow-right":3===this.bootcssVer?"glyphicon-arrow-right":"icon-arrow-right"},this.icontype=this.fontAwesome?"fa":"glyphicon",this._attachEvents(),this.formatViewType="datetime","formatViewType"in n?this.formatViewType=n.formatViewType:"formatViewType"in this.element.data()&&(this.formatViewType=this.element.data("formatViewType")),this.minView=0,"minView"in n?this.minView=n.minView:"minView"in this.element.data()&&(this.minView=this.element.data("min-view")),this.minView=a.convertViewMode(this.minView),this.maxView=a.modes.length-1,"maxView"in n?this.maxView=n.maxView:"maxView"in this.element.data()&&(this.maxView=this.element.data("max-view")),this.maxView=a.convertViewMode(this.maxView),this.wheelViewModeNavigation=!1,"wheelViewModeNavigation"in n?this.wheelViewModeNavigation=n.wheelViewModeNavigation:"wheelViewModeNavigation"in this.element.data()&&(this.wheelViewModeNavigation=this.element.data("view-mode-wheel-navigation")),this.wheelViewModeNavigationInverseDirection=!1,"wheelViewModeNavigationInverseDirection"in n?this.wheelViewModeNavigationInverseDirection=n.wheelViewModeNavigationInverseDirection:"wheelViewModeNavigationInverseDirection"in this.element.data()&&(this.wheelViewModeNavigationInverseDirection=this.element.data("view-mode-wheel-navigation-inverse-dir")),this.wheelViewModeNavigationDelay=100,"wheelViewModeNavigationDelay"in n?this.wheelViewModeNavigationDelay=n.wheelViewModeNavigationDelay:"wheelViewModeNavigationDelay"in this.element.data()&&(this.wheelViewModeNavigationDelay=this.element.data("view-mode-wheel-navigation-delay")),this.startViewMode=2,"startView"in n?this.startViewMode=n.startView:"startView"in this.element.data()&&(this.startViewMode=this.element.data("start-view")),this.startViewMode=a.convertViewMode(this.startViewMode),this.viewMode=this.startViewMode,this.viewSelect=this.minView,"viewSelect"in n?this.viewSelect=n.viewSelect:"viewSelect"in this.element.data()&&(this.viewSelect=this.element.data("view-select")),this.viewSelect=a.convertViewMode(this.viewSelect),this.forceParse=!0,"forceParse"in n?this.forceParse=n.forceParse:"dateForceParse"in this.element.data()&&(this.forceParse=this.element.data("date-force-parse"));for(var r=3===this.bootcssVer?a.templateV3:a.template;-1!==r.indexOf("{iconType}");)r=r.replace("{iconType}",this.icontype);for(;-1!==r.indexOf("{leftArrow}");)r=r.replace("{leftArrow}",this.icons.leftArrow);for(;-1!==r.indexOf("{rightArrow}");)r=r.replace("{rightArrow}",this.icons.rightArrow);
if(this.picker=e(r).appendTo(this.isInline?this.element:this.container).on({click:e.proxy(this.click,this),mousedown:e.proxy(this.mousedown,this)}),this.wheelViewModeNavigation&&(e.fn.mousewheel?this.picker.on({mousewheel:e.proxy(this.mousewheel,this)}):console.log("Mouse Wheel event is not supported. Please include the jQuery Mouse Wheel plugin before enabling this option")),this.isInline?this.picker.addClass("datetimepicker-inline"):this.picker.addClass("datetimepicker-dropdown-"+this.pickerPosition+" dropdown-menu"),this.isRTL){this.picker.addClass("datetimepicker-rtl");var s=3===this.bootcssVer?".prev span, .next span":".prev i, .next i";this.picker.find(s).toggleClass(this.icons.leftArrow+" "+this.icons.rightArrow)}e(document).on("mousedown",function(t){0===e(t.target).closest(".datetimepicker").length&&i.hide()}),this.autoclose=!1,"autoclose"in n?this.autoclose=n.autoclose:"dateAutoclose"in this.element.data()&&(this.autoclose=this.element.data("date-autoclose")),this.keyboardNavigation=!0,"keyboardNavigation"in n?this.keyboardNavigation=n.keyboardNavigation:"dateKeyboardNavigation"in this.element.data()&&(this.keyboardNavigation=this.element.data("date-keyboard-navigation")),this.todayBtn=n.todayBtn||this.element.data("date-today-btn")||!1,this.todayHighlight=n.todayHighlight||this.element.data("date-today-highlight")||!1,this.weekStart=(n.weekStart||this.element.data("date-weekstart")||o[this.language].weekStart||0)%7,this.weekEnd=(this.weekStart+6)%7,this.startDate=-(1/0),this.endDate=1/0,this.daysOfWeekDisabled=[],this.setStartDate(n.startDate||this.element.data("date-startdate")),this.setEndDate(n.endDate||this.element.data("date-enddate")),this.setDaysOfWeekDisabled(n.daysOfWeekDisabled||this.element.data("date-days-of-week-disabled")),this.setMinutesDisabled(n.minutesDisabled||this.element.data("date-minute-disabled")),this.setHoursDisabled(n.hoursDisabled||this.element.data("date-hour-disabled")),this.fillDow(),this.fillMonths(),this.update(),this.showMode(),this.isInline&&this.show()};i.prototype={constructor:i,_events:[],_attachEvents:function(){this._detachEvents(),this.isInput?this._events=[[this.element,{focus:e.proxy(this.show,this),keyup:e.proxy(this.update,this),keydown:e.proxy(this.keydown,this)}]]:this.component&&this.hasInput?(this._events=[[this.element.find("input"),{focus:e.proxy(this.show,this),keyup:e.proxy(this.update,this),keydown:e.proxy(this.keydown,this)}],[this.component,{click:e.proxy(this.show,this)}]],this.componentReset&&this._events.push([this.componentReset,{click:e.proxy(this.reset,this)}])):this.element.is("div")?this.isInline=!0:this._events=[[this.element,{click:e.proxy(this.show,this)}]];for(var t,n,i=0;i<this._events.length;i++)t=this._events[i][0],n=this._events[i][1],t.on(n)},_detachEvents:function(){for(var e,t,n=0;n<this._events.length;n++)e=this._events[n][0],t=this._events[n][1],e.off(t);this._events=[]},show:function(t){this.picker.show(),this.height=this.component?this.component.outerHeight():this.element.outerHeight(),this.forceParse&&this.update(),this.place(),e(window).on("resize",e.proxy(this.place,this)),t&&(t.stopPropagation(),t.preventDefault()),this.isVisible=!0,this.element.trigger({type:"show",date:this.date})},hide:function(t){this.isVisible&&(this.isInline||(this.picker.hide(),e(window).off("resize",this.place),this.viewMode=this.startViewMode,this.showMode(),this.isInput||e(document).off("mousedown",this.hide),this.forceParse&&(this.isInput&&this.element.val()||this.hasInput&&this.element.find("input").val())&&this.setValue(),this.isVisible=!1,this.element.trigger({type:"hide",date:this.date})))},remove:function(){this._detachEvents(),this.picker.remove(),delete this.picker,delete this.element.data().datetimepicker},getDate:function(){var e=this.getUTCDate();return new Date(e.getTime()+6e4*e.getTimezoneOffset())},getUTCDate:function(){return this.date},setDate:function(e){this.setUTCDate(new Date(e.getTime()-6e4*e.getTimezoneOffset()))},setUTCDate:function(e){e>=this.startDate&&e<=this.endDate?(this.date=e,this.setValue(),this.viewDate=this.date,this.fill()):this.element.trigger({type:"outOfRange",date:e,startDate:this.startDate,endDate:this.endDate})},setFormat:function(e){this.format=a.parseFormat(e,this.formatType);var t;this.isInput?t=this.element:this.component&&(t=this.element.find("input")),t&&t.val()&&this.setValue()},setValue:function(){var t=this.getFormattedDate();this.isInput?this.element.val(t):(this.component&&this.element.find("input").val(t),this.element.data("date",t)),this.linkField&&e("#"+this.linkField).val(this.getFormattedDate(this.linkFormat))},getFormattedDate:function(e){return void 0==e&&(e=this.format),a.formatDate(this.date,e,this.language,this.formatType)},setStartDate:function(e){this.startDate=e||-(1/0),this.startDate!==-(1/0)&&(this.startDate=a.parseDate(this.startDate,this.format,this.language,this.formatType)),this.update(),this.updateNavArrows()},setEndDate:function(e){this.endDate=e||1/0,this.endDate!==1/0&&(this.endDate=a.parseDate(this.endDate,this.format,this.language,this.formatType)),this.update(),this.updateNavArrows()},setDaysOfWeekDisabled:function(t){this.daysOfWeekDisabled=t||[],e.isArray(this.daysOfWeekDisabled)||(this.daysOfWeekDisabled=this.daysOfWeekDisabled.split(/,\s*/)),this.daysOfWeekDisabled=e.map(this.daysOfWeekDisabled,function(e){return parseInt(e,10)}),this.update(),this.updateNavArrows()},setMinutesDisabled:function(t){this.minutesDisabled=t||[],e.isArray(this.minutesDisabled)||(this.minutesDisabled=this.minutesDisabled.split(/,\s*/)),this.minutesDisabled=e.map(this.minutesDisabled,function(e){return parseInt(e,10)}),this.update(),this.updateNavArrows()},setHoursDisabled:function(t){this.hoursDisabled=t||[],e.isArray(this.hoursDisabled)||(this.hoursDisabled=this.hoursDisabled.split(/,\s*/)),this.hoursDisabled=e.map(this.hoursDisabled,function(e){return parseInt(e,10)}),this.update(),this.updateNavArrows()},place:function(){if(!this.isInline){if(!this.zIndex){var n=0;e("div").each(function(){var t=parseInt(e(this).css("zIndex"),10);t>n&&(n=t)}),this.zIndex=n+10}var i,r,o,a;a=this.container instanceof e?this.container.offset():e(this.container).offset(),this.component?(i=this.component.offset(),o=i.left,"bottom-left"!=this.pickerPosition&&"top-left"!=this.pickerPosition||(o+=this.component.outerWidth()-this.picker.outerWidth())):(i=this.element.offset(),o=i.left),o+220>document.body.clientWidth&&(o=document.body.clientWidth-220),r="top-left"==this.pickerPosition||"top-right"==this.pickerPosition?i.top-this.picker.outerHeight():i.top+this.height,r-=a.top,o-=a.left,t(this.element)||(r+=document.body.scrollTop),this.picker.css({top:r,left:o,zIndex:this.zIndex})}},update:function(){var e,t=!1;arguments&&arguments.length&&("string"==typeof arguments[0]||arguments[0]instanceof Date)?(e=arguments[0],t=!0):(e=(this.isInput?this.element.val():this.element.find("input").val())||this.element.data("date")||this.initialDate,("string"==typeof e||e instanceof String)&&(e=e.replace(/^\s+|\s+$/g,""))),e||(e=new Date,t=!1),this.date=a.parseDate(e,this.format,this.language,this.formatType),t&&this.setValue(),this.date<this.startDate?this.viewDate=new Date(this.startDate):this.date>this.endDate?this.viewDate=new Date(this.endDate):this.viewDate=new Date(this.date),this.fill()},fillDow:function(){for(var e=this.weekStart,t="<tr>";e<this.weekStart+7;)t+='<th class="dow">'+o[this.language].daysMin[e++%7]+"</th>";t+="</tr>",this.picker.find(".datetimepicker-days thead").append(t)},fillMonths:function(){for(var e="",t=0;12>t;)e+='<span class="month">'+o[this.language].monthsShort[t++]+"</span>";this.picker.find(".datetimepicker-months td").html(e)},fill:function(){if(null!=this.date&&null!=this.viewDate){var t=new Date(this.viewDate),i=t.getUTCFullYear(),r=t.getUTCMonth(),s=t.getUTCDate(),l=t.getUTCHours(),c=t.getUTCMinutes(),d=this.startDate!==-(1/0)?this.startDate.getUTCFullYear():-(1/0),u=this.startDate!==-(1/0)?this.startDate.getUTCMonth()+1:-(1/0),p=this.endDate!==1/0?this.endDate.getUTCFullYear():1/0,h=this.endDate!==1/0?this.endDate.getUTCMonth()+1:1/0,m=new n(this.date.getUTCFullYear(),this.date.getUTCMonth(),this.date.getUTCDate()).valueOf(),f=new Date;if(this.picker.find(".datetimepicker-days thead th:eq(1)").text(o[this.language].months[r]+" "+i),"time"==this.formatViewType){var g=this.getFormattedDate();this.picker.find(".datetimepicker-hours thead th:eq(1)").text(g),this.picker.find(".datetimepicker-minutes thead th:eq(1)").text(g)}else this.picker.find(".datetimepicker-hours thead th:eq(1)").text(s+" "+o[this.language].months[r]+" "+i),this.picker.find(".datetimepicker-minutes thead th:eq(1)").text(s+" "+o[this.language].months[r]+" "+i);this.picker.find("tfoot th.today").text(o[this.language].today).toggle(this.todayBtn!==!1),this.updateNavArrows(),this.fillMonths();var v=n(i,r-1,28,0,0,0,0),b=a.getDaysInMonth(v.getUTCFullYear(),v.getUTCMonth());v.setUTCDate(b),v.setUTCDate(b-(v.getUTCDay()-this.weekStart+7)%7);var y=new Date(v);y.setUTCDate(y.getUTCDate()+42),y=y.valueOf();for(var w,x=[];v.valueOf()<y;)v.getUTCDay()==this.weekStart&&x.push("<tr>"),w="",v.getUTCFullYear()<i||v.getUTCFullYear()==i&&v.getUTCMonth()<r?w+=" old":(v.getUTCFullYear()>i||v.getUTCFullYear()==i&&v.getUTCMonth()>r)&&(w+=" new"),this.todayHighlight&&v.getUTCFullYear()==f.getFullYear()&&v.getUTCMonth()==f.getMonth()&&v.getUTCDate()==f.getDate()&&(w+=" today"),v.valueOf()==m&&(w+=" active"),(v.valueOf()+864e5<=this.startDate||v.valueOf()>this.endDate||-1!==e.inArray(v.getUTCDay(),this.daysOfWeekDisabled))&&(w+=" disabled"),x.push('<td class="day'+w+'">'+v.getUTCDate()+"</td>"),v.getUTCDay()==this.weekEnd&&x.push("</tr>"),v.setUTCDate(v.getUTCDate()+1);this.picker.find(".datetimepicker-days tbody").empty().append(x.join("")),x=[];for(var k="",_="",C="",T=this.hoursDisabled||[],j=0;24>j;j++)if(-1===T.indexOf(j)){var A=n(i,r,s,j);w="",A.valueOf()+36e5<=this.startDate||A.valueOf()>this.endDate?w+=" disabled":l==j&&(w+=" active"),this.showMeridian&&2==o[this.language].meridiem.length?(_=12>j?o[this.language].meridiem[0]:o[this.language].meridiem[1],_!=C&&(""!=C&&x.push("</fieldset>"),x.push('<fieldset class="hour"><legend>'+_.toUpperCase()+"</legend>")),C=_,k=j%12?j%12:12,x.push('<span class="hour'+w+" hour_"+(12>j?"am":"pm")+'">'+k+"</span>"),23==j&&x.push("</fieldset>")):(k=j+":00",x.push('<span class="hour'+w+'">'+k+"</span>"))}this.picker.find(".datetimepicker-hours td").html(x.join("")),x=[],k="",_="",C="";for(var $=this.minutesDisabled||[],j=0;60>j;j+=this.minuteStep)if(-1===$.indexOf(j)){var A=n(i,r,s,l,j,0);w="",A.valueOf()<this.startDate||A.valueOf()>this.endDate?w+=" disabled":Math.floor(c/this.minuteStep)==Math.floor(j/this.minuteStep)&&(w+=" active"),this.showMeridian&&2==o[this.language].meridiem.length?(_=12>l?o[this.language].meridiem[0]:o[this.language].meridiem[1],_!=C&&(""!=C&&x.push("</fieldset>"),x.push('<fieldset class="minute"><legend>'+_.toUpperCase()+"</legend>")),C=_,k=l%12?l%12:12,x.push('<span class="minute'+w+'">'+k+":"+(10>j?"0"+j:j)+"</span>"),59==j&&x.push("</fieldset>")):(k=j+":00",x.push('<span class="minute'+w+'">'+l+":"+(10>j?"0"+j:j)+"</span>"))}this.picker.find(".datetimepicker-minutes td").html(x.join(""));var S=this.date.getUTCFullYear(),M=this.picker.find(".datetimepicker-months").find("th:eq(1)").text(i).end().find("span").removeClass("active");if(S==i){var N=M.length-12;M.eq(this.date.getUTCMonth()+N).addClass("active")}(d>i||i>p)&&M.addClass("disabled"),i==d&&M.slice(0,u+1).addClass("disabled"),i==p&&M.slice(h).addClass("disabled"),x="",i=10*parseInt(i/10,10);var E=this.picker.find(".datetimepicker-years").find("th:eq(1)").text(i+"-"+(i+9)).end().find("td");i-=1;for(var j=-1;11>j;j++)x+='<span class="year'+(-1==j||10==j?" old":"")+(S==i?" active":"")+(d>i||i>p?" disabled":"")+'">'+i+"</span>",i+=1;E.html(x),this.place()}},updateNavArrows:function(){var e=new Date(this.viewDate),t=e.getUTCFullYear(),n=e.getUTCMonth(),i=e.getUTCDate(),r=e.getUTCHours();switch(this.viewMode){case 0:this.startDate!==-(1/0)&&t<=this.startDate.getUTCFullYear()&&n<=this.startDate.getUTCMonth()&&i<=this.startDate.getUTCDate()&&r<=this.startDate.getUTCHours()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.endDate!==1/0&&t>=this.endDate.getUTCFullYear()&&n>=this.endDate.getUTCMonth()&&i>=this.endDate.getUTCDate()&&r>=this.endDate.getUTCHours()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"});break;case 1:this.startDate!==-(1/0)&&t<=this.startDate.getUTCFullYear()&&n<=this.startDate.getUTCMonth()&&i<=this.startDate.getUTCDate()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.endDate!==1/0&&t>=this.endDate.getUTCFullYear()&&n>=this.endDate.getUTCMonth()&&i>=this.endDate.getUTCDate()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"});break;case 2:this.startDate!==-(1/0)&&t<=this.startDate.getUTCFullYear()&&n<=this.startDate.getUTCMonth()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.endDate!==1/0&&t>=this.endDate.getUTCFullYear()&&n>=this.endDate.getUTCMonth()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"});break;case 3:case 4:this.startDate!==-(1/0)&&t<=this.startDate.getUTCFullYear()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.endDate!==1/0&&t>=this.endDate.getUTCFullYear()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"})}},mousewheel:function(t){if(t.preventDefault(),t.stopPropagation(),!this.wheelPause){this.wheelPause=!0;var n=t.originalEvent,i=n.wheelDelta,r=i>0?1:0===i?0:-1;this.wheelViewModeNavigationInverseDirection&&(r=-r),this.showMode(r),setTimeout(e.proxy(function(){this.wheelPause=!1},this),this.wheelViewModeNavigationDelay)}},click:function(t){t.stopPropagation(),t.preventDefault();var i=e(t.target).closest("span, td, th, legend");if(i.is("."+this.icontype)&&(i=e(i).parent().closest("span, td, th, legend")),1==i.length){if(i.is(".disabled"))return void this.element.trigger({type:"outOfRange",date:this.viewDate,startDate:this.startDate,endDate:this.endDate});switch(i[0].nodeName.toLowerCase()){case"th":switch(i[0].className){case"switch":this.showMode(1);break;case"prev":case"next":var r=a.modes[this.viewMode].navStep*("prev"==i[0].className?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveHour(this.viewDate,r);break;case 1:this.viewDate=this.moveDate(this.viewDate,r);break;case 2:this.viewDate=this.moveMonth(this.viewDate,r);break;case 3:case 4:this.viewDate=this.moveYear(this.viewDate,r)}this.fill(),this.element.trigger({type:i[0].className+":"+this.convertViewModeText(this.viewMode),date:this.viewDate,startDate:this.startDate,endDate:this.endDate});break;case"today":var o=new Date;o=n(o.getFullYear(),o.getMonth(),o.getDate(),o.getHours(),o.getMinutes(),o.getSeconds(),0),o<this.startDate?o=this.startDate:o>this.endDate&&(o=this.endDate),this.viewMode=this.startViewMode,this.showMode(0),this._setDate(o),this.fill(),this.autoclose&&this.hide()}break;case"span":if(!i.is(".disabled")){var s=this.viewDate.getUTCFullYear(),l=this.viewDate.getUTCMonth(),c=this.viewDate.getUTCDate(),d=this.viewDate.getUTCHours(),u=this.viewDate.getUTCMinutes(),p=this.viewDate.getUTCSeconds();if(i.is(".month")?(this.viewDate.setUTCDate(1),l=i.parent().find("span").index(i),c=this.viewDate.getUTCDate(),this.viewDate.setUTCMonth(l),this.element.trigger({type:"changeMonth",date:this.viewDate}),this.viewSelect>=3&&this._setDate(n(s,l,c,d,u,p,0))):i.is(".year")?(this.viewDate.setUTCDate(1),s=parseInt(i.text(),10)||0,this.viewDate.setUTCFullYear(s),this.element.trigger({type:"changeYear",date:this.viewDate}),this.viewSelect>=4&&this._setDate(n(s,l,c,d,u,p,0))):i.is(".hour")?(d=parseInt(i.text(),10)||0,(i.hasClass("hour_am")||i.hasClass("hour_pm"))&&(12==d&&i.hasClass("hour_am")?d=0:12!=d&&i.hasClass("hour_pm")&&(d+=12)),this.viewDate.setUTCHours(d),this.element.trigger({type:"changeHour",date:this.viewDate}),this.viewSelect>=1&&this._setDate(n(s,l,c,d,u,p,0))):i.is(".minute")&&(u=parseInt(i.text().substr(i.text().indexOf(":")+1),10)||0,this.viewDate.setUTCMinutes(u),this.element.trigger({type:"changeMinute",date:this.viewDate}),this.viewSelect>=0&&this._setDate(n(s,l,c,d,u,p,0))),0!=this.viewMode){var h=this.viewMode;this.showMode(-1),this.fill(),h==this.viewMode&&this.autoclose&&this.hide()}else this.fill(),this.autoclose&&this.hide()}break;case"td":if(i.is(".day")&&!i.is(".disabled")){var c=parseInt(i.text(),10)||1,s=this.viewDate.getUTCFullYear(),l=this.viewDate.getUTCMonth(),d=this.viewDate.getUTCHours(),u=this.viewDate.getUTCMinutes(),p=this.viewDate.getUTCSeconds();i.is(".old")?0===l?(l=11,s-=1):l-=1:i.is(".new")&&(11==l?(l=0,s+=1):l+=1),this.viewDate.setUTCFullYear(s),this.viewDate.setUTCMonth(l,c),this.element.trigger({type:"changeDay",date:this.viewDate}),this.viewSelect>=2&&this._setDate(n(s,l,c,d,u,p,0))}var h=this.viewMode;this.showMode(-1),this.fill(),h==this.viewMode&&this.autoclose&&this.hide()}}},_setDate:function(e,t){t&&"date"!=t||(this.date=e),t&&"view"!=t||(this.viewDate=e),this.fill(),this.setValue();var n;this.isInput?n=this.element:this.component&&(n=this.element.find("input")),n&&(n.change(),this.autoclose&&(!t||"date"==t)),this.element.trigger({type:"changeDate",date:this.date}),null==e&&(this.date=this.viewDate)},moveMinute:function(e,t){if(!t)return e;var n=new Date(e.valueOf());return n.setUTCMinutes(n.getUTCMinutes()+t*this.minuteStep),n},moveHour:function(e,t){if(!t)return e;var n=new Date(e.valueOf());return n.setUTCHours(n.getUTCHours()+t),n},moveDate:function(e,t){if(!t)return e;var n=new Date(e.valueOf());return n.setUTCDate(n.getUTCDate()+t),n},moveMonth:function(e,t){if(!t)return e;var n,i,r=new Date(e.valueOf()),o=r.getUTCDate(),a=r.getUTCMonth(),s=Math.abs(t);if(t=t>0?1:-1,1==s)i=-1==t?function(){return r.getUTCMonth()==a}:function(){return r.getUTCMonth()!=n},n=a+t,r.setUTCMonth(n),(0>n||n>11)&&(n=(n+12)%12);else{for(var l=0;s>l;l++)r=this.moveMonth(r,t);n=r.getUTCMonth(),r.setUTCDate(o),i=function(){return n!=r.getUTCMonth()}}for(;i();)r.setUTCDate(--o),r.setUTCMonth(n);return r},moveYear:function(e,t){return this.moveMonth(e,12*t)},dateWithinRange:function(e){return e>=this.startDate&&e<=this.endDate},keydown:function(e){if(this.picker.is(":not(:visible)"))return void(27==e.keyCode&&this.show());var t,n,i,r=!1;switch(e.keyCode){case 27:this.hide(),e.preventDefault();break;case 37:case 39:if(!this.keyboardNavigation)break;t=37==e.keyCode?-1:1,viewMode=this.viewMode,e.ctrlKey?viewMode+=2:e.shiftKey&&(viewMode+=1),4==viewMode?(n=this.moveYear(this.date,t),i=this.moveYear(this.viewDate,t)):3==viewMode?(n=this.moveMonth(this.date,t),i=this.moveMonth(this.viewDate,t)):2==viewMode?(n=this.moveDate(this.date,t),i=this.moveDate(this.viewDate,t)):1==viewMode?(n=this.moveHour(this.date,t),i=this.moveHour(this.viewDate,t)):0==viewMode&&(n=this.moveMinute(this.date,t),i=this.moveMinute(this.viewDate,t)),this.dateWithinRange(n)&&(this.date=n,this.viewDate=i,this.setValue(),this.update(),e.preventDefault(),r=!0);break;case 38:case 40:if(!this.keyboardNavigation)break;t=38==e.keyCode?-1:1,viewMode=this.viewMode,e.ctrlKey?viewMode+=2:e.shiftKey&&(viewMode+=1),4==viewMode?(n=this.moveYear(this.date,t),i=this.moveYear(this.viewDate,t)):3==viewMode?(n=this.moveMonth(this.date,t),i=this.moveMonth(this.viewDate,t)):2==viewMode?(n=this.moveDate(this.date,7*t),i=this.moveDate(this.viewDate,7*t)):1==viewMode?this.showMeridian?(n=this.moveHour(this.date,6*t),i=this.moveHour(this.viewDate,6*t)):(n=this.moveHour(this.date,4*t),i=this.moveHour(this.viewDate,4*t)):0==viewMode&&(n=this.moveMinute(this.date,4*t),i=this.moveMinute(this.viewDate,4*t)),this.dateWithinRange(n)&&(this.date=n,this.viewDate=i,this.setValue(),this.update(),e.preventDefault(),r=!0);break;case 13:if(0!=this.viewMode){var o=this.viewMode;this.showMode(-1),this.fill(),o==this.viewMode&&this.autoclose&&this.hide()}else this.fill(),this.autoclose&&this.hide();e.preventDefault();break;case 9:this.hide()}if(r){var a;this.isInput?a=this.element:this.component&&(a=this.element.find("input")),a&&a.change(),this.element.trigger({type:"changeDate",date:this.date})}},showMode:function(e){if(e){var t=Math.max(0,Math.min(a.modes.length-1,this.viewMode+e));t>=this.minView&&t<=this.maxView&&(this.element.trigger({type:"changeMode",date:this.viewDate,oldViewMode:this.viewMode,newViewMode:t}),this.viewMode=t)}this.picker.find(">div").hide().filter(".datetimepicker-"+a.modes[this.viewMode].clsName).css("display","block"),this.updateNavArrows()},reset:function(e){this._setDate(null,"date")},convertViewModeText:function(e){switch(e){case 4:return"decade";case 3:return"year";case 2:return"month";case 1:return"day";case 0:return"hour"}}};var r=e.fn.datetimepicker;e.fn.datetimepicker=function(t){var n=Array.apply(null,arguments);n.shift();var r;return this.each(function(){var o=e(this),a=o.data("datetimepicker"),s="object"==typeof t&&t;return a||o.data("datetimepicker",a=new i(this,e.extend({},e.fn.datetimepicker.defaults,s))),"string"==typeof t&&"function"==typeof a[t]&&(r=a[t].apply(a,n),void 0!==r)?!1:void 0}),void 0!==r?r:this},e.fn.datetimepicker.defaults={},e.fn.datetimepicker.Constructor=i;var o=e.fn.datetimepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],meridiem:["am","pm"],suffix:["st","nd","rd","th"],today:"Today"}},a={modes:[{clsName:"minutes",navFnc:"Hours",navStep:1},{clsName:"hours",navFnc:"Date",navStep:1},{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],isLeapYear:function(e){return e%4===0&&e%100!==0||e%400===0},getDaysInMonth:function(e,t){return[31,a.isLeapYear(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},getDefaultFormat:function(e,t){if("standard"==e)return"input"==t?"yyyy-mm-dd hh:ii":"yyyy-mm-dd hh:ii:ss";if("php"==e)return"input"==t?"Y-m-d H:i":"Y-m-d H:i:s";throw new Error("Invalid format type.")},validParts:function(e){if("standard"==e)return/hh?|HH?|p|P|ii?|ss?|dd?|DD?|mm?|MM?|yy(?:yy)?/g;if("php"==e)return/[dDjlNwzFmMnStyYaABgGhHis]/g;throw new Error("Invalid format type.")},nonpunctuation:/[^ -\/:-@\[-`{-~\t\n\rTZ]+/g,parseFormat:function(e,t){var n=e.replace(this.validParts(t),"\x00").split("\x00"),i=e.match(this.validParts(t));if(!n||!n.length||!i||0==i.length)throw new Error("Invalid date format.");return{separators:n,parts:i}},parseDate:function(t,r,a,s){if(t instanceof Date){var l=new Date(t.valueOf()-6e4*t.getTimezoneOffset());return l.setMilliseconds(0),l}if(/^\d{4}\-\d{1,2}\-\d{1,2}$/.test(t)&&(r=this.parseFormat("yyyy-mm-dd",s)),/^\d{4}\-\d{1,2}\-\d{1,2}[T ]\d{1,2}\:\d{1,2}$/.test(t)&&(r=this.parseFormat("yyyy-mm-dd hh:ii",s)),/^\d{4}\-\d{1,2}\-\d{1,2}[T ]\d{1,2}\:\d{1,2}\:\d{1,2}[Z]{0,1}$/.test(t)&&(r=this.parseFormat("yyyy-mm-dd hh:ii:ss",s)),/^[-+]\d+[dmwy]([\s,]+[-+]\d+[dmwy])*$/.test(t)){var c,d,u=/([-+]\d+)([dmwy])/,p=t.match(/([-+]\d+)([dmwy])/g);t=new Date;for(var h=0;h<p.length;h++)switch(c=u.exec(p[h]),d=parseInt(c[1]),c[2]){case"d":t.setUTCDate(t.getUTCDate()+d);break;case"m":t=i.prototype.moveMonth.call(i.prototype,t,d);break;case"w":t.setUTCDate(t.getUTCDate()+7*d);break;case"y":t=i.prototype.moveYear.call(i.prototype,t,d)}return n(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),0)}var m,f,c,p=t&&t.toString().match(this.nonpunctuation)||[],t=new Date(0,0,0,0,0,0,0),g={},v=["hh","h","ii","i","ss","s","yyyy","yy","M","MM","m","mm","D","DD","d","dd","H","HH","p","P"],b={hh:function(e,t){return e.setUTCHours(t)},h:function(e,t){return e.setUTCHours(t)},HH:function(e,t){return e.setUTCHours(12==t?0:t)},H:function(e,t){return e.setUTCHours(12==t?0:t)},ii:function(e,t){return e.setUTCMinutes(t)},i:function(e,t){return e.setUTCMinutes(t)},ss:function(e,t){return e.setUTCSeconds(t)},s:function(e,t){return e.setUTCSeconds(t)},yyyy:function(e,t){return e.setUTCFullYear(t)},yy:function(e,t){return e.setUTCFullYear(2e3+t)},m:function(e,t){for(t-=1;0>t;)t+=12;for(t%=12,e.setUTCMonth(t);e.getUTCMonth()!=t;){if(isNaN(e.getUTCMonth()))return e;e.setUTCDate(e.getUTCDate()-1)}return e},d:function(e,t){return e.setUTCDate(t)},p:function(e,t){return e.setUTCHours(1==t?e.getUTCHours()+12:e.getUTCHours())}};if(b.M=b.MM=b.mm=b.m,b.dd=b.d,b.P=b.p,t=n(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds()),p.length==r.parts.length){for(var h=0,y=r.parts.length;y>h;h++){if(m=parseInt(p[h],10),c=r.parts[h],isNaN(m))switch(c){case"MM":f=e(o[a].months).filter(function(){var e=this.slice(0,p[h].length),t=p[h].slice(0,e.length);return e==t}),m=e.inArray(f[0],o[a].months)+1;break;case"M":f=e(o[a].monthsShort).filter(function(){var e=this.slice(0,p[h].length),t=p[h].slice(0,e.length);return e.toLowerCase()==t.toLowerCase()}),m=e.inArray(f[0],o[a].monthsShort)+1;break;case"p":case"P":m=e.inArray(p[h].toLowerCase(),o[a].meridiem)}g[c]=m}for(var w,h=0;h<v.length;h++)w=v[h],w in g&&!isNaN(g[w])&&b[w](t,g[w])}return t},formatDate:function(t,n,i,r){if(null==t)return"";var s;if("standard"==r)s={yy:t.getUTCFullYear().toString().substring(2),yyyy:t.getUTCFullYear(),m:t.getUTCMonth()+1,M:o[i].monthsShort[t.getUTCMonth()],MM:o[i].months[t.getUTCMonth()],d:t.getUTCDate(),D:o[i].daysShort[t.getUTCDay()],DD:o[i].days[t.getUTCDay()],p:2==o[i].meridiem.length?o[i].meridiem[t.getUTCHours()<12?0:1]:"",h:t.getUTCHours(),i:t.getUTCMinutes(),s:t.getUTCSeconds()},2==o[i].meridiem.length?s.H=s.h%12==0?12:s.h%12:s.H=s.h,s.HH=(s.H<10?"0":"")+s.H,s.P=s.p.toUpperCase(),s.hh=(s.h<10?"0":"")+s.h,s.ii=(s.i<10?"0":"")+s.i,s.ss=(s.s<10?"0":"")+s.s,s.dd=(s.d<10?"0":"")+s.d,s.mm=(s.m<10?"0":"")+s.m;else{if("php"!=r)throw new Error("Invalid format type.");s={y:t.getUTCFullYear().toString().substring(2),Y:t.getUTCFullYear(),F:o[i].months[t.getUTCMonth()],M:o[i].monthsShort[t.getUTCMonth()],n:t.getUTCMonth()+1,t:a.getDaysInMonth(t.getUTCFullYear(),t.getUTCMonth()),j:t.getUTCDate(),l:o[i].days[t.getUTCDay()],D:o[i].daysShort[t.getUTCDay()],w:t.getUTCDay(),N:0==t.getUTCDay()?7:t.getUTCDay(),S:t.getUTCDate()%10<=o[i].suffix.length?o[i].suffix[t.getUTCDate()%10-1]:"",a:2==o[i].meridiem.length?o[i].meridiem[t.getUTCHours()<12?0:1]:"",g:t.getUTCHours()%12==0?12:t.getUTCHours()%12,G:t.getUTCHours(),i:t.getUTCMinutes(),s:t.getUTCSeconds()},s.m=(s.n<10?"0":"")+s.n,s.d=(s.j<10?"0":"")+s.j,s.A=s.a.toString().toUpperCase(),s.h=(s.g<10?"0":"")+s.g,s.H=(s.G<10?"0":"")+s.G,s.i=(s.i<10?"0":"")+s.i,s.s=(s.s<10?"0":"")+s.s}for(var t=[],l=e.extend([],n.separators),c=0,d=n.parts.length;d>c;c++)l.length&&t.push(l.shift()),t.push(s[n.parts[c]]);return l.length&&t.push(l.shift()),t.join("")},convertViewMode:function(e){switch(e){case 4:case"decade":e=4;break;case 3:case"year":e=3;break;case 2:case"month":e=2;break;case 1:case"day":e=1;break;case 0:case"hour":e=0}return e},headTemplate:'<thead><tr><th class="prev"><i class="{iconType} {leftArrow}"/></th><th colspan="5" class="switch"></th><th class="next"><i class="{iconType} {rightArrow}"/></th></tr></thead>',headTemplateV3:'<thead><tr><th class="prev"><span class="{iconType} {leftArrow}"></span> </th><th colspan="5" class="switch"></th><th class="next"><span class="{iconType} {rightArrow}"></span> </th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="today"></th></tr></tfoot>'};a.template='<div class="datetimepicker"><div class="datetimepicker-minutes"><table class=" table-condensed">'+a.headTemplate+a.contTemplate+a.footTemplate+'</table></div><div class="datetimepicker-hours"><table class=" table-condensed">'+a.headTemplate+a.contTemplate+a.footTemplate+'</table></div><div class="datetimepicker-days"><table class=" table-condensed">'+a.headTemplate+"<tbody></tbody>"+a.footTemplate+'</table></div><div class="datetimepicker-months"><table class="table-condensed">'+a.headTemplate+a.contTemplate+a.footTemplate+'</table></div><div class="datetimepicker-years"><table class="table-condensed">'+a.headTemplate+a.contTemplate+a.footTemplate+"</table></div></div>",a.templateV3='<div class="datetimepicker"><div class="datetimepicker-minutes"><table class=" table-condensed">'+a.headTemplateV3+a.contTemplate+a.footTemplate+'</table></div><div class="datetimepicker-hours"><table class=" table-condensed">'+a.headTemplateV3+a.contTemplate+a.footTemplate+'</table></div><div class="datetimepicker-days"><table class=" table-condensed">'+a.headTemplateV3+"<tbody></tbody>"+a.footTemplate+'</table></div><div class="datetimepicker-months"><table class="table-condensed">'+a.headTemplateV3+a.contTemplate+a.footTemplate+'</table></div><div class="datetimepicker-years"><table class="table-condensed">'+a.headTemplateV3+a.contTemplate+a.footTemplate+"</table></div></div>",e.fn.datetimepicker.DPGlobal=a,e.fn.datetimepicker.noConflict=function(){return e.fn.datetimepicker=r,this},e(document).on("focus.datetimepicker.data-api click.datetimepicker.data-api",'[data-provide="datetimepicker"]',function(t){var n=e(this);n.data("datetimepicker")||(t.preventDefault(),n.datetimepicker("show"))}),e(function(){e('[data-provide="datetimepicker-inline"]').datetimepicker()})}(e)}).call(t,n(33))},function(e,t,n){var i,r;(function(o){"use strict";i=[n(38),n(44),n(43),n(115)],r=function(e,t,n,i){return e.directiveModule.directive("gitListEditor",["NOTIFY",function(e){return{restrict:"E",replace:!0,scope:{bean:"=",maxCount:"@",expression:"@"},template:t.extractTemplate("#tmpl-global-git-list",i),link:function(i,r,a){var s,l,c,d,u,p;return u=new RegExp(i.expression),c=parseInt(i.maxCount),d=-1,s=function(e){return i.gitAccounts.length>=c?void 0:(i.gitAccounts.push(e),p())},p=function(e){return null==e&&(e=[]),i.bean.setGits(i.gitAccounts.concat(e))},l=function(e){return o(r).find("input").val(e)},i.$on("gitList:load",function(e,t){return i.currentText="",i.gitAccounts=t||[],p()}),i.onKeypressAdd=function(r){var o;if(13===r.keyCode&&(r.preventDefault(),o=t.trim(r.currentTarget.value),""!==o)){if(!u.test(o))return e.error("您输入的内容不合法");if(n.indexOf(i.gitAccounts,o)>-1)return void l("");-1===d?s(o):i.gitAccounts[d]=o,l(""),d=-1}},i.onKeyupAddLastItem=function(e){var n;if(13!==e.keyCode&&-1===d)return n=t.trim(e.currentTarget.value),""===n?p():u.test(n)?p(n):p()},i.onClickRemove=function(e,t){i.gitAccounts.splice(t,1),d=-1,p()},i.onClickEdit=function(e,t,n){d=t,l(n)}}}}])}.apply(t,i),!(void 0!==r&&(e.exports=r))}).call(t,n(33))},function(e,t,n){var i,r;(function(o){"use strict";i=[n(38),n(44)],r=function(e,t){return e.directiveModule.directive("dropdown",["$rootScope",function(e){return{restrict:"A",replace:!0,link:function(n,i,r){var a,s,l,c,d;return s=o(i),a=s.find("div.dropdown"),l=s.find(r.textContainer),c=(r.excludeValue||"").split(","),n.$on("dropdown:show",function(e,t){return t!==i?a.fadeOut():void 0}),d=function(e){return e=t.formatString(r.formatter||"{0}",e),l.text(e)},a.bind("mouseleave",function(){return a.fadeOut()}),s.bind("click",function(t){return a.fadeIn(),t.stopPropagation(),e.$broadcast("dropdown:show",i),o("body").one("click",function(){return a.fadeOut()})}),r.$observe("selected",function(){var e;if(n.items)return r.selected?(e=a.find("a[data-value='"+r.selected+"']"),d(e.text())):d(r.empty||"")}),a.bind("click",function(e){var t,i,s;return e.stopPropagation(),i=o(e.target),
t=i.closest("a"),a.fadeOut(),(s=t.attr("data-value"))?(n.$emit("dropdown:selected",r.name,s),-1===_.indexOf(c,s)?d(t.text()):void 0):void 0})}}}])}.apply(t,i),!(void 0!==r&&(e.exports=r))}).call(t,n(33))},function(e,t,n){var i,r;(function(o,a){i=[n(38),n(44),n(122),n(123),n(83),n(127),n(126),n(125),n(124)],r=function(e,t,i){return e.directiveModule.directive("editor",["$location","$timeout","STORE","EDITORSTORE",function(e,t,i,r){return{restrict:"E",replace:!0,scope:{},template:n(128),link:function(t,n,s){var l,c,d,u,p,h,m,f;return f=null,l=null,c=function(t,r){var c;return f?r(f):(c={textarea:o(n).find("textarea"),pasteImage:!0,params:{},upload:{params:{host:e.protocol()+"://"+e.host()+":"+e.port()},url:t,connectionCount:3,leaveConfirm:"正在上传文件，如果离开上传会自动取消"},tabIndent:!0,toolbar:["title","bold","italic","underline","strikethrough","color","ol","ul","blockquote","code","table","link","image","hr","indent","outdent","marked","fullscreen"],toolbarFloat:!1,pasteImage:!0,maxImageHeight:2e3,maxImageWidth:2e3,mention:{items:i.projectMemberList.data,nameKey:"realname"}},f=new a(c),f.on("valuechanged",function(e,t){var n;return n=e.currentTarget.getValue(),m(s.name,l,n,!0)}),r(f))},u=function(e,t){return e+"_"+t},d=function(e){return r.get(e)},m=function(e,t,n,i){return r.set(u(e,t),n,i)},h=function(e,t){return r.remove(u(e,t))},t.showAlwaysTop=(p=s.showAlwaysTop)===!0||"true"===p,t.$on("editor:content",function(e,t,n,i,r){return s.name&&s.name!==t?void 0:(l=n,c(r,function(){i&&f.setValue(i)}))}),t.$on("editor:will:cancel",function(e,n){return s.name===n&&f?(m(s.name,l,f.getValue()),t.$emit("editor:cancel",s.name)):void 0}),t.onClickCancel=function(){return f.setValue(""),t.$emit("editor:cancel",s.name)},t.onClickSubmit=function(){var e;if(f)return e={content:f.getValue(),always_top:t.always_top},f.setValue(""),t.$emit("editor:submit",s.name,e)},t.backList=r.list(),t.onClickChoose=function(e){return f.setValue(d(e))},t.onClickBack=function(){var e;return e=u(s.name,l),f.setValue(d(e))}}}}])}.apply(t,i),!(void 0!==r&&(e.exports=r))}).call(t,n(33),n(122))},function(e,t,n){var i,r;!function(o,a){i=[n(33),n(123),n(124),n(125)],r=function(e,t,n,i){return o.Simditor=a(e,t,n,i)}.apply(t,i),!(void 0!==r&&(e.exports=r))}(this,function(e,t,n,i){var r,o,a,s,l,c,d,u,p,h,m,f,g,v,b,y,w,x,k,_,C,T,j,A,$,S,M,N,E,D,I,P=function(e,t){function n(){this.constructor=e}for(var i in t)R.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},R={}.hasOwnProperty,B=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1},L=[].slice;return C=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return P(n,t),n.pluginName="Selection",n.prototype._init=function(){return this.editor=this._module,this.sel=document.getSelection()},n.prototype.clear=function(){var e;try{return this.sel.removeAllRanges()}catch(t){e=t}},n.prototype.getRange=function(){return this.editor.inputManager.focused&&this.sel.rangeCount?this.sel.getRangeAt(0):null},n.prototype.selectRange=function(e){return this.clear(),this.sel.addRange(e),this.editor.inputManager.focused||!this.editor.util.browser.firefox&&!this.editor.util.browser.msie||this.editor.body.focus(),e},n.prototype.rangeAtEndOf=function(t,n){var i,r,o;return null==n&&(n=this.getRange()),null!=n&&n.collapsed?(t=e(t)[0],i=n.endContainer,r=this.editor.util.getNodeLength(i),n.endOffset===r-1&&e(i).contents().last().is("br")||n.endOffset===r?t===i?!0:e.contains(t,i)?(o=!0,e(i).parentsUntil(t).addBack().each(function(){return function(t,n){var i,r;return r=e(n).parent().contents().filter(function(){return!(this!==n&&3===this.nodeType&&!this.nodeValue)}),i=r.last(),i.get(0)===n||i.is("br")&&i.prev().get(0)===n?void 0:(o=!1,!1)}}(this)),o):!1:!1):void 0},n.prototype.rangeAtStartOf=function(t,n){var i,r;return null==n&&(n=this.getRange()),null!=n&&n.collapsed?(t=e(t)[0],r=n.startContainer,0!==n.startOffset?!1:t===r?!0:e.contains(t,r)?(i=!0,e(r).parentsUntil(t).addBack().each(function(){return function(t,n){var r;return r=e(n).parent().contents().filter(function(){return!(this!==n&&3===this.nodeType&&!this.nodeValue)}),r.first().get(0)!==n?i=!1:void 0}}(this)),i):!1):void 0},n.prototype.insertNode=function(t,n){return null==n&&(n=this.getRange()),null!=n?(t=e(t)[0],n.insertNode(t),this.setRangeAfter(t,n)):void 0},n.prototype.setRangeAfter=function(t,n){return null==n&&(n=this.getRange()),null!=n?(t=e(t)[0],n.setEndAfter(t),n.collapse(!1),this.selectRange(n)):void 0},n.prototype.setRangeBefore=function(t,n){return null==n&&(n=this.getRange()),null!=n?(t=e(t)[0],n.setEndBefore(t),n.collapse(!1),this.selectRange(n)):void 0},n.prototype.setRangeAtStartOf=function(t,n){return null==n&&(n=this.getRange()),t=e(t).get(0),n.setEnd(t,0),n.collapse(!1),this.selectRange(n)},n.prototype.setRangeAtEndOf=function(t,n){var i,r,o,a,s,l;return null==n&&(n=this.getRange()),r=e(t),t=r.get(0),r.is("pre")?(o=r.contents(),o.length>0?(a=o.last(),s=a.text(),"\n"===s.charAt(s.length-1)?n.setEnd(a[0],this.editor.util.getNodeLength(a[0])-1):n.setEnd(a[0],this.editor.util.getNodeLength(a[0]))):n.setEnd(t,0)):(l=this.editor.util.getNodeLength(t),3!==t.nodeType&&l>0&&(i=e(t).contents().last(),i.is("br")?l-=1:3!==i[0].nodeType&&this.editor.util.isEmptyNode(i)&&(i.append(this.editor.util.phBr),t=i[0],l=0)),n.setEnd(t,l)),n.collapse(!1),this.selectRange(n)},n.prototype.deleteRangeContents=function(e){var t,n;return null==e&&(e=this.getRange()),n=e.cloneRange(),t=e.cloneRange(),n.collapse(!0),t.collapse(!1),!e.collapsed&&this.rangeAtStartOf(this.editor.body,n)&&this.rangeAtEndOf(this.editor.body,t)?(this.editor.body.empty(),e.setStart(this.editor.body[0],0),e.collapse(!0),this.selectRange(e)):e.deleteContents(),e},n.prototype.breakBlockEl=function(t,n){var i;return null==n&&(n=this.getRange()),i=e(t),n.collapsed?(n.setStartBefore(i.get(0)),n.collapsed?i:i.before(n.extractContents())):i},n.prototype.save=function(t){var n,i,r;return null==t&&(t=this.getRange()),this._selectionSaved?void 0:(i=t.cloneRange(),i.collapse(!1),r=e("<span/>").addClass("simditor-caret-start"),n=e("<span/>").addClass("simditor-caret-end"),i.insertNode(n[0]),t.insertNode(r[0]),this.clear(),this._selectionSaved=!0)},n.prototype.restore=function(){var e,t,n,i,r,o,a;return this._selectionSaved?(r=this.editor.body.find(".simditor-caret-start"),e=this.editor.body.find(".simditor-caret-end"),r.length&&e.length?(o=r.parent(),a=o.contents().index(r),t=e.parent(),n=t.contents().index(e),o[0]===t[0]&&(n-=1),i=document.createRange(),i.setStart(o.get(0),a),i.setEnd(t.get(0),n),r.remove(),e.remove(),this.selectRange(i)):(r.remove(),e.remove()),this._selectionSaved=!1,i):!1},n}(t),d=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return P(n,t),n.pluginName="Formatter",n.prototype.opts={allowedTags:null,allowedAttributes:null},n.prototype._init=function(){return this.editor=this._module,this._allowedTags=this.opts.allowedTags||["br","a","img","b","strong","i","u","font","p","ul","ol","li","blockquote","pre","h1","h2","h3","h4","hr"],this._allowedAttributes=this.opts.allowedAttributes||{img:["src","alt","width","height","data-image-src","data-image-size","data-image-name","data-non-image"],a:["href","target"],font:["color"],pre:["data-lang","class"],p:["data-indent"],h1:["data-indent"],h2:["data-indent"],h3:["data-indent"],h4:["data-indent"]},this.editor.body.on("click","a",function(){return function(){return!1}}(this))},n.prototype.decorate=function(e){return null==e&&(e=this.editor.body),this.editor.trigger("decorate",[e])},n.prototype.undecorate=function(t){return null==t&&(t=this.editor.body.clone()),this.editor.trigger("undecorate",[t]),e.trim(t.html())},n.prototype.autolink=function(t){var n,i,r,o,a,s,l,c,d,u,p;for(null==t&&(t=this.editor.body),s=[],i=function(n){return n.contents().each(function(n,r){var o,a;return o=e(r),o.is("a")||o.closest("a, pre",t).length?void 0:o.contents().length?i(o):(a=o.text())&&/https?:\/\/|www\./gi.test(a)?s.push(o):void 0})},i(t),c=/(https?:\/\/|www\.)[\w\-\.\?&=\/#%:,@\!\+]+/gi,r=0,a=s.length;a>r;r++){for(n=s[r],u=n.text(),d=[],l=null,o=0;null!==(l=c.exec(u));)d.push(document.createTextNode(u.substring(o,l.index))),o=c.lastIndex,p=/^(http(s)?:\/\/|\/)/.test(l[0])?l[0]:"http://"+l[0],d.push(e('<a href="'+p+'" rel="nofollow"></a>').text(l[0])[0]);d.push(document.createTextNode(u.substring(o))),n.replaceWith(e(d))}return t},n.prototype.format=function(t){var n,i,r,o,a,s,l,c,d,u;if(null==t&&(t=this.editor.body),t.is(":empty"))return t.append("<p>"+this.editor.util.phBr+"</p>"),t;for(d=t.contents(),r=0,a=d.length;a>r;r++)l=d[r],this.cleanNode(l,!0);for(u=t.contents(),o=0,s=u.length;s>o;o++)c=u[o],n=e(c),n.is("br")?("undefined"!=typeof i&&null!==i&&(i=null),n.remove()):this.editor.util.isBlockNode(c)?n.is("li")?i&&i.is("ul, ol")?i.append(c):(i=e("<ul/>").insertBefore(c),i.append(c)):i=null:((!i||i.is("ul, ol"))&&(i=e("<p/>").insertBefore(c)),i.append(c));return t},n.prototype.cleanNode=function(t,n){var i,r,o,a,s,l,c,d,u,p,h,m,f,g,v,b,y;if(r=e(t),r.length>0){if(3===r[0].nodeType)return b=r.text().replace(/(\r\n|\n|\r)/gm,""),void(b?(y=document.createTextNode(b),r.replaceWith(y)):r.remove());if(c=r.contents(),d=r.is('[class^="simditor-"]'),r.is(this._allowedTags.join(","))||d){if(r.is("a")&&(i=r.find("img")).length>0&&(r.replaceWith(i),r=i,c=null),r.is("img")&&r.hasClass("uploading")&&r.remove(),!d)for(s=this._allowedAttributes[r[0].tagName.toLowerCase()],g=e.makeArray(r[0].attributes),u=0,h=g.length;h>u;u++)l=g[u],null!=s&&(v=l.name,B.call(s,v)>=0)||r.removeAttr(l.name)}else 1!==r[0].nodeType||r.is(":empty")?(r.remove(),c=null):r.is("div, article, dl, header, footer, tr")?(r.append("<br/>"),c.first().unwrap()):r.is("table")?(o=e("<p/>"),r.find("tr").each(function(){return function(t,n){return o.append(e(n).text()+"<br/>")}}(this)),r.replaceWith(o),c=null):r.is("thead, tfoot")?(r.remove(),c=null):r.is("th")?(a=e("<td/>").append(r.contents()),r.replaceWith(a)):c.first().unwrap();if(n&&null!=c&&!r.is("pre"))for(p=0,m=c.length;m>p;p++)f=c[p],this.cleanNode(f,!0);return null}},n.prototype.clearHtml=function(t,n){var i,r,o;return null==n&&(n=!0),i=e("<div/>").append(t),r=i.contents(),o="",r.each(function(t){return function(i,a){var s,l;return 3===a.nodeType?o+=a.nodeValue:1===a.nodeType&&(s=e(a),l=s.contents(),l.length>0&&(o+=t.clearHtml(l)),n&&i<r.length-1&&s.is("br, p, div, li, tr, pre, address, artticle, aside, dl, figcaption, footer, h1, h2, h3, h4, header"))?o+="\n":void 0}}(this)),o},n.prototype.beautify=function(t){var n;return n=function(e){return!!(e.is("p")&&!e.text()&&e.children(":not(br)").length<1)},t.each(function(){return function(t,i){var r;return r=e(i),r.is(':not(img, br, col, td, hr, [class^="simditor-"]):empty')&&r.remove(),n(r)&&r.remove(),r.find(':not(img, br, col, td, hr, [class^="simditor-"]):empty').remove()}}(this))},n}(t),f=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return P(i,t),i.pluginName="InputManager",i.prototype.opts={pasteImage:!1},i.prototype._modifierKeys=[16,17,18,91,93,224],i.prototype._arrowKeys=[37,38,39,40],i.prototype._init=function(){var t;return this.editor=this._module,this.throttledTrigger=this.editor.util.throttle(function(e){return function(){var t;return t=1<=arguments.length?L.call(arguments,0):[],setTimeout(function(){var n;return(n=e.editor).trigger.apply(n,t)},10)}}(this),300),this.opts.pasteImage&&"string"!=typeof this.opts.pasteImage&&(this.opts.pasteImage="inline"),this._keystrokeHandlers={},this.hotkeys=n({el:this.editor.body}),this._pasteArea=e("<div/>").css({width:"1px",height:"1px",overflow:"hidden",position:"fixed",right:"0",bottom:"100px"}).attr({tabIndex:"-1",contentEditable:!0}).addClass("simditor-paste-area").appendTo(this.editor.el),e(document).on("selectionchange.simditor"+this.editor.id,function(e){return function(){return e.focused?(e._selectionTimer&&(clearTimeout(e._selectionTimer),e._selectionTimer=null),e._selectionTimer=setTimeout(function(){return e.editor.trigger("selectionchanged")},20)):void 0}}(this)),this.editor.on("valuechanged",function(t){return function(){return!t.editor.util.closestBlockEl()&&t.focused&&(t.editor.selection.save(),t.editor.formatter.format(),t.editor.selection.restore()),t.editor.body.find("hr, pre, .simditor-table").each(function(n,i){var r,o;return r=e(i),(r.parent().is("blockquote")||r.parent()[0]===t.editor.body[0])&&(o=!1,0===r.next().length&&(e("<p/>").append(t.editor.util.phBr).insertAfter(r),o=!0),0===r.prev().length&&(e("<p/>").append(t.editor.util.phBr).insertBefore(r),o=!0),o)?setTimeout(function(){return t.editor.trigger("valuechanged")},10):void 0}),t.editor.body.find("pre:empty").append(t.editor.util.phBr),!t.editor.util.support.onselectionchange&&t.focused?t.editor.trigger("selectionchanged"):void 0}}(this)),this.editor.on("selectionchanged",function(e){return function(){return e.editor.undoManager.update()}}(this)),this.editor.body.on("keydown",e.proxy(this._onKeyDown,this)).on("keypress",e.proxy(this._onKeyPress,this)).on("keyup",e.proxy(this._onKeyUp,this)).on("mouseup",e.proxy(this._onMouseUp,this)).on("focus",e.proxy(this._onFocus,this)).on("blur",e.proxy(this._onBlur,this)).on("paste",e.proxy(this._onPaste,this)).on("drop",e.proxy(this._onDrop,this)).on("input",e.proxy(this._onInput,this)),this.editor.util.browser.firefox&&(this.addShortcut("cmd+left",function(e){return function(t){return t.preventDefault(),e.editor.selection.sel.modify("move","backward","lineboundary"),!1}}(this)),this.addShortcut("cmd+right",function(e){return function(t){return t.preventDefault(),e.editor.selection.sel.modify("move","forward","lineboundary"),!1}}(this)),this.addShortcut("cmd+a",function(e){return function(){var t,n,i,r;return t=e.editor.body.children(),t.length>0?(n=t.first().get(0),i=t.last().get(0),r=document.createRange(),r.setStart(n,0),r.setEnd(i,e.editor.util.getNodeLength(i)),e.editor.selection.selectRange(r),!1):void 0}}(this))),t=this.editor.util.os.mac?"cmd+enter":"ctrl+enter",this.addShortcut(t,function(e){return function(){return e.editor.el.closest("form").find("button:submit").click(),!1}}(this)),this.editor.textarea.attr("autofocus")?setTimeout(function(e){return function(){return e.editor.focus()}}(this),0):void 0},i.prototype._onFocus=function(){return this.editor.el.addClass("focus").removeClass("error"),this.focused=!0,this.lastCaretPosition=null,setTimeout(function(e){return function(){return e.editor.triggerHandler("focus"),e.editor.trigger("selectionchanged")}}(this),0)},i.prototype._onBlur=function(){var e;return this.editor.el.removeClass("focus"),this.editor.sync(),this.focused=!1,this.lastCaretPosition=null!=(e=this.editor.undoManager.currentState())?e.caret:void 0,this.editor.triggerHandler("blur")},i.prototype._onMouseUp=function(){return this.editor.util.support.onselectionchange?void 0:setTimeout(function(e){return function(){return e.editor.trigger("selectionchanged")}}(this),0)},i.prototype._onKeyDown=function(t){var n,i,r,o;if(this.editor.triggerHandler(t)===!1)return!1;if(!this.hotkeys.respondTo(t)){if(t.which in this._keystrokeHandlers){if(o="function"==typeof(n=this._keystrokeHandlers[t.which])["*"]?n["*"](t):void 0)return this.editor.trigger("valuechanged"),!1;if(this.editor.util.traverseUp(function(n){return function(i){var r,a;return i.nodeType===document.ELEMENT_NODE?(r=null!=(a=n._keystrokeHandlers[t.which])?a[i.tagName.toLowerCase()]:void 0,o="function"==typeof r?r(t,e(i)):void 0,o===!0||o===!1?!1:void 0):void 0}}(this)),o)return this.editor.trigger("valuechanged"),!1}if(i=t.which,!(B.call(this._modifierKeys,i)>=0||(r=t.which,B.call(this._arrowKeys,r)>=0)||this.editor.util.metaKey(t)&&86===t.which))return this.editor.util.support.oninput||this.throttledTrigger("valuechanged",["typing"]),null}},i.prototype._onKeyPress=function(e){return this.editor.triggerHandler(e)===!1?!1:void 0},i.prototype._onKeyUp=function(t){var n,i;return this.editor.triggerHandler(t)===!1?!1:!this.editor.util.support.onselectionchange&&(i=t.which,B.call(this._arrowKeys,i)>=0)?void this.editor.trigger("selectionchanged"):void(8!==t.which&&46!==t.which||!this.editor.util.isEmptyNode(this.editor.body)||(this.editor.body.empty(),n=e("<p/>").append(this.editor.util.phBr).appendTo(this.editor.body),this.editor.selection.setRangeAtStartOf(n)))},i.prototype._onPaste=function(t){var n,i,r,o,a,s,l,c,d;if(this.editor.triggerHandler(t)===!1)return!1;if(l=this.editor.selection.deleteRangeContents(),l.collapsed||l.collapse(!0),n=this.editor.util.closestBlockEl(),i=n.is("pre, table"),t.originalEvent.clipboardData&&t.originalEvent.clipboardData.items&&t.originalEvent.clipboardData.items.length>0&&(a=t.originalEvent.clipboardData.items[0],/^image\//.test(a.type)&&!i)){if(r=a.getAsFile(),null==r||!this.opts.pasteImage)return;return r.name||(r.name="Clipboard Image.png"),d={},d[this.opts.pasteImage]=!0,null!=(c=this.editor.uploader)&&c.upload(r,d),!1}return s=function(t){return function(r){var o,a,s,c,u,p,h,m,f,g,v,b,y,w,x,k,_,C,T,j,A;if(t.editor.triggerHandler("pasting",[r])!==!1&&r){if(i)if(n.is("table")){for(x=r.split("\n"),m=x.pop(),u=0,f=x.length;f>u;u++)w=x[u],t.editor.selection.insertNode(document.createTextNode(w)),t.editor.selection.insertNode(e("<br/>"));t.editor.selection.insertNode(document.createTextNode(m))}else for(r=e("<div/>").text(r),T=r.contents(),p=0,g=T.length;g>p;p++)_=T[p],t.editor.selection.insertNode(e(_)[0],l);else if(n.is(t.editor.body))for(h=0,v=r.length;v>h;h++)_=r[h],t.editor.selection.insertNode(_,l);else{if(r.length<1)return;if(1===r.length)if(r.is("p")){if(s=r.contents(),1===s.length&&s.is("img")){if(o=s,/^data:image/.test(o.attr("src"))){if(!t.opts.pasteImage)return;return a=t.editor.util.dataURLtoBlob(o.attr("src")),a.name="Clipboard Image.png",d={},d[t.opts.pasteImage]=!0,void(null!=(j=t.editor.uploader)&&j.upload(a,d))}if(o.is('img[src^="webkit-fake-url://"]'))return}for(k=0,b=s.length;b>k;k++)_=s[k],t.editor.selection.insertNode(_,l)}else if(n.is("p")&&t.editor.util.isEmptyNode(n))n.replaceWith(r),t.editor.selection.setRangeAtEndOf(r,l);else if(r.is("ul, ol"))if(1===r.find("li").length)for(r=e("<div/>").text(r.text()),A=r.contents(),C=0,y=A.length;y>C;C++)_=A[C],t.editor.selection.insertNode(e(_)[0],l);else n.is("li")?(n.parent().after(r),t.editor.selection.setRangeAtEndOf(r,l)):(n.after(r),t.editor.selection.setRangeAtEndOf(r,l));else n.after(r),t.editor.selection.setRangeAtEndOf(r,l);else n.is("li")&&(n=n.parent()),t.editor.selection.rangeAtStartOf(n,l)?c="before":t.editor.selection.rangeAtEndOf(n,l)?c="after":(t.editor.selection.breakBlockEl(n,l),c="before"),n[c](r),t.editor.selection.setRangeAtEndOf(r.last(),l)}return t.editor.trigger("valuechanged")}}}(this),i?(t.preventDefault(),o=this.editor.util.browser.msie?window.clipboardData.getData("Text"):t.originalEvent.clipboardData.getData("text/plain"),s(o)):(this.editor.selection.save(l),this._pasteArea.focus(),this.editor.util.browser.msie&&10===this.editor.util.browser.version&&(t.preventDefault(),this._pasteArea.html(window.clipboardData.getData("Text"))),setTimeout(function(t){return function(){return t._pasteArea.is(":empty")?o=null:(o=e("<div/>").append(t._pasteArea.contents()),o.find("table colgroup").remove(),t.editor.formatter.format(o),t.editor.formatter.decorate(o),t.editor.formatter.beautify(o.children()),o=o.contents()),t._pasteArea.empty(),l=t.editor.selection.restore(),s(o)}}(this),10))},i.prototype._onDrop=function(e){return this.editor.triggerHandler(e)===!1?!1:setTimeout(function(e){return function(){return e.editor.trigger("valuechanged")}}(this),0)},i.prototype._onInput=function(){return this.throttledTrigger("valuechanged",["oninput"])},i.prototype.addKeystrokeHandler=function(e,t,n){return this._keystrokeHandlers[e]||(this._keystrokeHandlers[e]={}),this._keystrokeHandlers[e][t]=n},i.prototype.addShortcut=function(t,n){return this.hotkeys.add(t,e.proxy(n,this))},i}(t),v=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return P(n,t),n.pluginName="Keystroke",n.prototype._init=function(){var t;return this.editor=this._module,this.editor.util.browser.safari&&this.editor.inputManager.addKeystrokeHandler("13","*",function(t){return function(n){var i,r;return n.shiftKey&&(i=t.editor.util.closestBlockEl(),!i.is("pre"))?(r=e("<br/>"),t.editor.selection.rangeAtEndOf(i)?(t.editor.selection.insertNode(r),t.editor.selection.insertNode(e("<br/>")),t.editor.selection.setRangeBefore(r)):t.editor.selection.insertNode(r),!0):void 0}}(this)),(this.editor.util.browser.webkit||this.editor.util.browser.msie)&&(t=function(t){return function(n,i){var r;return t.editor.selection.rangeAtEndOf(i)?(r=e("<p/>").append(t.editor.util.phBr).insertAfter(i),t.editor.selection.setRangeAtStartOf(r),!0):void 0}}(this),this.editor.inputManager.addKeystrokeHandler("13","h1",t),this.editor.inputManager.addKeystrokeHandler("13","h2",t),this.editor.inputManager.addKeystrokeHandler("13","h3",t),this.editor.inputManager.addKeystrokeHandler("13","h4",t),this.editor.inputManager.addKeystrokeHandler("13","h5",t),this.editor.inputManager.addKeystrokeHandler("13","h6",t)),this.editor.inputManager.addKeystrokeHandler("8","*",function(e){return function(){var t,n,i;return i=e.editor.util.furthestBlockEl(),n=i.prev(),n.is("hr")&&e.editor.selection.rangeAtStartOf(i)?(e.editor.selection.save(),n.remove(),e.editor.selection.restore(),!0):(t=e.editor.util.closestBlockEl(),e.editor.util.browser.webkit&&e.editor.selection.rangeAtStartOf(t)?(e.editor.selection.save(),e.editor.formatter.cleanNode(t,!0),e.editor.selection.restore(),null):void 0)}}(this)),this.editor.inputManager.addKeystrokeHandler("9","*",function(e){return function(t){var n;return n=e.editor.toolbar.findButton("code"),e.editor.opts.tabIndent||n&&n.active?(t.shiftKey?e.editor.util.outdent():e.editor.util.indent(),!0):void 0}}(this)),this.editor.inputManager.addKeystrokeHandler("13","li",function(t){return function(n,i){var r,o,a,s;if(r=i.clone(),r.find("ul, ol").remove(),t.editor.util.isEmptyNode(r)&&i.is(t.editor.util.closestBlockEl())){if(o=i.parent(),i.next("li").length>0){if(!t.editor.util.isEmptyNode(i))return;o.parent("li").length>0?(a=e("<li/>").append(t.editor.util.phBr).insertAfter(o.parent("li")),s=e("<"+o[0].tagName+"/>").append(i.nextAll("li")),a.append(s)):(a=e("<p/>").append(t.editor.util.phBr).insertAfter(o),s=e("<"+o[0].tagName+"/>").append(i.nextAll("li")),a.after(s))}else o.parent("li").length>0?(a=e("<li/>").insertAfter(o.parent("li")),a.append(i.contents().length>0?i.contents():t.editor.util.phBr)):(a=e("<p/>").append(t.editor.util.phBr).insertAfter(o),i.children("ul, ol").length>0&&a.after(i.children("ul, ol")));return i.prev("li").length?i.remove():o.remove(),t.editor.selection.setRangeAtStartOf(a),!0}}}(this)),this.editor.inputManager.addKeystrokeHandler("13","pre",function(t){return function(n,i){var r,o,a;return n.preventDefault(),n.shiftKey?(r=e("<p/>").append(t.editor.util.phBr).insertAfter(i),t.editor.selection.setRangeAtStartOf(r),!0):(a=t.editor.selection.getRange(),o=null,a.deleteContents(),!t.editor.util.browser.msie&&t.editor.selection.rangeAtEndOf(i)?(o=document.createTextNode("\n\n"),a.insertNode(o),a.setEnd(o,1)):(o=document.createTextNode("\n"),a.insertNode(o),a.setStartAfter(o)),a.collapse(!1),t.editor.selection.selectRange(a),!0)}}(this)),this.editor.inputManager.addKeystrokeHandler("13","blockquote",function(e){return function(t,n){var i,r;return i=e.editor.util.closestBlockEl(),i.is("p")&&!i.next().length&&e.editor.util.isEmptyNode(i)?(n.after(i),r=document.createRange(),e.editor.selection.setRangeAtStartOf(i,r),!0):void 0}}(this)),this.editor.inputManager.addKeystrokeHandler("8","li",function(t){return function(n,i){var r,o,a,s,l,c,d,u;return o=i.children("ul, ol"),l=i.prev("li"),o.length>0&&l.length>0?(u="",c=null,i.contents().each(function(t,n){return 1===n.nodeType&&/UL|OL/.test(n.nodeName)?!1:1===n.nodeType&&/BR/.test(n.nodeName)?void 0:(3===n.nodeType&&n.nodeValue?u+=n.nodeValue:1===n.nodeType&&(u+=e(n).text()),c=e(n))}),c&&1===u.length&&t.editor.util.browser.firefox&&!c.next("br").length?(r=e(t.editor.util.phBr).insertAfter(c),c.remove(),t.editor.selection.setRangeBefore(r),!0):u.length>0?!1:(d=document.createRange(),s=l.children("ul, ol"),s.length>0?(a=e("<li/>").append(t.editor.util.phBr).appendTo(s),s.append(o.children("li")),i.remove(),t.editor.selection.setRangeAtEndOf(a,d)):(t.editor.selection.setRangeAtEndOf(l,d),l.append(o),i.remove(),t.editor.selection.selectRange(d)),!0)):!1}}(this)),this.editor.inputManager.addKeystrokeHandler("8","pre",function(t){return function(n,i){var r,o,a;return t.editor.selection.rangeAtStartOf(i)?(o=i.html().replace("\n","<br/>"),r=e("<p/>").append(o||t.editor.util.phBr).insertAfter(i),i.remove(),a=document.createRange(),t.editor.selection.setRangeAtStartOf(r,a),!0):void 0}}(this)),this.editor.inputManager.addKeystrokeHandler("8","blockquote",function(e){return function(t,n){var i,r;return e.editor.selection.rangeAtStartOf(n)?(i=n.children().first().unwrap(),r=document.createRange(),e.editor.selection.setRangeAtStartOf(i,r),!0):void 0}}(this))},n}(t),E=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return P(n,t),n.pluginName="UndoManager",n.prototype._index=-1,n.prototype._capacity=50,n.prototype._timer=null,n.prototype._init=function(){var e,t;return this.editor=this._module,this._stack=[],this.editor.util.os.mac?(t="cmd+z",e="shift+cmd+z"):this.editor.util.os.win?(t="ctrl+z",e="ctrl+y"):(t="ctrl+z",e="shift+ctrl+z"),this.editor.inputManager.addShortcut(t,function(e){return function(t){return t.preventDefault(),e.undo(),!1}}(this)),this.editor.inputManager.addShortcut(e,function(e){return function(t){return t.preventDefault(),e.redo(),!1}}(this)),this.editor.on("valuechanged",function(e){return function(t,n){return"undo"!==n&&"redo"!==n?(e._timer&&(clearTimeout(e._timer),e._timer=null),e._timer=setTimeout(function(){return e._pushUndoState(),e._timer=null},200)):void 0}}(this))},n.prototype._pushUndoState=function(){var e,t;return this.editor.triggerHandler("pushundostate")===!1||(e=this.currentState(),t=this.editor.body.html(),e&&e.html===t)?void 0:(this._index+=1,this._stack.length=this._index,this._stack.push({html:t,caret:this.caretPosition()}),this._stack.length>this._capacity?(this._stack.shift(),this._index-=1):void 0)},n.prototype.currentState=function(){return this._stack.length&&this._index>-1?this._stack[this._index]:null},n.prototype.undo=function(){var e;return this._index<1||this._stack.length<2?void 0:(this.editor.hidePopover(),this._index-=1,e=this._stack[this._index],this.editor.body.html(e.html),this.caretPosition(e.caret),this.editor.body.find(".selected").removeClass("selected"),this.editor.sync(),this.editor.trigger("valuechanged",["undo"]))},n.prototype.redo=function(){var e;return this._index<0||this._stack.length<this._index+2?void 0:(this.editor.hidePopover(),this._index+=1,e=this._stack[this._index],this.editor.body.html(e.html),this.caretPosition(e.caret),this.editor.body.find(".selected").removeClass("selected"),this.editor.sync(),this.editor.trigger("valuechanged",["redo"]))},n.prototype.update=function(){var e,t;return!this._timer&&(e=this.currentState())?(t=this.editor.body.html(),e.html=t,e.caret=this.caretPosition()):void 0},n.prototype._getNodeOffset=function(t,n){var i,r,o;return i=n?e(t):e(t).parent(),o=0,r=!1,i.contents().each(function(){return function(e,i){return n===e||t===i?!1:(3===i.nodeType?r||(o+=1,r=!0):(o+=1,r=!1),null)}}(this)),o},n.prototype._getNodePosition=function(e,t){var n,i;if(3===e.nodeType)for(i=e.previousSibling;i&&3===i.nodeType;)e=i,t+=this.editor.util.getNodeLength(i),i=i.previousSibling;else t=this._getNodeOffset(e,t);return n=[],n.unshift(t),this.editor.util.traverseUp(function(e){return function(t){return n.unshift(e._getNodeOffset(t))}}(this),e),n},n.prototype._getNodeByPosition=function(t){var n,i,r,o,a,s,l,c;for(s=this.editor.body[0],c=t.slice(0,t.length-1),r=o=0,a=c.length;a>o;r=++o){if(l=c[r],i=s.childNodes,l>i.length-1){if(r!==t.length-2||!e(s).is("pre")){s=null;break}n=document.createTextNode(""),s.appendChild(n),i=s.childNodes}s=i[l]}return s},n.prototype.caretPosition=function(e){var t,n,i,r,o;if(e){if(this.editor.inputManager.focused||this.editor.body.focus(),!e.start)return void this.editor.body.blur();if(r=this._getNodeByPosition(e.start),o=e.start[e.start.length-1],e.collapsed?(t=r,n=o):(t=this._getNodeByPosition(e.end),n=e.start[e.start.length-1]),!r||!t)throw new Error("simditor: invalid caret state");return i=document.createRange(),i.setStart(r,o),i.setEnd(t,n),this.editor.selection.selectRange(i)}return i=this.editor.selection.getRange(),this.editor.inputManager.focused&&null!=i?(e={start:[],end:null,collapsed:!0},e.start=this._getNodePosition(i.startContainer,i.startOffset),i.collapsed||(e.end=this._getNodePosition(i.endContainer,i.endOffset),e.collapsed=!1),e):{}},n}(t),I=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return P(n,t),n.pluginName="Util",n.prototype._init=function(){return this.editor=this._module,this.browser.msie&&this.browser.version<11?this.phBr="":void 0},n.prototype.phBr="<br/>",n.prototype.os=function(){var e;return e={},/Mac/.test(navigator.appVersion)?e.mac=!0:/Linux/.test(navigator.appVersion)?e.linux=!0:/Win/.test(navigator.appVersion)?e.win=!0:/X11/.test(navigator.appVersion)&&(e.unix=!0),/Mobi/.test(navigator.appVersion)&&(e.mobile=!0),e}(),n.prototype.browser=function(){var e,t,n,i,r,o,a,s,l;return l=navigator.userAgent,n=/(msie|trident)/i.test(l),e=/chrome|crios/i.test(l),s=/safari/i.test(l)&&!e,t=/firefox/i.test(l),n?{msie:!0,version:1*(null!=(i=l.match(/(msie |rv:)(\d+(\.\d+)?)/i))?i[2]:void 0)}:e?{webkit:!0,chrome:!0,version:1*(null!=(r=l.match(/(?:chrome|crios)\/(\d+(\.\d+)?)/i))?r[1]:void 0)}:s?{webkit:!0,safari:!0,version:1*(null!=(o=l.match(/version\/(\d+(\.\d+)?)/i))?o[1]:void 0)}:t?{mozilla:!0,firefox:!0,version:1*(null!=(a=l.match(/firefox\/(\d+(\.\d+)?)/i))?a[1]:void 0)}:{}}(),n.prototype.support=function(){return{onselectionchange:function(){var e,t;if(t=document.onselectionchange,void 0!==t)try{return document.onselectionchange=0,null===document.onselectionchange}catch(n){e=n}finally{document.onselectionchange=t}return!1}(),oninput:function(){return!/(msie|trident)/i.test(navigator.userAgent)}()}}(),n.prototype.reflow=function(t){return null==t&&(t=document),e(t)[0].offsetHeight},n.prototype.metaKey=function(e){var t;return t=/Mac/.test(navigator.userAgent),t?e.metaKey:e.ctrlKey},n.prototype.isEmptyNode=function(t){var n;return n=e(t),n.is(":empty")||!n.text()&&!n.find(":not(br, span, div)").length},n.prototype.blockNodes=["div","p","ul","ol","li","blockquote","hr","pre","h1","h2","h3","h4","table"],n.prototype.isBlockNode=function(t){return t=e(t)[0],t&&3!==t.nodeType?new RegExp("^("+this.blockNodes.join("|")+")$").test(t.nodeName.toLowerCase()):!1},n.prototype.closestBlockEl=function(t){var n,i,r;return null==t&&(r=this.editor.selection.getRange(),t=null!=r?r.commonAncestorContainer:void 0),n=e(t),n.length?(i=n.parentsUntil(this.editor.body).addBack(),i=i.filter(function(e){return function(t){return e.isBlockNode(i.eq(t))}}(this)),i.length?i.last():null):null},n.prototype.furthestNode=function(t,n){var i,r,o;return null==t&&(o=this.editor.selection.getRange(),t=null!=o?o.commonAncestorContainer:void 0),i=e(t),i.length?(r=i.parentsUntil(this.editor.body).addBack(),r=r.filter(function(){return function(t){var i;return i=r.eq(t),e.isFunction(n)?n(i):i.is(n)}}(this)),r.length?r.first():null):null},n.prototype.furthestBlockEl=function(t){return this.furthestNode(t,e.proxy(this.isBlockNode,this))},n.prototype.getNodeLength=function(e){switch(e.nodeType){case 7:case 10:return 0;case 3:case 8:return e.length;default:return e.childNodes.length}},n.prototype.traverseUp=function(t,n){var i,r,o,a,s,l,c;if(null==n&&(s=this.editor.selection.getRange(),n=null!=s?s.commonAncestorContainer:void 0),
null==n||!e.contains(this.editor.body[0],n))return!1;for(a=e(n).parentsUntil(this.editor.body).get(),a.unshift(n),c=[],i=0,r=a.length;r>i&&(o=a[i],l=t(o),l!==!1);i++)c.push(void 0);return c},n.prototype.indent=function(){var t,n,i,r,o,a,s,l,c,d;if(t=this.editor.util.closestBlockEl(),!(t&&t.length>0))return!1;if(t.is("pre"))c=document.createTextNode("  "),this.editor.selection.insertNode(c);else if(t.is("li")){if(r=t.prev("li"),r.length<1)return!1;this.editor.selection.save(),d=t.parent()[0].tagName,n=r.children("ul, ol"),n.length>0?n.append(t):e("<"+d+"/>").append(t).appendTo(r),this.editor.selection.restore()}else if(t.is("p, h1, h2, h3, h4"))a=null!=(l=t.attr("data-indent"))?l:0,a=1*a+1,a>10&&(a=10),t.attr("data-indent",a);else if(t.is("table")){if(s=this.editor.selection.getRange(),o=e(s.commonAncestorContainer).closest("td"),i=o.next("td"),i.length>0||(i=o.parent("tr").next("tr").find("td:first")),!(o.length>0&&i.length>0))return!1;this.editor.selection.setRangeAtEndOf(i)}else c=document.createTextNode("    "),this.editor.selection.insertNode(c);return this.editor.trigger("valuechanged"),!0},n.prototype.outdent=function(){var t,n,i,r,o,a,s,l,c;if(t=this.editor.util.closestBlockEl(),!(t&&t.length>0))return!1;if(t.is("pre"))return!1;if(t.is("li")){if(n=t.parent(),i=n.parent("li"),i.length<1)return a=this.editor.toolbar.findButton(n[0].tagName.toLowerCase()),null!=a&&a.command(),!1;this.editor.selection.save(),t.next("li").length>0&&e("<"+n[0].tagName+"/>").append(t.nextAll("li")).appendTo(t),t.insertAfter(i),n.children("li").length<1&&n.remove(),this.editor.selection.restore()}else if(t.is("p, h1, h2, h3, h4"))s=null!=(c=t.attr("data-indent"))?c:0,s=1*s-1,0>s&&(s=0),t.attr("data-indent",s);else{if(!t.is("table"))return!1;if(l=this.editor.selection.getRange(),o=e(l.commonAncestorContainer).closest("td"),r=o.prev("td"),r.length>0||(r=o.parent("tr").prev("tr").find("td:last")),!(o.length>0&&r.length>0))return!1;this.editor.selection.setRangeAtEndOf(r)}return this.editor.trigger("valuechanged"),!0},n.prototype.dataURLtoBlob=function(e){var t,n,i,r,o,a,s,l,c,d,u;if(a=window.Blob&&function(){var e;try{return Boolean(new Blob)}catch(t){return e=t,!1}}(),o=a&&window.Uint8Array&&function(){var e;try{return 100===new Blob([new Uint8Array(100)]).size}catch(t){return e=t,!1}}(),t=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,!((a||t)&&window.atob&&window.ArrayBuffer&&window.Uint8Array))return!1;for(r=e.split(",")[0].indexOf("base64")>=0?atob(e.split(",")[1]):decodeURIComponent(e.split(",")[1]),n=new ArrayBuffer(r.length),l=new Uint8Array(n),s=c=0,u=r.length;u>=0?u>=c:c>=u;s=u>=0?++c:--c)l[s]=r.charCodeAt(s);return d=e.split(",")[0].split(":")[1].split(";")[0],a?new Blob([o?l:n],{type:d}):(i=new t,i.append(n),i.getBlob(d))},n.prototype.throttle=function(e,t){var n,i,r;return n=null,i=0,r=function(){return n?(clearTimeout(n),n=null):void 0},function(){var o,a,s,l;return a=Date.now(),i||(i=a),s=t-(a-i),l=null,s>0&&t>s?(i=a,r(),o=arguments,n=setTimeout(function(){return i=0,n=null,l=e.apply(null,o)},t)):(r(),i!==a&&(i=0),l=e.apply(null,arguments)),l}},n.prototype.formatHTML=function(t){var n,i,r,o,a,s,l,c,d;for(s=/<(\/?)(.+?)(\/?)>/g,c="",o=0,r=null,i="  ",l=function(e,t){return new Array(t+1).join(e)};null!==(a=s.exec(t));)a.isBlockNode=e.inArray(a[2],this.blockNodes)>-1,a.isStartTag="/"!==a[1]&&"/"!==a[3],a.isEndTag="/"===a[1]||"/"===a[3],n=r?r.index+r[0].length:0,(d=t.substring(n,a.index)).length>0&&e.trim(d)&&(c+=d),a.isBlockNode&&a.isEndTag&&!a.isStartTag&&(o-=1),a.isBlockNode&&a.isStartTag&&(r&&r.isBlockNode&&r.isEndTag||(c+="\n"),c+=l(i,o)),c+=a[0],a.isBlockNode&&a.isEndTag&&(c+="\n"),a.isBlockNode&&a.isStartTag&&(o+=1),r=a;return e.trim(c)},n}(t),M=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return P(n,t),n.pluginName="Toolbar",n.prototype.opts={toolbar:!0,toolbarFloat:!0,toolbarHidden:!1,toolbarFloatOffset:0},n.prototype._tpl={wrapper:'<div class="simditor-toolbar"><ul></ul></div>',separator:'<li><span class="separator"></span></li>'},n.prototype._init=function(){var t;return this.editor=this._module,this.opts.toolbar?(e.isArray(this.opts.toolbar)||(this.opts.toolbar=["bold","italic","underline","strikethrough","|","ol","ul","blockquote","code","|","link","image","|","indent","outdent"]),this._render(),this.list.on("click",function(){return function(){return!1}}(this)),this.wrapper.on("mousedown",function(e){return function(){return e.list.find(".menu-on").removeClass(".menu-on")}}(this)),e(document).on("mousedown.simditor"+this.editor.id,function(e){return function(){return e.list.find(".menu-on").removeClass(".menu-on")}}(this)),!this.opts.toolbarHidden&&this.opts.toolbarFloat&&(this.wrapper.width(this.wrapper.outerWidth()),this.wrapper.css("top",this.opts.toolbarFloatOffset),t=this.wrapper.outerHeight(),this.editor.util.os.mobile||e(window).on("resize.simditor-"+this.editor.id,function(e){return function(){return e.wrapper.css("position","static"),e.editor.util.reflow(e.wrapper),e.wrapper.css("left",e.wrapper.offset().left),e.wrapper.css("position","")}}(this)).resize(),e(window).on("scroll.simditor-"+this.editor.id,function(n){return function(){var i,r,o;if(o=n.editor.wrapper.offset().top,i=o+n.editor.wrapper.outerHeight()-80,r=e(document).scrollTop()+n.opts.toolbarFloatOffset,o>=r||r>=i){if(n.editor.wrapper.removeClass("toolbar-floating").css("padding-top",""),n.editor.util.os.mobile)return n.wrapper.css("top",n.opts.toolbarFloatOffset)}else if(n.editor.wrapper.addClass("toolbar-floating").css("padding-top",t),n.editor.util.os.mobile)return n.wrapper.css("top",r-o+n.opts.toolbarFloatOffset)}}(this))),this.editor.on("selectionchanged",function(e){return function(){return e.toolbarStatus()}}(this)),this.editor.on("destroy",function(e){return function(){return e.buttons.length=0}}(this)),e(document).on("mousedown.simditor-"+this.editor.id,function(e){return function(){return e.list.find("li.menu-on").removeClass("menu-on")}}(this))):void 0},n.prototype._render=function(){var t,n,i,r;for(this.buttons=[],this.wrapper=e(this._tpl.wrapper).prependTo(this.editor.wrapper),this.list=this.wrapper.find("ul"),r=this.opts.toolbar,t=0,n=r.length;n>t;t++)if(i=r[t],"|"!==i){if(!this.constructor.buttons[i])throw new Error('simditor: invalid toolbar button "'+i+'"');this.buttons.push(new this.constructor.buttons[i]({editor:this.editor}))}else e(this._tpl.separator).appendTo(this.list);return this.opts.toolbarHidden?this.wrapper.hide():this.editor.placeholderEl.css("top",this.wrapper.outerHeight())},n.prototype.toolbarStatus=function(t){var n;return this.editor.inputManager.focused?(n=this.buttons.slice(0),this.editor.util.traverseUp(function(){return function(i){var r,o,a,s,l,c,d;for(d=[],o=a=0,l=n.length;l>a;o=++a)r=n[o],(null==t||r.name===t)&&(r.status&&r.status(e(i))!==!0||d.push(r));for(s=0,c=d.length;c>s;s++)r=d[s],o=e.inArray(r,n),n.splice(o,1);return 0===n.length?!1:void 0}}(this))):void 0},n.prototype.findButton=function(e){var t;return t=this.list.find(".toolbar-item-"+e).data("button"),null!=t?t:null},n.addButton=function(e){return this.buttons[e.prototype.name]=e},n.buttons={},n}(t),T=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return P(n,t),n.connect(I),n.connect(f),n.connect(E),n.connect(v),n.connect(d),n.connect(C),n.connect(M),n.count=0,n.prototype.opts={textarea:null,placeholder:"",defaultImage:"images/image.png",params:{},upload:!1,tabIndent:!0},n.prototype._init=function(){var t,r,o,a;if(this.textarea=e(this.opts.textarea),this.opts.placeholder=this.opts.placeholder||this.textarea.attr("placeholder"),!this.textarea.length)throw new Error("simditor: param textarea is required.");if(r=this.textarea.data("simditor"),null!=r&&r.destroy(),this.id=++n.count,this._render(),this.opts.upload&&i&&(a="object"==typeof this.opts.upload?this.opts.upload:{},this.uploader=i(a)),o=this.textarea.closest("form"),o.length&&(o.on("submit.simditor-"+this.id,function(e){return function(){return e.sync()}}(this)),o.on("reset.simditor-"+this.id,function(e){return function(){return e.setValue("")}}(this))),this.on("initialized",function(e){return function(){return e.opts.placeholder&&e.on("valuechanged",function(){return e._placeholder()}),e.setValue(e.textarea.val().trim()||"")}}(this)),this.util.browser.mozilla){this.util.reflow();try{return document.execCommand("enableObjectResizing",!1,!1),document.execCommand("enableInlineTableEditing",!1,!1)}catch(s){t=s}}},n.prototype._tpl='<div class="simditor">\n  <div class="simditor-wrapper">\n    <div class="simditor-placeholder"></div>\n    <div class="simditor-body" contenteditable="true">\n    </div>\n  </div>\n</div>',n.prototype._render=function(){var t,n,i,r;if(this.el=e(this._tpl).insertBefore(this.textarea),this.wrapper=this.el.find(".simditor-wrapper"),this.body=this.wrapper.find(".simditor-body"),this.placeholderEl=this.wrapper.find(".simditor-placeholder").append(this.opts.placeholder),this.el.data("simditor",this),this.wrapper.append(this.textarea),this.textarea.data("simditor",this).blur(),this.body.attr("tabindex",this.textarea.attr("tabindex")),this.util.os.mac?this.el.addClass("simditor-mac"):this.util.os.linux&&this.el.addClass("simditor-linux"),this.util.os.mobile&&this.el.addClass("simditor-mobile"),this.opts.params){n=this.opts.params,i=[];for(t in n)r=n[t],i.push(e("<input/>",{type:"hidden",name:t,value:r}).insertAfter(this.textarea));return i}},n.prototype._placeholder=function(){var e,t;return e=this.body.children(),0===e.length||1===e.length&&this.util.isEmptyNode(e)&&(null!=(t=e.data("indent"))?t:0)<1?this.placeholderEl.show():this.placeholderEl.hide()},n.prototype.setValue=function(e){return this.hidePopover(),this.textarea.val(e),this.body.html(e),this.formatter.format(),this.formatter.decorate(),this.util.reflow(this.body),this.inputManager.lastCaretPosition=null,this.trigger("valuechanged")},n.prototype.getValue=function(){return this.sync()},n.prototype.sync=function(){var t,n,i,r,o,a;for(n=this.body.clone(),this.formatter.undecorate(n),this.formatter.format(n),this.formatter.autolink(n),t=n.children(),o=t.last("p"),r=t.first("p");o.is("p")&&this.util.isEmptyNode(o);)i=o,o=o.prev("p"),i.remove();for(;r.is("p")&&this.util.isEmptyNode(r);)i=r,r=o.next("p"),i.remove();return n.find("img.uploading").remove(),a=e.trim(n.html()),this.textarea.val(a),a},n.prototype.focus=function(){var t,n;return this.sourceMode?void this.textarea.focus():this.inputManager.lastCaretPosition?this.undoManager.caretPosition(this.inputManager.lastCaretPosition):(t=this.body.find("p").last(),t.length>0||(t=e("<p/>").append(this.util.phBr).appendTo(this.body)),n=document.createRange(),this.selection.setRangeAtEndOf(t,n),this.body.focus())},n.prototype.blur=function(){return this.sourceMode?this.textarea.blur():this.body.blur()},n.prototype.hidePopover=function(){return this.el.find(".simditor-popover").each(function(){return function(t,n){return n=e(n).data("popover"),n.active?n.hide():void 0}}(this))},n.prototype.destroy=function(){return this.triggerHandler("destroy"),this.textarea.closest("form").off(".simditor .simditor-"+this.id),this.selection.clear(),this.inputManager.focused=!1,this.textarea.insertBefore(this.el).hide().val("").removeData("simditor"),this.el.remove(),e(document).off(".simditor-"+this.id),e(window).off(".simditor-"+this.id),this.off()},n}(t),T.i18n={"zh-CN":{blockquote:"引用",bold:"加粗文字",code:"插入代码",color:"文字颜色",hr:"分隔线",image:"插入图片",externalImage:"外链图片",uploadImage:"上传图片",uploadFailed:"上传失败了",uploadError:"上传出错了",imageUrl:"图片地址",imageSize:"图片尺寸",restoreImageSize:"还原图片尺寸",uploading:"正在上传",indent:"向右缩进",outdent:"向左缩进",italic:"斜体文字",link:"插入链接",text:"文本",linkText:"链接文字",linkUrl:"地址",removeLink:"移除链接",ol:"有序列表",ul:"无序列表",strikethrough:"删除线文字",table:"表格",deleteRow:"删除行",insertRowAbove:"在上面插入行",insertRowBelow:"在下面插入行",deleteColumn:"删除列",insertColumnLeft:"在左边插入列",insertColumnRight:"在右边插入列",deleteTable:"删除表格",title:"标题",source:"HTML源代码",normalText:"普通文本",underline:"下划线文字"}},a=function(t){function n(e){this.editor=e.editor,this.title=this._t(this.name),n.__super__.constructor.call(this,e)}return P(n,t),n.prototype._tpl={item:'<li><a tabindex="-1" unselectable="on" class="toolbar-item" href="javascript:;"><span></span></a></li>',menuWrapper:'<div class="toolbar-menu"></div>',menuItem:'<li><a tabindex="-1" unselectable="on" class="menu-item" href="javascript:;"><span></span></a></li>',separator:'<li><span class="separator"></span></li>'},n.prototype.name="",n.prototype.icon="",n.prototype.title="",n.prototype.text="",n.prototype.htmlTag="",n.prototype.disableTag="",n.prototype.menu=!1,n.prototype.active=!1,n.prototype.disabled=!1,n.prototype.needFocus=!0,n.prototype.shortcut=null,n.prototype._init=function(){var t,n,i,r,o;for(this.render(),this.el.on("mousedown",function(e){return function(t){var n,i;return t.preventDefault(),e.el.hasClass("disabled")||e.needFocus&&!e.editor.inputManager.focused?!1:e.menu?(e.wrapper.toggleClass("menu-on").siblings("li").removeClass("menu-on"),e.wrapper.is(".menu-on")&&(n=e.menuWrapper.offset().left+e.menuWrapper.outerWidth()+5-e.editor.wrapper.offset().left-e.editor.wrapper.outerWidth(),n>0&&e.menuWrapper.css({left:"auto",right:0}),e.trigger("menuexpand")),!1):(i=e.el.data("param"),e.command(i),!1)}}(this)),this.wrapper.on("click","a.menu-item",function(t){return function(n){var i,r;return n.preventDefault(),i=e(n.currentTarget),t.wrapper.removeClass("menu-on"),i.hasClass("disabled")||t.needFocus&&!t.editor.inputManager.focused?!1:(t.editor.toolbar.wrapper.removeClass("menu-on"),r=i.data("param"),t.command(r),!1)}}(this)),this.wrapper.on("mousedown","a.menu-item",function(){return function(){return!1}}(this)),this.editor.on("blur",function(e){return function(){return e.editor.sourceMode?void 0:(e.setActive(!1),e.setDisabled(!1))}}(this)),null!=this.shortcut&&this.editor.inputManager.addShortcut(this.shortcut,function(e){return function(){return e.el.mousedown(),!1}}(this)),i=this.htmlTag.split(","),r=[],t=0,n=i.length;n>t;t++)o=i[t],o=e.trim(o),r.push(o&&e.inArray(o,this.editor.formatter._allowedTags)<0?this.editor.formatter._allowedTags.push(o):void 0);return r},n.prototype.render=function(){return this.wrapper=e(this._tpl.item).appendTo(this.editor.toolbar.list),this.el=this.wrapper.find("a.toolbar-item"),this.el.attr("title",this.title).addClass("toolbar-item-"+this.name).data("button",this),this.el.find("span").addClass(this.icon?"simditor-icon simditor-icon-"+this.icon:"").text(this.text),this.menu?(this.menuWrapper=e(this._tpl.menuWrapper).appendTo(this.wrapper),this.menuWrapper.addClass("toolbar-menu-"+this.name),this.renderMenu()):void 0},n.prototype.renderMenu=function(){var t,n,i,r,o,a,s,l;if(e.isArray(this.menu)){for(this.menuEl=e("<ul/>").appendTo(this.menuWrapper),a=this.menu,l=[],i=0,r=a.length;r>i;i++)o=a[i],"|"!==o?(n=e(this._tpl.menuItem).appendTo(this.menuEl),l.push(t=n.find("a.menu-item").attr({title:null!=(s=o.title)?s:o.text,"data-param":o.param}).addClass("menu-item-"+o.name).find("span").text(o.text))):e(this._tpl.separator).appendTo(this.menuEl);return l}},n.prototype.setActive=function(e){return e!==this.active?(this.active=e,this.el.toggleClass("active",this.active),this.editor.toolbar.trigger("buttonstatus",[this])):void 0},n.prototype.setDisabled=function(e){return e!==this.disabled?(this.disabled=e,this.el.toggleClass("disabled",this.disabled),this.editor.toolbar.trigger("buttonstatus",[this])):void 0},n.prototype.status=function(e){return null!=e&&this.setDisabled(e.is(this.disableTag)),this.disabled?!0:(null!=e&&this.setActive(e.is(this.htmlTag)),this.active)},n.prototype.command=function(){},n.prototype._t=function(){var e,t,i;return e=1<=arguments.length?L.call(arguments,0):[],i=n.__super__._t.apply(this,e),i||(i=(t=this.editor)._t.apply(t,e)),i},n}(t),T.Button=a,_=function(t){function n(e){this.button=e.button,this.editor=e.button.editor,n.__super__.constructor.call(this,e)}return P(n,t),n.prototype.offset={top:4,left:0},n.prototype.target=null,n.prototype.active=!1,n.prototype._init=function(){return this.el=e('<div class="simditor-popover"></div>').appendTo(this.editor.el).data("popover",this),this.render(),this.el.on("mouseenter",function(e){return function(){return e.el.addClass("hover")}}(this)),this.el.on("mouseleave",function(e){return function(){return e.el.removeClass("hover")}}(this))},n.prototype.render=function(){},n.prototype.show=function(t,n){return null==n&&(n="bottom"),null!=t?(this.el.siblings(".simditor-popover").each(function(){return function(t,n){return n=e(n).data("popover"),n.active?n.hide():void 0}}(this)),this.target=t.addClass("selected"),this.active?(this.refresh(n),this.trigger("popovershow")):(this.active=!0,this.el.css({left:-9999}).show(),setTimeout(function(e){return function(){return e.refresh(n),e.trigger("popovershow")}}(this),0))):void 0},n.prototype.hide=function(){return this.active?(this.target&&this.target.removeClass("selected"),this.target=null,this.active=!1,this.el.hide(),this.trigger("popoverhide")):void 0},n.prototype.refresh=function(e){var t,n,i,r,o;return null==e&&(e="bottom"),this.active?(t=this.editor.el.offset(),r=this.target.offset(),i=this.target.outerHeight(),"bottom"===e?o=r.top-t.top+i:"top"===e&&(o=r.top-t.top-this.el.height()),n=Math.min(r.left-t.left,this.editor.wrapper.width()-this.el.outerWidth()-10),this.el.css({top:o+this.offset.top,left:n+this.offset.left})):void 0},n.prototype.destroy=function(){return this.target=null,this.active=!1,this.editor.off(".linkpopover"),this.el.remove()},n.prototype._t=function(){var e,t,i;return e=1<=arguments.length?L.call(arguments,0):[],i=n.__super__._t.apply(this,e),i||(i=(t=this.button)._t.apply(t,e)),i},n}(t),T.Popover=_,j=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return P(t,e),t.prototype.name="source",t.prototype.icon="html5",t.prototype.needFocus=!1,t.prototype._init=function(){return t.__super__._init.call(this),this.editor.textarea.on("focus",function(e){return function(){return e.editor.el.addClass("focus").removeClass("error")}}(this)),this.editor.textarea.on("blur",function(e){return function(){return e.editor.el.removeClass("focus"),e.editor.setValue(e.editor.textarea.val())}}(this)),this.editor.textarea.on("input",function(e){return function(){return e._resizeTextarea()}}(this))},t.prototype.status=function(){return!0},t.prototype.command=function(){var e,t,n,i;for(this.editor.blur(),this.editor.el.toggleClass("simditor-source-mode"),this.editor.sourceMode=this.editor.el.hasClass("simditor-source-mode"),this.editor.sourceMode&&(this.editor.hidePopover(),this.editor.textarea.val(this.editor.util.formatHTML(this.editor.textarea.val())),this._resizeTextarea()),i=this.editor.toolbar.buttons,t=0,n=i.length;n>t;t++)e=i[t],"source"===e.name?e.setActive(this.editor.sourceMode):e.setDisabled(this.editor.sourceMode);return null},t.prototype._resizeTextarea=function(){return this._textareaPadding||(this._textareaPadding=this.editor.textarea.innerHeight()-this.editor.textarea.height()),this.editor.textarea.height(0).height(this.editor.textarea[0].scrollHeight-this._textareaPadding)},t}(a),T.Toolbar.addButton(j),S=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return P(n,t),n.prototype.name="title",n.prototype.htmlTag="h1, h2, h3, h4",n.prototype.disableTag="pre, table",n.prototype._init=function(){return this.menu=[{name:"normal",text:this._t("normalText"),param:"p"},"|",{name:"h1",text:this._t("title")+" 1",param:"h1"},{name:"h2",text:this._t("title")+" 2",param:"h2"},{name:"h3",text:this._t("title")+" 3",param:"h3"},{name:"h4",text:this._t("title")+" 4",param:"h4"},{name:"h5",text:this._t("title")+" 5",param:"h5"}],n.__super__._init.call(this)},n.prototype.setActive=function(e,t){return n.__super__.setActive.call(this,e),this.el.removeClass("active-p active-h1 active-h2 active-h3"),e?this.el.addClass("active active-"+t):void 0},n.prototype.status=function(e){var t,n;return null!=e&&this.setDisabled(e.is(this.disableTag)),this.disabled?!0:(null!=e&&(t=null!=(n=e[0].tagName)?n.toLowerCase():void 0,this.setActive(e.is(this.htmlTag),t)),this.active)},n.prototype.command=function(t){var n,i,r,o,a,s,l,c,d,u,p;for(c=this.editor.selection.getRange(),p=c.startContainer,o=c.endContainer,r=this.editor.util.closestBlockEl(p),i=this.editor.util.closestBlockEl(o),this.editor.selection.save(),c.setStartBefore(r[0]),c.setEndAfter(i[0]),n=e(c.extractContents()),u=[],n.children().each(function(e){return function(n,i){var r,o,a,s,l;for(o=e._convertEl(i,t),l=[],a=0,s=o.length;s>a;a++)r=o[a],l.push(u.push(r));return l}}(this)),d=u.reverse(),a=0,s=d.length;s>a;a++)l=d[a],c.insertNode(l[0]);return this.editor.selection.restore(),this.editor.trigger("valuechanged")},n.prototype._convertEl=function(t,n){var i,r,o;return r=e(t),o=[],r.is(n)?o.push(r):(i=e("<"+n+"/>").append(r.contents()),o.push(i)),o},n}(a),T.Toolbar.addButton(S),o=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return P(n,t),n.prototype.name="bold",n.prototype.icon="bold",n.prototype.htmlTag="b, strong",n.prototype.disableTag="pre",n.prototype.shortcut="cmd+b",n.prototype._init=function(){return this.editor.util.os.mac?this.title=this.title+" ( Cmd + b )":(this.title=this.title+" ( Ctrl + b )",this.shortcut="ctrl+b"),n.__super__._init.call(this)},n.prototype.status=function(e){var t;return null!=e&&this.setDisabled(e.is(this.disableTag)),this.disabled?!0:(t=document.queryCommandState("bold")===!0,this.setActive(t),t)},n.prototype.command=function(){return document.execCommand("bold"),this.editor.util.support.oninput||this.editor.trigger("valuechanged"),e(document).trigger("selectionchange")},n}(a),T.Toolbar.addButton(o),g=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return P(n,t),n.prototype.name="italic",n.prototype.icon="italic",n.prototype.htmlTag="i",n.prototype.disableTag="pre",n.prototype.shortcut="cmd+i",n.prototype._init=function(){return this.editor.util.os.mac?this.title=this.title+" ( Cmd + i )":(this.title=this.title+" ( Ctrl + i )",this.shortcut="ctrl+i"),n.__super__._init.call(this)},n.prototype.status=function(e){var t;return null!=e&&this.setDisabled(e.is(this.disableTag)),this.disabled?this.disabled:(t=document.queryCommandState("italic")===!0,this.setActive(t),t)},n.prototype.command=function(){return document.execCommand("italic"),this.editor.util.support.oninput||this.editor.trigger("valuechanged"),e(document).trigger("selectionchange")},n}(a),T.Toolbar.addButton(g),N=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return P(n,t),n.prototype.name="underline",n.prototype.icon="underline",n.prototype.htmlTag="u",n.prototype.disableTag="pre",n.prototype.shortcut="cmd+u",n.prototype.render=function(){return this.editor.util.os.mac?this.title=this.title+" ( Cmd + u )":(this.title=this.title+" ( Ctrl + u )",this.shortcut="ctrl+u"),n.__super__.render.call(this)},n.prototype.status=function(e){var t;return null!=e&&this.setDisabled(e.is(this.disableTag)),this.disabled?this.disabled:(t=document.queryCommandState("underline")===!0,this.setActive(t),t)},n.prototype.command=function(){return document.execCommand("underline"),this.editor.util.support.oninput||this.editor.trigger("valuechanged"),e(document).trigger("selectionchange")},n}(a),T.Toolbar.addButton(N),c=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return P(n,t),n.prototype.name="color",n.prototype.icon="tint",n.prototype.disableTag="pre",n.prototype.menu=!0,n.prototype.render=function(){var e;return e=1<=arguments.length?L.call(arguments,0):[],n.__super__.render.apply(this,e)},n.prototype.renderMenu=function(){return e('<ul class="color-list">\n  <li><a href="javascript:;" class="font-color font-color-1" data-color=""></a></li>\n  <li><a href="javascript:;" class="font-color font-color-2" data-color=""></a></li>\n  <li><a href="javascript:;" class="font-color font-color-3" data-color=""></a></li>\n  <li><a href="javascript:;" class="font-color font-color-4" data-color=""></a></li>\n  <li><a href="javascript:;" class="font-color font-color-5" data-color=""></a></li>\n  <li><a href="javascript:;" class="font-color font-color-6" data-color=""></a></li>\n  <li><a href="javascript:;" class="font-color font-color-7" data-color=""></a></li>\n  <li><a href="javascript:;" class="font-color font-color-default" data-color=""></a></li>\n</ul>').appendTo(this.menuWrapper),this.menuWrapper.on("mousedown",".color-list",function(){return!1}),this.menuWrapper.on("click",".font-color",function(t){return function(n){var i,r,o,a;if(t.wrapper.removeClass("menu-on"),i=e(n.currentTarget),i.hasClass("font-color-default")){if(r=t.editor.body.find("p, li"),!(r.length>0))return;a=window.getComputedStyle(r[0],null).getPropertyValue("color"),o=t._convertRgbToHex(a)}else a=window.getComputedStyle(i[0],null).getPropertyValue("background-color"),o=t._convertRgbToHex(a);return o?(document.execCommand("foreColor",!1,o),t.editor.util.support.oninput?void 0:t.editor.trigger("valuechanged")):void 0}}(this))},n.prototype._convertRgbToHex=function(e){var t,n,i;return n=/rgb\((\d+),\s?(\d+),\s?(\d+)\)/g,(t=n.exec(e))?(i=function(e,t,n){var i;return i=function(e){var t;return t=e.toString(16),1===t.length?"0"+t:t},"#"+i(e)+i(t)+i(n)})(1*t[1],1*t[2],1*t[3]):""},n}(a),T.Toolbar.addButton(c),w=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return P(n,t),n.prototype.type="",n.prototype.disableTag="pre, table",n.prototype.status=function(e){var t;return null!=e&&this.setDisabled(e.is(this.disableTag)),this.disabled?!0:null==e?this.active:(t="ul"===this.type?"ol":"ul",e.is(t)?(this.setActive(!1),!0):(this.setActive(e.is(this.htmlTag)),this.active))},n.prototype.command=function(){var t,n,i,r,o,a,s,l,c,d,u,p,h,m,f,g,v;for(h=this.editor.selection.getRange(),v=h.startContainer,l=h.endContainer,a=this.editor.util.closestBlockEl(v),n=this.editor.util.closestBlockEl(l),this.editor.selection.save(),h.setStartBefore(a[0]),h.setEndAfter(n[0]),a.is("li")&&n.is("li")&&(r=this.editor.util.furthestNode(a,"ul, ol"),i=this.editor.util.furthestNode(n,"ul, ol"),r.is(i)?(c=function(e){var t;for(t=1;!e.parent().is(r);)t+=1,e=e.parent();return t},g=c(a),s=c(n),o=g>s?n.parent():a.parent(),h.setStartBefore(o[0]),h.setEndAfter(o[0])):(h.setStartBefore(r[0]),h.setEndAfter(i[0]))),t=e(h.extractContents()),f=[],t.children().each(function(e){return function(t,n){var i,r,o,a,s;for(r=e._convertEl(n),s=[],o=0,a=r.length;a>o;o++)i=r[o],s.push(f.length&&f[f.length-1].is(e.type)&&i.is(e.type)?f[f.length-1].append(i.children()):f.push(i));return s}}(this)),m=f.reverse(),d=0,u=m.length;u>d;d++)p=m[d],h.insertNode(p[0]);return this.editor.selection.restore(),this.editor.trigger("valuechanged")},n.prototype._convertEl=function(t){var n,i,r,o,a,s,l,c,d;if(n=e(t),d=[],i="ul"===this.type?"ol":"ul",n.is(this.type))n.children("li").each(function(t){return function(n,i){var r,o,a;return o=e(i),r=o.children("ul, ol").remove(),a=e("<p/>").append(e(i).html()||t.editor.util.phBr),d.push(a),r.length>0?d.push(r):void 0}}(this));else if(n.is(i))r=e("<"+this.type+"/>").append(n.html()),d.push(r);else if(n.is("blockquote")){for(c=n.children().get(),s=0,l=c.length;l>s;s++)o=c[s],a=this._convertEl(o);e.merge(d,a)}else n.is("table")||(r=e("<"+this.type+"><li></li></"+this.type+">"),r.find("li").append(n.html()||this.editor.util.phBr),d.push(r));return d},n}(a),x=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return P(t,e),t.prototype.type="ol",t.prototype.name="ol",t.prototype.icon="list-ol",t.prototype.htmlTag="ol",t.prototype.shortcut="cmd+/",t.prototype._init=function(){return this.editor.util.os.mac?this.title=this.title+" ( Cmd + / )":(this.title=this.title+" ( ctrl + / )",this.shortcut="ctrl+/"),t.__super__._init.call(this)},t}(w),D=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return P(t,e),t.prototype.type="ul",t.prototype.name="ul",t.prototype.icon="list-ul",t.prototype.htmlTag="ul",t.prototype.shortcut="cmd+.",t.prototype._init=function(){return this.editor.util.os.mac?this.title=this.title+" ( Cmd + . )":(this.title=this.title+" ( Ctrl + . )",this.shortcut="ctrl+."),t.__super__._init.call(this)},t}(w),T.Toolbar.addButton(x),T.Toolbar.addButton(D),r=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return P(n,t),n.prototype.name="blockquote",n.prototype.icon="quote-left",n.prototype.htmlTag="blockquote",n.prototype.disableTag="pre, table",n.prototype.command=function(){var t,n,i,r,o,a,s,l,c,d,u;for(l=this.editor.selection.getRange(),u=l.startContainer,r=l.endContainer,i=this.editor.util.furthestBlockEl(u),n=this.editor.util.furthestBlockEl(r),this.editor.selection.save(),l.setStartBefore(i[0]),l.setEndAfter(n[0]),t=e(l.extractContents()),d=[],t.children().each(function(e){return function(t,n){var i,r,o,a,s;for(r=e._convertEl(n),s=[],o=0,a=r.length;a>o;o++)i=r[o],s.push(d.length&&d[d.length-1].is(e.htmlTag)&&i.is(e.htmlTag)?d[d.length-1].append(i.children()):d.push(i));return s}}(this)),c=d.reverse(),o=0,a=c.length;a>o;o++)s=c[o],l.insertNode(s[0]);return this.editor.selection.restore(),this.editor.trigger("valuechanged")},n.prototype._convertEl=function(t){var n,i,r;return n=e(t),r=[],n.is(this.htmlTag)?n.children().each(function(){return function(t,n){return r.push(e(n))}}(this)):(i=e("<"+this.htmlTag+"/>").append(n),r.push(i)),r},n}(a),T.Toolbar.addButton(r),s=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return P(n,t),n.prototype.name="code",n.prototype.icon="code",n.prototype.htmlTag="pre",n.prototype.disableTag="li, table",n.prototype._init=function(){return n.__super__._init.call(this),this.editor.on("decorate",function(t){return function(n,i){return i.find("pre").each(function(n,i){return t.decorate(e(i))})}}(this)),this.editor.on("undecorate",function(t){return function(n,i){return i.find("pre").each(function(n,i){return t.undecorate(e(i))})}}(this))},n.prototype.render=function(){var e;return e=1<=arguments.length?L.call(arguments,0):[],n.__super__.render.apply(this,e),this.popover=new l({button:this})},n.prototype.status=function(e){var t;return t=n.__super__.status.call(this,e),this.active?this.popover.show(e):this.editor.util.isBlockNode(e)&&this.popover.hide(),t},n.prototype.decorate=function(e){var t;return t=e.attr("data-lang"),e.removeClass(),t&&-1!==t?e.addClass("lang-"+t):void 0},n.prototype.undecorate=function(e){var t;return t=e.attr("data-lang"),e.removeClass(),t&&-1!==t?e.addClass("lang-"+t):void 0},n.prototype.command=function(){var t,n,i,r,o,a,s,l,c,d,u;for(l=this.editor.selection.getRange(),u=l.startContainer,r=l.endContainer,i=this.editor.util.closestBlockEl(u),n=this.editor.util.closestBlockEl(r),l.setStartBefore(i[0]),l.setEndAfter(n[0]),t=e(l.extractContents()),d=[],t.children().each(function(e){return function(t,n){var i,r,o,a,s;for(r=e._convertEl(n),s=[],o=0,a=r.length;a>o;o++)i=r[o],s.push(d.length&&d[d.length-1].is(e.htmlTag)&&i.is(e.htmlTag)?d[d.length-1].append(i.contents()):d.push(i));return s}}(this)),c=d.reverse(),o=0,a=c.length;a>o;o++)s=c[o],l.insertNode(s[0]);return this.editor.selection.setRangeAtEndOf(d[0]),this.editor.trigger("valuechanged")},n.prototype._convertEl=function(t){var n,i,r,o;return n=e(t),o=[],n.is(this.htmlTag)?(i=e("<p/>").append(n.html().replace("\n","<br/>")),o.push(i)):(r=!n.text()&&1===n.children().length&&n.children().is("br")?"\n":this.editor.formatter.clearHtml(n),i=e("<"+this.htmlTag+"/>").text(r),o.push(i)),o},n}(a),l=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return P(t,e),t.prototype._tpl='<div class="code-settings">\n  <div class="settings-field">\n    <select class="select-lang">\n      <option value="-1">选择程序语言</option>\n      <option value="bash">Bash</option>\n      <option value="c++">C++</option>\n      <option value="cs">C#</option>\n      <option value="css">CSS</option>\n      <option value="erlang">Erlang</option>\n      <option value="less">Less</option>\n      <option value="scss">Sass</option>\n      <option value="diff">Diff</option>\n      <option value="coffeeScript">CoffeeScript</option>\n      <option value="html">Html,XML</option>\n      <option value="json">JSON</option>\n      <option value="java">Java</option>\n      <option value="js">JavaScript</option>\n      <option value="markdown">Markdown</option>\n      <option value="oc">Objective C</option>\n      <option value="php">PHP</option>\n      <option value="perl">Perl</option>\n      <option value="python">Python</option>\n      <option value="ruby">Ruby</option>\n      <option value="sql">SQL</option>\n    </select>\n  </div>\n</div>',
t.prototype.render=function(){return this.el.addClass("code-popover").append(this._tpl),this.selectEl=this.el.find(".select-lang"),this.selectEl.on("change",function(e){return function(){var t;return e.lang=e.selectEl.val(),t=e.target.hasClass("selected"),e.target.removeClass().removeAttr("data-lang"),-1!==e.lang&&(e.target.addClass("lang-"+e.lang),e.target.attr("data-lang",e.lang)),t?e.target.addClass("selected"):void 0}}(this)),this.editor.on("valuechanged",function(e){return function(){return e.active?e.refresh():void 0}}(this))},t.prototype.show=function(){var e;return e=1<=arguments.length?L.call(arguments,0):[],t.__super__.show.apply(this,e),this.lang=this.target.attr("data-lang"),this.selectEl.val(null!=this.lang?this.lang:-1)},t}(_),T.Toolbar.addButton(s),b=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return P(n,t),n.prototype.name="link",n.prototype.icon="link",n.prototype.htmlTag="a",n.prototype.disableTag="pre",n.prototype.render=function(){var e;return e=1<=arguments.length?L.call(arguments,0):[],n.__super__.render.apply(this,e),this.popover=new y({button:this})},n.prototype.status=function(e){var t;return null!=e&&this.setDisabled(e.is(this.disableTag)),this.disabled?!0:null==e?this.active:(t=!0,!e.is(this.htmlTag)||e.is('[class^="simditor-"]')?(this.setActive(!1),t=!1):this.editor.selection.rangeAtEndOf(e)?(this.setActive(!0),t=!1):this.setActive(!0),t?this.popover.show(e):this.editor.util.isBlockNode(e)&&this.popover.hide(),this.active)},n.prototype.command=function(){var t,n,i,r,o,a,s,l,c,d;return l=this.editor.selection.getRange(),this.active?(i=e(l.commonAncestorContainer).closest("a"),d=document.createTextNode(i.text()),i.replaceWith(d),l.selectNode(d)):(c=l.startContainer,a=l.endContainer,o=this.editor.util.closestBlockEl(c),n=this.editor.util.closestBlockEl(a),t=e(l.extractContents()),s=this.editor.formatter.clearHtml(t.contents(),!1),i=e("<a/>",{href:"http://www.example.com",target:"_blank",text:s||this._t("linkText")}),o[0]===n[0]?l.insertNode(i[0]):(r=e("<p/>").append(i),l.insertNode(r[0])),l.selectNodeContents(i[0]),this.popover.one("popovershow",function(e){return function(){return s?(e.popover.urlEl.focus(),e.popover.urlEl[0].select()):(e.popover.textEl.focus(),e.popover.textEl[0].select())}}(this))),this.editor.selection.selectRange(l),this.editor.trigger("valuechanged")},n}(a),y=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return P(n,t),n.prototype.render=function(){var t;return t='<div class="link-settings">\n  <div class="settings-field">\n    <label>'+this._t("text")+'</label>\n    <input class="link-text" type="text"/>\n    <a class="btn-unlink" href="javascript:;" title="'+this._t("removeLink")+'" tabindex="-1"><span class="simditor-icon simditor-icon-unlink"></span></a>\n  </div>\n  <div class="settings-field">\n    <label>'+this._t("linkUrl")+'</label>\n    <input class="link-url" type="text"/>\n  </div>\n</div>',this.el.addClass("link-popover").append(t),this.textEl=this.el.find(".link-text"),this.urlEl=this.el.find(".link-url"),this.unlinkEl=this.el.find(".btn-unlink"),this.textEl.on("keyup",function(e){return function(t){return 13!==t.which?e.target.text(e.textEl.val()):void 0}}(this)),this.urlEl.on("keyup",function(e){return function(t){var n;return 13!==t.which?(n=e.urlEl.val(),!/https?:\/\/|^\//gi.test(n)&&n&&(n="http://"+n),e.target.attr("href",n)):void 0}}(this)),e([this.urlEl[0],this.textEl[0]]).on("keydown",function(t){return function(n){return 13===n.which||27===n.which||!n.shiftKey&&9===n.which&&e(n.target).hasClass("link-url")?(n.preventDefault(),setTimeout(function(){var e;return e=document.createRange(),t.editor.selection.setRangeAfter(t.target,e),t.hide(),t.editor.trigger("valuechanged")},0)):void 0}}(this)),this.unlinkEl.on("click",function(e){return function(){var t,n;return n=document.createTextNode(e.target.text()),e.target.replaceWith(n),e.hide(),t=document.createRange(),e.editor.selection.setRangeAfter(n,t),e.editor.trigger("valuechanged")}}(this))},n.prototype.show=function(){var e;return e=1<=arguments.length?L.call(arguments,0):[],n.__super__.show.apply(this,e),this.textEl.val(this.target.text()),this.urlEl.val(this.target.attr("href"))},n}(_),T.Toolbar.addButton(b),p=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return P(n,t),n.prototype.name="image",n.prototype.icon="picture-o",n.prototype.htmlTag="img",n.prototype.disableTag="pre, table",n.prototype.defaultImage="",n.prototype.needFocus=!1,n.prototype._init=function(){var t,i,r,o;if(this.editor.opts.imageButton)if(Array.isArray(this.editor.opts.imageButton))for(this.menu=[],o=this.editor.opts.imageButton,i=0,r=o.length;r>i;i++)t=o[i],this.menu.push({name:t+"-image",text:this._t(t+"Image")});else this.menu=!1;else this.menu=null!=this.editor.uploader?[{name:"upload-image",text:this._t("uploadImage")},{name:"external-image",text:this._t("externalImage")}]:!1;return this.defaultImage=this.editor.opts.defaultImage,this.editor.body.on("click","img:not([data-non-image])",function(t){return function(n){var i,r;return i=e(n.currentTarget),r=document.createRange(),r.selectNode(i[0]),t.editor.selection.selectRange(r),t.editor.util.support.onselectionchange||t.editor.trigger("selectionchanged"),!1}}(this)),this.editor.body.on("mouseup","img:not([data-non-image])",function(){return function(){return!1}}(this)),this.editor.on("selectionchanged.image",function(t){return function(){var n,i,r;return r=t.editor.selection.getRange(),null!=r?(n=e(r.cloneContents()).contents(),1===n.length&&n.is("img:not([data-non-image])")?(i=e(r.startContainer).contents().eq(r.startOffset),t.popover.show(i)):t.popover.hide()):void 0}}(this)),this.editor.on("valuechanged.image",function(t){return function(){var n;return n=t.editor.wrapper.find(".simditor-image-loading"),n.length>0?n.each(function(n,i){var r,o,a;return o=e(i),r=o.data("img"),!(r&&r.parent().length>0)&&(o.remove(),r&&(a=r.data("file"),a&&(t.editor.uploader.cancel(a),t.editor.body.find("img.uploading").length<1)))?t.editor.uploader.trigger("uploadready",[a]):void 0}):void 0}}(this)),n.__super__._init.call(this)},n.prototype.render=function(){var e;return e=1<=arguments.length?L.call(arguments,0):[],n.__super__.render.apply(this,e),this.popover=new h({button:this}),"upload"===this.editor.opts.imageButton?this._initUploader(this.el):void 0},n.prototype.renderMenu=function(){return n.__super__.renderMenu.call(this),this._initUploader()},n.prototype._initUploader=function(t){var n,i;return null==t&&(t=this.menuEl.find(".menu-item-upload-image")),null==this.editor.uploader?void this.el.find(".btn-upload").remove():(n=null,i=function(i){return function(){return n&&n.remove(),n=e('<input type="file" title="'+i._t("uploadImage")+'" accept="image/*">').appendTo(t)}}(this),i(),t.on("click mousedown","input[type=file]",function(){return function(e){return e.stopPropagation()}}(this)),t.on("change","input[type=file]",function(e){return function(){return e.editor.inputManager.focused?(e.editor.uploader.upload(n,{inline:!0}),i()):(e.editor.one("focus",function(){return e.editor.uploader.upload(n,{inline:!0}),i()}),e.editor.focus()),e.wrapper.removeClass("menu-on")}}(this)),this.editor.uploader.on("beforeupload",function(t){return function(n,i){var r;return i.inline?(i.img?r=e(i.img):(r=t.createImage(i.name),i.img=r),r.addClass("uploading"),r.data("file",i),t.editor.uploader.readImageFile(i.obj,function(e){var n;return r.hasClass("uploading")?(n=e?e.src:t.defaultImage,t.loadImage(r,n,function(){return t.popover.active?(t.popover.refresh(),t.popover.srcEl.val(t._t("uploading")).prop("disabled",!0)):void 0})):void 0})):void 0}}(this)),this.editor.uploader.on("uploadprogress",e.proxy(this.editor.util.throttle(function(e,t,n,i){var r,o,a;return t.inline&&(o=t.img.data("mask"))?(r=o.data("img"),r.hasClass("uploading")&&r.parent().length>0?(a=n/i,a=(100*a).toFixed(0),a>99&&(a=99),o.find(".progress").height(100-a+"%")):void o.remove()):void 0},500),this)),this.editor.uploader.on("uploadsuccess",function(t){return function(n,i,r){var o,a,s;if(i.inline&&(o=i.img,o.hasClass("uploading")&&o.parent().length>0)){if(o.removeData("file"),o.removeClass("uploading").removeClass("loading"),a=o.data("mask"),a&&a.remove(),o.removeData("mask"),"object"!=typeof r)try{r=e.parseJSON(r)}catch(l){n=l,r={success:!1}}return r.success===!1?(s=r.msg||t._t("uploadFailed"),alert(s),o.attr("src",t.defaultImage)):o.attr("src",r.file_path),t.popover.active&&(t.popover.srcEl.prop("disabled",!1),t.popover.srcEl.val(r.file_path)),t.editor.trigger("valuechanged"),t.editor.body.find("img.uploading").length<1?t.editor.uploader.trigger("uploadready",[i,r]):void 0}}}(this)),this.editor.uploader.on("uploaderror",function(t){return function(n,i,r){var o,a,s,l;if(i.inline&&"abort"!==r.statusText){if(r.responseText){try{l=e.parseJSON(r.responseText),s=l.msg}catch(c){n=c,s=t._t("uploadError")}alert(s)}if(o=i.img,o.hasClass("uploading")&&o.parent().length>0)return o.removeData("file"),o.removeClass("uploading").removeClass("loading"),a=o.data("mask"),a&&a.remove(),o.removeData("mask"),o.attr("src",t.defaultImage),t.popover.active&&(t.popover.srcEl.prop("disabled",!1),t.popover.srcEl.val(t.defaultImage)),t.editor.trigger("valuechanged"),t.editor.body.find("img.uploading").length<1?t.editor.uploader.trigger("uploadready",[i,l]):void 0}}}(this)))},n.prototype.status=function(e){return null!=e&&this.setDisabled(e.is(this.disableTag)),this.disabled?!0:void 0},n.prototype.loadImage=function(t,n,i){var r,o,a;return a=function(e){return function(){var n,i;return n=t.offset(),i=e.editor.wrapper.offset(),r.css({top:n.top-i.top,left:n.left-i.left,width:t.width(),height:t.height()}).show()}}(this),t.addClass("loading"),r=t.data("mask"),r||(r=e('<div class="simditor-image-loading"><div class="progress"></div></div>').hide().appendTo(this.editor.wrapper),a(),t.data("mask",r),r.data("img",t)),o=new Image,o.onload=function(e){return function(){var s,l;return t.hasClass("loading")||t.hasClass("uploading")?(l=o.width,s=o.height,t.attr({src:n,"data-image-size":l+","+s}).removeClass("loading"),t.hasClass("uploading")?(e.editor.util.reflow(e.editor.body),a()):(r.remove(),t.removeData("mask")),i(o)):void 0}}(this),o.onerror=function(){return function(){return i(!1),r.remove(),t.removeData("mask").removeClass("loading")}}(this),o.src=n},n.prototype.createImage=function(t){var n,i,r,o;return null==t&&(t="Image"),this.editor.inputManager.focused||this.editor.focus(),o=this.editor.selection.getRange(),o.deleteContents(),n=this.editor.util.closestBlockEl(),n.is("p")&&!this.editor.util.isEmptyNode(n)&&(n=e("<p/>").append(this.editor.util.phBr).insertAfter(n),this.editor.selection.setRangeAtStartOf(n,o)),i=e("<img/>").attr("alt",t),o.insertNode(i[0]),r=n.next("p"),r.length>0||(r=e("<p/>").append(this.editor.util.phBr).insertAfter(n)),this.editor.selection.setRangeAtStartOf(r),i},n.prototype.command=function(e){var t;return t=this.createImage(),this.loadImage(t,e||this.defaultImage,function(e){return function(){return e.editor.trigger("valuechanged"),e.editor.util.reflow(t),t.click(),e.popover.one("popovershow",function(){return e.popover.srcEl.focus(),e.popover.srcEl[0].select()})}}(this))},n}(a),h=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return P(n,t),n.prototype.offset={top:6,left:-4},n.prototype.render=function(){var t;return t='<div class="link-settings">\n  <div class="settings-field">\n    <label>'+this._t("imageUrl")+'</label>\n    <input class="image-src" type="text" tabindex="1" />\n    <a class="btn-upload" href="javascript:;" title="'+this._t("uploadImage")+'" tabindex="-1">\n      <span class="simditor-icon simditor-icon-upload"></span>\n    </a>\n  </div>\n  <div class="settings-field">\n    <label>'+this._t("imageSize")+'</label>\n    <input class="image-size" id="image-width" type="text" tabindex="2" />\n    <span class="times">×</span>\n    <input class="image-size" id="image-height" type="text" tabindex="3" />\n    <a class="btn-restore" href="javascript:;" title="'+this._t("restoreImageSize")+'" tabindex="-1">\n      <span class="simditor-icon simditor-icon-undo"></span>\n    </a>\n  </div>\n</div>',this.el.addClass("image-popover").append(t),this.srcEl=this.el.find(".image-src"),this.srcEl.on("keydown",function(e){return function(t){var n,i;return 13===t.which||27===t.which?(t.preventDefault(),n=function(){return e.button.editor.body.focus(),e.button.editor.selection.setRangeAfter(e.target),e.hide()},13!==t.which||e.target.hasClass("uploading")?n():(i=e.srcEl.val(),/^data:image/.test(i)&&!e.editor.uploader?void n():e.button.loadImage(e.target,i,function(t){var r;return t?/^data:image/.test(i)?(r=e.editor.util.dataURLtoBlob(i),r.name="Base64 Image.png",e.editor.uploader.upload(r,{inline:!0,img:e.target})):(n(),e.editor.trigger("valuechanged")):void 0}))):void 0}}(this)),this.widthEl=this.el.find("#image-width"),this.heightEl=this.el.find("#image-height"),this.el.find(".image-size").on("blur",function(t){return function(n){return t._resizeImg(e(n.currentTarget)),t.el.data("popover").refresh()}}(this)),this.el.find(".image-size").on("keyup",function(t){return function(n){var i;return i=e(n.currentTarget),13!==n.which&&27!==n.which&&9!==n.which?t._resizeImg(i,!0):void 0}}(this)),this.el.find(".image-size").on("keydown",function(t){return function(n){var i;return i=e(n.currentTarget),13===n.which||27===n.which?(n.preventDefault(),13===n.which?t._resizeImg(i):t._restoreImg(),t.button.editor.body.focus(),t.button.editor.selection.setRangeAfter(t.target),t.hide()):9===n.which?t.el.data("popover").refresh():void 0}}(this)),this.el.find(".btn-restore").on("click",function(e){return function(){return e._restoreImg(),e.el.data("popover").refresh()}}(this)),this.editor.on("valuechanged",function(e){return function(){return e.active?e.refresh():void 0}}(this)),this._initUploader()},n.prototype._initUploader=function(){var t,n;return t=this.el.find(".btn-upload"),null==this.editor.uploader?void t.remove():(n=function(n){return function(){return n.input&&n.input.remove(),n.input=e('<input type="file" title="'+n._t("uploadImage")+'" accept="image/*">').appendTo(t)}}(this),n(),this.el.on("click mousedown","input[type=file]",function(){return function(e){return e.stopPropagation()}}(this)),this.el.on("change","input[type=file]",function(e){return function(){return e.editor.uploader.upload(e.input,{inline:!0,img:e.target}),n()}}(this)))},n.prototype._resizeImg=function(t,n){var i,r,o;return null==n&&(n=!1),r=1*t.val(),e.isNumeric(r)||0>r?(t.is(this.widthEl)?(i=this.height*r/this.width,this.heightEl.val(i)):(o=this.width*r/this.height,this.widthEl.val(o)),n?void 0:this.target.attr({width:o||r,height:i||r})):void 0},n.prototype._restoreImg=function(){var e,t;return t=(null!=(e=this.target.data("image-size"))?e.split(","):void 0)||[this.width,this.height],this.target.attr({width:1*t[0],height:1*t[1]}),this.widthEl.val(t[0]),this.heightEl.val(t[1])},n.prototype.show=function(){var e,t;return t=1<=arguments.length?L.call(arguments,0):[],n.__super__.show.apply(this,t),e=this.target,this.width=e.width(),this.height=e.height(),e.hasClass("uploading")?this.srcEl.val(this._t("uploading")).prop("disabled",!0):(this.srcEl.val(e.attr("src")).prop("disabled",!1),this.widthEl.val(this.width),this.heightEl.val(this.height))},n}(_),T.Toolbar.addButton(p),m=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return P(t,e),t.prototype.name="indent",t.prototype.icon="indent",t.prototype._init=function(){return this.title=this._t(this.name)+" (Tab)",t.__super__._init.call(this)},t.prototype.status=function(){return!0},t.prototype.command=function(){return this.editor.util.indent()},t}(a),T.Toolbar.addButton(m),k=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return P(t,e),t.prototype.name="outdent",t.prototype.icon="outdent",t.prototype._init=function(){return this.title=this._t(this.name)+" (Shift + Tab)",t.__super__._init.call(this)},t.prototype.status=function(){return!0},t.prototype.command=function(){return this.editor.util.outdent()},t}(a),T.Toolbar.addButton(k),u=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return P(n,t),n.prototype.name="hr",n.prototype.icon="minus",n.prototype.htmlTag="hr",n.prototype.status=function(){return!0},n.prototype.command=function(){var t,n,i,r;return r=this.editor.util.furthestBlockEl(),i=r.next(),i.length>0?this.editor.selection.save():n=e("<p/>").append(this.editor.util.phBr),t=e("<hr/>").insertAfter(r),n?(n.insertAfter(t),this.editor.selection.setRangeAtStartOf(n)):this.editor.selection.restore(),this.editor.trigger("valuechanged")},n}(a),T.Toolbar.addButton(u),$=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return P(n,t),n.prototype.name="table",n.prototype.icon="table",n.prototype.htmlTag="table",n.prototype.disableTag="pre, li, blockquote",n.prototype.menu=!0,n.prototype._init=function(){return n.__super__._init.call(this),e.merge(this.editor.formatter._allowedTags,["tbody","tr","td","colgroup","col"]),e.extend(this.editor.formatter._allowedAttributes,{td:["rowspan","colspan"],col:["width"]}),this._initShortcuts(),this.editor.on("decorate",function(t){return function(n,i){return i.find("table").each(function(n,i){return t.decorate(e(i))})}}(this)),this.editor.on("undecorate",function(t){return function(n,i){return i.find("table").each(function(n,i){return t.undecorate(e(i))})}}(this)),this.editor.on("selectionchanged.table",function(t){return function(){var n,i;return t.editor.body.find(".simditor-table td").removeClass("active"),i=t.editor.selection.getRange(),null!=i?(n=e(i.commonAncestorContainer),i.collapsed&&n.is(".simditor-table")&&(n=n.find(t.editor.selection.rangeAtStartOf(n)?"td:first":"td:last"),t.editor.selection.setRangeAtEndOf(n)),n.closest("td",t.editor.body).addClass("active")):void 0}}(this)),this.editor.on("blur.table",function(e){return function(){return e.editor.body.find(".simditor-table td").removeClass("active")}}(this)),this.editor.inputManager.addKeystrokeHandler("38","td",function(e){return function(t,n){var i,r,o;return r=n.parent("tr"),i=r.prev("tr"),i.length>0?(o=r.find("td").index(n),e.editor.selection.setRangeAtEndOf(i.find("td").eq(o)),!0):!0}}(this)),this.editor.inputManager.addKeystrokeHandler("40","td",function(e){return function(t,n){var i,r,o;return r=n.parent("tr"),i=r.next("tr"),i.length>0?(o=r.find("td").index(n),e.editor.selection.setRangeAtEndOf(i.find("td").eq(o)),!0):!0}}(this))},n.prototype.initResize=function(t){var n,i,r;return r=t.parent(".simditor-table"),n=t.find("colgroup"),n.length<1&&(n=e("<colgroup/>").prependTo(t),t.find("tr:first td").each(function(){return function(){var t;return t=e("<col/>").appendTo(n)}}(this)),this.refreshTableWidth(t)),i=e('<div class="simditor-resize-handle" contenteditable="false"></div>').appendTo(r),r.on("mousemove","td",function(){return function(t){var o,a,s,l,c,d;return r.hasClass("resizing")?void 0:(a=e(t.currentTarget),d=t.pageX-e(t.currentTarget).offset().left,5>d&&a.prev().length>0&&(a=a.prev()),a.next("td").length<1?void i.hide():(null!=(l=i.data("td"))?l.is(a):void 0)?void i.show():(s=a.parent().find("td").index(a),o=n.find("col").eq(s),(null!=(c=i.data("col"))?c.is(o):void 0)?void i.show():i.css("left",a.position().left+a.outerWidth()-5).data("td",a).data("col",o).show()))}}(this)),r.on("mouseleave",function(){return function(){return i.hide()}}(this)),r.on("mousedown",".simditor-resize-handle",function(){return function(t){var n,i,o,a,s,l,c,d,u,p,h;return n=e(t.currentTarget),o=n.data("td"),i=n.data("col"),s=o.next("td"),a=i.next("col"),p=t.pageX,d=1*o.outerWidth(),u=1*s.outerWidth(),c=parseFloat(n.css("left")),h=o.closest("table").width(),l=50,e(document).on("mousemove.simditor-resize-table",function(e){var t,r,o;return t=e.pageX-p,r=d+t,o=u-t,l>r?(r=l,t=l-d,o=u-t):l>o&&(o=l,t=u-l,r=d+t),i.attr("width",r/h*100+"%"),a.attr("width",o/h*100+"%"),n.css("left",c+t)}),e(document).one("mouseup.simditor-resize-table",function(){return e(document).off(".simditor-resize-table"),r.removeClass("resizing")}),r.addClass("resizing"),!1}}(this))},n.prototype._initShortcuts=function(){return this.editor.inputManager.addShortcut("ctrl+alt+up",function(e){return function(){return e.editMenu.find(".menu-item[data-param=insertRowAbove]").click(),!1}}(this)),this.editor.inputManager.addShortcut("ctrl+alt+down",function(e){return function(){return e.editMenu.find(".menu-item[data-param=insertRowBelow]").click(),!1}}(this)),this.editor.inputManager.addShortcut("ctrl+alt+left",function(e){return function(){return e.editMenu.find(".menu-item[data-param=insertColLeft]").click(),!1}}(this)),this.editor.inputManager.addShortcut("ctrl+alt+right",function(e){return function(){return e.editMenu.find(".menu-item[data-param=insertColRight]").click(),!1}}(this))},n.prototype.decorate=function(e){return e.parent(".simditor-table").length>0&&this.undecorate(e),e.wrap('<div class="simditor-table"></div>'),this.initResize(e),e.parent()},n.prototype.undecorate=function(e){return e.parent(".simditor-table").length>0?e.parent().replaceWith(e):void 0},n.prototype.renderMenu=function(){return e('<div class="menu-create-table">\n</div>\n<div class="menu-edit-table">\n  <ul>\n    <li><a tabindex="-1" unselectable="on" class="menu-item" href="javascript:;" data-param="deleteRow"><span>'+this._t("deleteRow")+'</span></a></li>\n    <li><a tabindex="-1" unselectable="on" class="menu-item" href="javascript:;" data-param="insertRowAbove"><span>'+this._t("insertRowAbove")+' ( Ctrl + Alt + ↑ )</span></a></li>\n    <li><a tabindex="-1" unselectable="on" class="menu-item" href="javascript:;" data-param="insertRowBelow"><span>'+this._t("insertRowBelow")+' ( Ctrl + Alt + ↓ )</span></a></li>\n    <li><span class="separator"></span></li>\n    <li><a tabindex="-1" unselectable="on" class="menu-item" href="javascript:;" data-param="deleteCol"><span>'+this._t("deleteColumn")+'</span></a></li>\n    <li><a tabindex="-1" unselectable="on" class="menu-item" href="javascript:;" data-param="insertColLeft"><span>'+this._t("insertColumnLeft")+' ( Ctrl + Alt + ← )</span></a></li>\n    <li><a tabindex="-1" unselectable="on" class="menu-item" href="javascript:;" data-param="insertColRight"><span>'+this._t("insertColumnRight")+' ( Ctrl + Alt + → )</span></a></li>\n    <li><span class="separator"></span></li>\n    <li><a tabindex="-1" unselectable="on" class="menu-item" href="javascript:;" data-param="deleteTable"><span>'+this._t("deleteTable")+"</span></a></li>\n  </ul>\n</div>").appendTo(this.menuWrapper),this.createMenu=this.menuWrapper.find(".menu-create-table"),this.editMenu=this.menuWrapper.find(".menu-edit-table"),this.createTable(6,6).appendTo(this.createMenu),this.createMenu.on("mouseenter","td",function(t){return function(n){var i,r,o;return t.createMenu.find("td").removeClass("selected"),i=e(n.currentTarget),r=i.parent(),o=r.find("td").index(i)+1,r.prevAll("tr").addBack().find("td:lt("+o+")").addClass("selected")}}(this)),this.createMenu.on("mouseleave",function(){return function(t){return e(t.currentTarget).find("td").removeClass("selected")}}(this)),this.createMenu.on("mousedown","td",function(t){return function(n){var i,r,o,a,s,l;return t.wrapper.removeClass("menu-on"),t.editor.inputManager.focused?(o=e(n.currentTarget),a=o.parent(),s=a.find("td").index(o)+1,l=a.prevAll("tr").length+1,r=t.createTable(l,s,!0),i=t.editor.util.closestBlockEl(),t.editor.util.isEmptyNode(i)?i.replaceWith(r):i.after(r),t.decorate(r),t.editor.selection.setRangeAtStartOf(r.find("td:first")),t.editor.trigger("valuechanged"),!1):void 0}}(this))},n.prototype.createTable=function(t,n,i){var r,o,a,s,l,c,d,u,p,h;for(r=e("<table/>"),o=e("<tbody/>").appendTo(r),u=c=0,p=t;p>=0?p>c:c>p;u=p>=0?++c:--c)for(s=e("<tr/>").appendTo(o),l=d=0,h=n;h>=0?h>d:d>h;l=h>=0?++d:--d)a=e("<td/>").appendTo(s),i&&a.append(this.editor.util.phBr);return r},n.prototype.refreshTableWidth=function(t){var n,i;return i=t.width(),n=t.find("col"),t.find("tr:first td").each(function(){return function(t,r){var o;return o=n.eq(t),o.attr("width",e(r).outerWidth()/i*100+"%")}}(this))},n.prototype.setActive=function(e){return n.__super__.setActive.call(this,e),e?(this.createMenu.hide(),this.editMenu.show()):(this.createMenu.show(),this.editMenu.hide())},n.prototype.deleteRow=function(e){var t,n,i;return n=e.parent("tr"),n.siblings("tr").length<1?this.deleteTable(e):(t=n.next("tr"),t.length>0||(t=n.prev("tr")),i=n.find("td").index(e),n.remove(),this.editor.selection.setRangeAtEndOf(t.find("td").eq(i)))},n.prototype.insertRow=function(t,n){var i,r,o,a,s,l,c,d;for(null==n&&(n="after"),o=t.parent("tr"),r=o.closest("table"),a=0,r.find("tr").each(function(){return function(t,n){return a=Math.max(a,e(n).find("td").length)}}(this)),i=e("<tr/>"),s=c=1,d=a;d>=1?d>=c:c>=d;s=d>=1?++c:--c)e("<td/>").append(this.editor.util.phBr).appendTo(i);return o[n](i),l=o.find("td").index(t),this.editor.selection.setRangeAtStartOf(i.find("td").eq(l))},n.prototype.deleteCol=function(t){var n,i,r,o;return r=t.parent("tr"),r.siblings("tr").length<1&&t.siblings("td").length<1?this.deleteTable(t):(o=r.find("td").index(t),n=t.next("td"),n.length>0||(n=r.prev("td")),i=r.closest("table"),i.find("col").eq(o).remove(),i.find("tr").each(function(){return function(t,n){return e(n).find("td").eq(o).remove()}}(this)),this.refreshTableWidth(i),this.editor.selection.setRangeAtEndOf(n))},n.prototype.insertCol=function(t,n){var i,r,o,a,s,l,c,d;return null==n&&(n="after"),s=t.parent("tr"),l=s.find("td").index(t),a=t.closest("table"),i=a.find("col").eq(l),a.find("tr").each(function(t){return function(i,r){var o;return o=e("<td/>").append(t.editor.util.phBr),e(r).find("td").eq(l)[n](o)}}(this)),r=e("<col/>"),i[n](r),c=a.width(),d=Math.max(parseFloat(i.attr("width"))/2,50/c*100),i.attr("width",d+"%"),r.attr("width",d+"%"),this.refreshTableWidth(a),o="after"===n?t.next("td"):t.prev("td"),this.editor.selection.setRangeAtStartOf(o)},n.prototype.deleteTable=function(e){var t,n;return n=e.closest(".simditor-table"),t=n.next("p"),n.remove(),t.length>0?this.editor.selection.setRangeAtStartOf(t):void 0},n.prototype.command=function(t){var n,i;if(i=this.editor.selection.getRange(),n=e(i.commonAncestorContainer).closest("td"),n.length>0){if("deleteRow"===t)this.deleteRow(n);else if("insertRowAbove"===t)this.insertRow(n,"before");else if("insertRowBelow"===t)this.insertRow(n);else if("deleteCol"===t)this.deleteCol(n);else if("insertColLeft"===t)this.insertCol(n,"before");else if("insertColRight"===t)this.insertCol(n);else{if("deleteTable"!==t)return;this.deleteTable(n)}return this.editor.trigger("valuechanged")}},n}(a),T.Toolbar.addButton($),A=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return P(n,t),n.prototype.name="strikethrough",n.prototype.icon="strikethrough",n.prototype.htmlTag="strike",n.prototype.disableTag="pre",n.prototype.status=function(e){var t;return null!=e&&this.setDisabled(e.is(this.disableTag)),this.disabled?!0:(t=document.queryCommandState("strikethrough")===!0,this.setActive(t),t)},n.prototype.command=function(){return document.execCommand("strikethrough"),this.editor.util.support.oninput||this.editor.trigger("valuechanged"),e(document).trigger("selectionchange")},n}(a),T.Toolbar.addButton(A),T})},function(e,t,n){var i,r;!function(o,a){i=[n(33)],r=function(e){return o.returnExportsGlobal=a(e)}.apply(t,i),!(void 0!==r&&(e.exports=r))}(this,function(e){var t,n=[].slice;return t=function(){function t(t){var n,i,r,o,a,s,l;if(this.opts=e.extend({},this.opts,t),(a=this.constructor)._connectedClasses||(a._connectedClasses=[]),r=function(){var e,t,i,r;for(i=this.constructor._connectedClasses,r=[],e=0,t=i.length;t>e;e++)n=i[e],o=n.pluginName.charAt(0).toLowerCase()+n.pluginName.slice(1),n.prototype._connected&&(n.prototype._module=this),r.push(this[o]=new n);return r}.call(this),this._connected)this.opts=e.extend({},this.opts,this._module.opts);else for(this._init(),s=0,l=r.length;l>s;s++)i=r[s],"function"==typeof i._init&&i._init();this.trigger("initialized")}return t.extend=function(e){var t,n,i;if(null!=e&&"object"==typeof e){for(t in e)n=e[t],"included"!==t&&"extended"!==t&&(this[t]=n);return null!=(i=e.extended)?i.call(this):void 0}},t.include=function(e){var t,n,i;if(null!=e&&"object"==typeof e){for(t in e)n=e[t],"included"!==t&&"extended"!==t&&(this.prototype[t]=n);return null!=(i=e.included)?i.call(this):void 0}},t.connect=function(e){if("function"==typeof e){if(!e.pluginName)throw new Error("Module.connect: cannot connect plugin without pluginName");return e.prototype._connected=!0,this._connectedClasses||(this._connectedClasses=[]),this._connectedClasses.push(e),e.pluginName?this[e.pluginName]=e:void 0}},t.prototype.opts={},t.prototype._init=function(){},t.prototype.on=function(){var t,i;return t=1<=arguments.length?n.call(arguments,0):[],(i=e(this)).on.apply(i,t),this},t.prototype.one=function(){var t,i;return t=1<=arguments.length?n.call(arguments,0):[],(i=e(this)).one.apply(i,t),this},t.prototype.off=function(){var t,i;return t=1<=arguments.length?n.call(arguments,0):[],(i=e(this)).off.apply(i,t),this},t.prototype.trigger=function(){var t,i;return t=1<=arguments.length?n.call(arguments,0):[],(i=e(this)).trigger.apply(i,t),this},t.prototype.triggerHandler=function(){var t,i;return t=1<=arguments.length?n.call(arguments,0):[],(i=e(this)).triggerHandler.apply(i,t)},t.prototype._t=function(){var e,t;return e=1<=arguments.length?n.call(arguments,0):[],(t=this.constructor)._t.apply(t,e)},t._t=function(){var e,t,i,r;return t=arguments[0],e=2<=arguments.length?n.call(arguments,1):[],i=(null!=(r=this.i18n[this.locale])?r[t]:void 0)||"",e.length>0?(i=i.replace(/([^%]|^)%(?:(\d+)\$)?s/g,function(t,n,i){return i?n+e[parseInt(i)-1]:n+e.shift()}),i.replace(/%%s/g,"%s")):i},t.i18n={"zh-CN":{}},t.locale="zh-CN",t}()})},function(e,t,n){var i,r;!function(o,a){i=[n(33),n(123)],r=function(e,t){return o.returnExportsGlobal=a(e,t)}.apply(t,i),!(void 0!==r&&(e.exports=r))}(this,function(e,t){var n,i,r={}.hasOwnProperty,o=function(e,t){function n(){this.constructor=e}for(var i in t)r.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};return n=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return o(n,t),n.count=0,n.keyNameMap={8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Spacebar",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",45:"Insert",46:"Del",91:"Meta",93:"Meta",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"Multiply",107:"Add",109:"Subtract",110:"Decimal",111:"Divide",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",124:"F13",125:"F14",126:"F15",127:"F16",128:"F17",129:"F18",130:"F19",131:"F20",132:"F21",133:"F22",134:"F23",135:"F24",59:";",61:"=",186:";",187:"=",188:",",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},n.aliases={escape:"esc","delete":"del","return":"enter",ctrl:"control",space:"spacebar",ins:"insert",cmd:"meta",command:"meta",wins:"meta",windows:"meta"},n.normalize=function(e){var t,n,i,r,o,a;for(r=e.toLowerCase().replace(/\s+/gi,"").split("+"),t=o=0,a=r.length;a>o;t=++o)n=r[t],r[t]=this.aliases[n]||n;return i=r.pop(),r.sort().push(i),r.join("_")},n.prototype.opts={el:document},n.prototype._init=function(){return this.id=++this.constructor.count,this._map={},this._delegate="string"==typeof this.opts.el?document:this.opts.el,e(this._delegate).on("keydown.simple-hotkeys-"+this.id,this.opts.el,function(e){
return function(t){var n;return null!=(n=e._getHander(t))?n.call(e,t):void 0}}(this))},n.prototype._getHander=function(e){var t,n;if(t=this.constructor.keyNameMap[e.which])return n="",e.altKey&&(n+="alt_"),e.ctrlKey&&(n+="control_"),e.metaKey&&(n+="meta_"),e.shiftKey&&(n+="shift_"),n+=t.toLowerCase(),this._map[n]},n.prototype.respondTo=function(e){return"string"==typeof e?null!=this._map[this.constructor.normalize(e)]:null!=this._getHander(e)},n.prototype.add=function(e,t){return this._map[this.constructor.normalize(e)]=t,this},n.prototype.remove=function(e){return delete this._map[this.constructor.normalize(e)],this},n.prototype.destroy=function(){return e(this._delegate).off(".simple-hotkeys-"+this.id),this._map={},this},n}(t),i=function(e){return new n(e)}})},function(e,t,n){var i,r;!function(o,a){i=[n(33),n(123)],r=function(e,t){return o.returnExportsGlobal=a(e,t)}.apply(t,i),!(void 0!==r&&(e.exports=r))}(this,function(e,t){var n,i,r={}.hasOwnProperty,o=function(e,t){function n(){this.constructor=e}for(var i in t)r.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};return n=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return o(n,t),n.count=0,n.prototype.opts={url:"",params:null,fileKey:"upload_file",connectionCount:3},n.prototype._init=function(){return this.files=[],this.queue=[],this.id=++n.count,this.on("uploadcomplete",function(t){return function(n,i){return t.files.splice(e.inArray(i,t.files),1),t.queue.length>0&&t.files.length<t.opts.connectionCount?t.upload(t.queue.shift()):t.uploading=!1}}(this)),e(window).on("beforeunload.uploader-"+this.id,function(e){return function(t){return e.uploading?(t.originalEvent.returnValue=e._t("leaveConfirm"),e._t("leaveConfirm")):void 0}}(this))},n.prototype.generateId=function(){var e;return e=0,function(){return e+=1}}(),n.prototype.upload=function(t,n){var i,r,o,a;if(null==n&&(n={}),null!=t){if(e.isArray(t)||t instanceof FileList)for(o=0,a=t.length;a>o;o++)i=t[o],this.upload(i,n);else e(t).is("input:file")?(r=e(t).attr("name"),r&&(n.fileKey=r),this.upload(e.makeArray(e(t)[0].files),n)):t.id&&t.obj||(t=this.getFile(t));if(t&&t.obj){if(e.extend(t,n),this.files.length>=this.opts.connectionCount)return void this.queue.push(t);if(this.triggerHandler("beforeupload",[t])!==!1)return this.files.push(t),this._xhrUpload(t),this.uploading=!0}}},n.prototype.getFile=function(e){var t,n,i;return e instanceof window.File||e instanceof window.Blob?(t=null!=(n=e.fileName)?n:e.name,{id:this.generateId(),url:this.opts.url,params:this.opts.params,fileKey:this.opts.fileKey,name:t,size:null!=(i=e.fileSize)?i:e.size,ext:t?t.split(".").pop().toLowerCase():"",obj:e}):null},n.prototype._xhrUpload=function(t){var n,i,r,o;if(n=new FormData,n.append(t.fileKey,t.obj),n.append("original_filename",t.name),t.params){o=t.params;for(i in o)r=o[i],n.append(i,r)}return t.xhr=e.ajax({url:t.url,data:n,processData:!1,contentType:!1,type:"POST",headers:{"X-File-Name":encodeURIComponent(t.name)},xhr:function(){var t;return t=e.ajaxSettings.xhr(),t&&(t.upload.onprogress=function(e){return function(t){return e.progress(t)}}(this)),t},progress:function(e){return function(n){return n.lengthComputable?e.trigger("uploadprogress",[t,n.loaded,n.total]):void 0}}(this),error:function(e){return function(n,i,r){return e.trigger("uploaderror",[t,n,i])}}(this),success:function(n){return function(i){return n.trigger("uploadprogress",[t,t.size,t.size]),n.trigger("uploadsuccess",[t,i]),e(document).trigger("uploadsuccess",[t,i,n])}}(this),complete:function(e){return function(n,i){return e.trigger("uploadcomplete",[t,n.responseText])}}(this)})},n.prototype.cancel=function(e){var t,n,i,r;if(!e.id)for(r=this.files,n=0,i=r.length;i>n;n++)if(t=r[n],t.id===1*e){e=t;break}return this.trigger("uploadcancel",[e]),e.xhr&&e.xhr.abort(),e.xhr=null},n.prototype.readImageFile=function(t,n){var i,r;if(e.isFunction(n))return r=new Image,r.onload=function(){return n(r)},r.onerror=function(){return n()},window.FileReader&&FileReader.prototype.readAsDataURL&&/^image/.test(t.type)?(i=new FileReader,i.onload=function(e){return r.src=e.target.result},i.readAsDataURL(t)):n()},n.prototype.destroy=function(){var t,n,i,r;for(this.queue.length=0,r=this.files,n=0,i=r.length;i>n;n++)t=r[n],this.cancel(t);return e(window).off(".uploader-"+this.id),e(document).off(".uploader-"+this.id)},n.i18n={"zh-CN":{leaveConfirm:"正在上传文件，如果离开上传会自动取消"}},n.locale="zh-CN",n}(t),i=function(e){return new n(e)}})},function(e,t,n){var i,r,o,a=function(e,t){function n(){this.constructor=e}for(var i in t)s.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},s={}.hasOwnProperty;!function(a){return r=[n(122)],i=a,o="function"==typeof i?i.apply(t,r):i,!(void 0!==o&&(e.exports=o))}(function(e){var t;return t=function(e){function t(){this.isExpand=!1,t.__super__.constructor.apply(this,arguments)}return a(t,e),t.prototype._init=function(){return this.shortcut="esc",t.__super__._init.apply(this,arguments),this.setIcon("expand")},t.prototype.name="fullscreen",t.prototype.title="full-screen",t.prototype.saveStatus=function(){var e,t,n,i;return t=this.editor.el,i=this.editor.wrapper,n=this.editor.toolbar,e=this.editor.body,this.cssStatus={el:{position:t.css("position"),left:t.css("left"),right:t.css("right"),top:t.css("top"),bottom:t.css("bottom")},wrapper:i.css("height"),toolbar:{wrapper:{width:n.wrapper.css("width")}},body:{maxHeight:e.css("maxHeight"),overflow:e.css("overflow")}}},t.prototype.setIcon=function(e){return this.el.find("span").removeClass().addClass("fa fa-"+e)},t.prototype.resetStatus=function(){return this.editor.el.css(this.cssStatus.el),this.editor.wrapper.css(this.cssStatus.wrapper),this.editor.toolbar.wrapper.css(this.cssStatus.toolbar.wrapper),this.editor.body.css(this.cssStatus.body)},t.prototype.doFullScreen=function(){var e,t;return this.editor.el.css("position","fixed").css("left","9px").css("right","9px").css("top","9px").css("bottom","9px").css("z-index","9999"),this.editor.wrapper.css("height","100%"),this.editor.toolbar.wrapper.css("width","100%"),e=this.editor.toolbar.wrapper.height(),t=this.editor.wrapper.height(),this.editor.body.css("maxHeight",t-e-70+"px").css("overflow","auto")},t.prototype.command=function(){return this.isExpand?(this.setIcon("expand"),this.resetStatus(),void(this.isExpand=!1)):(this.setIcon("compress"),this.saveStatus(),this.isExpand=!0,this.doFullScreen())},t}(e.Button),e.Toolbar.addButton(t)})},function(e,t,n){var i,r,o;(function(a){var s=function(e,t){function n(){this.constructor=e}for(var i in t)l.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},l={}.hasOwnProperty;!function(a){return r=[n(83),n(122)],i=a,o="function"==typeof i?i.apply(t,r):i,!(void 0!==o&&(e.exports=o))}(function(e,t){var n;return n=function(t){function n(){if(n.__super__.constructor.apply(this,arguments),this.marked=e,!e)throw new Error("cannot find the plugin marked")}return s(n,t),n.prototype.name="marked",n.prototype.title="marked",n.prototype.icon="maxcdn",n.prototype.shortcut="ctrl+77",n.prototype.decodeHTML=function(e){var t;return t=document.createElement("div"),t.innerHTML=e,t.innerText},n.prototype.encodeHTML=function(e){var t;return t=document.createElement("div"),t.appendChild(document.createTextNode(e)),t.innerHTML},n.prototype.decodeCodes=function(e){var t,n,i,r,o,a;for(i=document.createElement("div"),i.innerHTML=e,n=i.querySelectorAll("code"),r=0,o=n.length;o>r;r++)t=n[r],a=this.decodeHTML(t.innerText),t.innerText=a;return i.innerHTML},n.prototype.replaceSelection=function(e,t){var n,i,r,o,a,s,l;if(null==t&&(t=!0),l=window.getSelection(),l.getRangeAt&&l.rangeCount){if(s=window.getSelection().getRangeAt(0),s.deleteContents(),s.createContextualFragment)o=s.createContextualFragment(e);else for(i=document.createElement("div"),i.innerHTML=e,o=document.createDocumentFragment();n=i.firstChild;)o.appendChild(n);if(r=o.firstChild,a=o.lastChild,s.insertNode(o),t)return r&&(s.setStartBefore(r),s.setEndAfter(a)),l.removeAllRanges(),l.addRange(s)}},n.prototype.doReplaceSelction=function(e){var t;return t=this.marked(this.encodeHTML(e)),t=this.decodeCodes(t),this.replaceSelection(t)},n.prototype.doReplaceAll=function(){var e;return e=this.editor.getValue(),e=e.replace(/<p>/g,"").replace(/<\/p>/g,"\n"),e=this.marked(e),e=this.decodeCodes(e),this.editor.setValue(e)},n.prototype.command=function(){var e;return e=window.getSelection().toString(),0===e.length?this.doReplaceAll():this.doReplaceSelction(e),this.editor.selection.setRangeAtEndOf("p")},n}(t.Button),a.Toolbar.addButton(n)})}).call(t,n(122))},function(e,t){var n,i=window.angular;try{n=i.module(["ng"])}catch(r){n=i.module("ng",[])}var o='<div class="editor"> <div class="profile back" dropdown ng-show="backList && backList.length > 0 && false"> <span>回滚版本</span> <div class="dropdown dropdown-tip"> <ul class="dropdown-menu"> <li ng-repeat="item in backList" ng-click="onClickChoose(item.key)"> <a class="text-overflow" href="javascript:" title="{{item.value}}"><i class="blue">{{item.time|timeAgo}}</i>&nbsp;&nbsp;{{item.value|rawText}}</a> </li> </ul> </div> </div> <textarea rows="10" placeholder="这里输入内容" autofocus></textarea> <div class="control"> <div class="left"> <button class="cancel default" ng-click="onClickCancel()">取&nbsp;&nbsp;消</button> </div> <div class="right"> <button class="primary default" ng-click="onClickSubmit()">提&nbsp;&nbsp;交</button>\n<a ng-click="onClickBack()"><i class="icon small"></i>历史版本</a> </div> </div> </div>';n.run(["$templateCache",function(e){e.put("editor.html",o)}]),e.exports=o},function(e,t,n){var i,r;i=[n(34),n(35),n(44),n(57),n(69),n(78),n(84),n(51),n(46),n(115),n(75),n(130),n(100),n(104),n(131)],r=function(e,t,i,r,o,a,s,l,c,d,u,p,h,m,f){return t.config(["$routeProvider","$locationProvider","$stateProvider","$urlRouterProvider",function(e,t,g,v){var b,y,w,x,k,_,C,T,j,A,$,S,M,N,E,D,I,P,R,B,L,O;return t.html5Mode({enabled:!0,requireBase:!1}),D={issueDetails:n(132),home:n(133)},w={template:i.extractTemplate("#tmpl-global-blank-page",d),controller:function(){}},M={template:i.extractTemplate("#tmpl-stream-list",m),controller:"streamListController"},$={listPanel:{template:i.extractTemplate("#tmpl-issue-list",r),controller:"issueListController"},"detailsPanel@project":{template:D.issueDetails,controller:"issueDetailsController"},"detailsPanel@myproject":{template:D.issueDetails,controller:"issueDetailsController"},"detailsPanel@myfollow":{template:D.issueDetails,controller:"issueDetailsController"}},A={"listPanel@project":$.listPanel,"listPanel@myproject":$.listPanel,"listPanel@myfollow":$.listPanel,"detailsPanel@project":w,"detailsPanel@myproject":M,"detailsPanel@myfollow":M},C={"listPanel@project":{template:i.extractTemplate("#tmpl-document-list",r),controller:"documentListController"},detailsPanel:w},T={listPanel:C["listPanel@project"],"detailsPanel@project":$["detailsPanel@project"]},I={"listPanel@project":{template:i.extractTemplate("#tmpl-test-list",r),controller:"testListController"},detailsPanel:w},P={listPanel:I["listPanel@project"],"detailsPanel@project":$["detailsPanel@project"]},_={listPanel:{template:i.extractTemplate("#tmpl-discussion-list",r),controller:"discussionListController"},"detailsPanel@project":{template:D.issueDetails,controller:"issueDetailsController"}},k={listPanel:_.listPanel,detailsPanel:w},R={listPanel:{template:i.extractTemplate("#tmpl-report-weekly-list",c),controller:"weeklyReportListController"},detailsPanel:w},B={listPanel:R.listPanel,"detailsPanel@project":{template:i.extractTemplate("#tmpl-report-weekly-details",c),controller:"reportWeeklyDetailsController"},"detailsPanel@report":{template:i.extractTemplate("#tmpl-report-weekly-details",c),controller:"reportWeeklyDetailsController"}},S={"listPanel@project":{template:i.extractTemplate("#tmpl-project-member-list",o)},detailsPanel:w},x={"listPanel@project":{template:i.extractTemplate("#tmpl-commit-list",a),controller:"commitListController"},detailsPanel:w},j={"listPanel@project":{template:i.extractTemplate("#tmpl-gitlab-details",f),controller:"gitlabController"},detailsPanel:w},b={listPanel:{template:i.extractTemplate("#tmpl-assets-list",s),controller:"assetsListController"},detailsPanel:w},y={listPanel:b.listPanel,"detailsPanel@project":{template:i.extractTemplate("#tmpl-assets-details",s),controller:"assetsDetailsController"}},O={listPanel:{template:i.extractTemplate("#tmpl-wiki-list",p),controller:"issueListController"},"detailsPanel@wiki":$["detailsPanel@project"]},L={listPanel:O.listPanel,"detailsPanel@wiki":w},E={listPanel:{template:i.extractTemplate("#tmpl-team-member-list",h)},detailsPanel:w},N={listPanel:{template:i.extractTemplate("#tmpl-team-invite-list",h)},detailsPanel:w},v.otherwise("/myproject/all/issue/myself"),g.state("home",{url:"/",template:D.home,controller:"homeController"}).state("login",{url:"/login",template:i.extractTemplate("#tmpl-member-authority",u),controller:"loginController"}).state("invite",{url:"/invite/:token",template:i.extractTemplate("#tmpl-member-authority",u),controller:"loginController"}).state("project",{"abstract":!0,url:"/project/:project_id",template:i.extractTemplate("#tmpl-project-layout",l),controller:"projectController"}).state("project.issue",{url:"/issue",views:A}).state("project.issue.details",{url:"/{issue_id:\\d+}",views:$}).state("project.version",{url:"/version/:version_id","abstract":!0}).state("project.issue_category",{url:"/category/:category_id/issue",views:{listPanel:$.listPanel}}).state("project.issue_category.details",{url:"/{issue_id:\\d+}",views:$}).state("project.version_category_issue",{url:"/version/:version_id/category/:category_id/issue",views:A}).state("project.version_category_issue.details",{url:"/{issue_id:\\d+}",views:$}).state("project.version_issue",{url:"/version/:version_id/issue",views:A}).state("project.version_issue.details",{url:"/{issue_id:\\d+}",views:$}).state("project.my_issue",{url:"/issue/{myself:myself}",views:A}).state("project.my_issue.details",{url:"/{issue_id:\\d+}",views:$}).state("project.version.my_issue",{url:"/issue/{myself:myself}",views:A}).state("project.version.my_issue.details",{url:"/{issue_id:\\d+}",views:$}).state("project.weekly_report",{url:"/weekly-report",views:R}).state("project.weekly_report.details",{url:"/{start_time}~{end_time}",views:B}).state("project.version_weekly_report",{url:"/version/:version_id/weekly-report",views:R}).state("project.version_weekly_report.details",{url:"/{start_time}~{end_time}",views:B}).state("project.member",{url:"/member",views:S}).state("project.version.member",{url:"/member",views:S}).state("project.commit",{url:"/commit",views:x}).state("project.version.commit",{url:"/commit",views:x}).state("project.gitlab",{url:"/gitlab",views:j}).state("project.version.gitlab",{url:"/gitlab",views:j}).state("project.version.commit.details",{url:"/:commit_id?url",views:{"detailsPanel@project":{template:i.extractTemplate("#tmpl-commit-details",a),controller:"commitDetailsController"}}}).state("project.discussion",{url:"/discussion",views:k}).state("project.discussion.details",{url:"/{issue_id:\\d+}",data:{articleOnly:!0},views:_}).state("project.version_discussion",{url:"/version/:version_id/discussion",views:k}).state("project.version_discussion.details",{url:"/{issue_id:\\d+}",data:{articleOnly:!0},views:_}).state("project.document",{url:"/document",views:C}).state("project.version.document",{url:"/document",views:C}).state("project.version.document.details",{url:"/:issue_id",data:{articleOnly:!0},views:T}).state("project.document.details",{url:"/:issue_id",data:{articleOnly:!0},views:T}).state("project.test",{url:"/test",views:I}).state("project.version.test",{url:"/test",views:I}).state("project.version.test.details",{url:"/:issue_id",views:P}).state("project.test.details",{url:"/:issue_id",views:P}).state("project.assets",{url:"/assets",views:b}).state("project.version_assets",{url:"/version/:version_id/assets",views:b}).state("project.version_assets.previewer",{url:"/previewer/:asset_id",views:y}).state("project.assets.previewer",{url:"/previewer/:asset_id",views:y}).state("wiki",{"abstract":!0,url:"/wiki/:project_id",template:i.extractTemplate("#tmpl-wiki-layout",p),controller:"projectController"}).state("wiki.list",{url:"/issue",data:{wiki:!0},views:L}).state("wiki.list_category",{url:"/category/:category_id/issue",data:{wiki:!0},views:L}).state("wiki.list.details",{url:"/{issue_id:\\d+}",data:{wiki:!0,articleOnly:!0},views:O}).state("wiki.list_category.details",{url:"/{issue_id:\\d+}",data:{wiki:!0,articleOnly:!0},views:O}).state("team",{"abstract":!0,url:"/team/:team_id",template:i.extractTemplate("#tmpl-team-layout",h),controller:"teamController"}).state("team.list",{url:"/list",views:E}).state("team.invite",{url:"/invite",views:N}).state("report",{"abstract":!0,url:"/report/:team_id",template:i.extractTemplate("#tmpl-report-layout",c),controller:"reportController"}).state("report.list",{url:"/weekly-report",views:R}).state("report.list.details",{url:"/{start_time}~{end_time}",views:B}).state("myproject",{"abstract":!0,url:"/myproject",template:i.extractTemplate("#tmpl-my-project-layout",l),controller:"myProjectController"}).state("myproject.list",{url:"/:project_id"}).state("myproject.list.issue",{url:"/issue/{myself:myself}",views:A}).state("myproject.list.issue.details",{url:"/{issue_id:\\d+}",views:$}).state("myfollow",{"abstract":!0,url:"/myfollow",template:i.extractTemplate("#tmpl-my-follow-layout",l),controller:"myFollowController"}).state("myfollow.list",{url:"/:project_id"}).state("myfollow.list.issue",{url:"/issue/{follow:follow}",views:A}).state("myfollow.list.issue.details",{url:"/{issue_id:\\d+}",views:$})}]),t.run(function(e,t,n,i){return e.$on("$stateChangeStart",function(t,r,o,a,s){return e.__member?void 0:(t.preventDefault(),i.session().retrieve().then(function(t){return e.__member=t,n.go(r,o)}))})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t){var n,i=window.angular;try{n=i.module(["ng"])}catch(r){n=i.module("ng",[])}var o='<div>  <textarea id="tmpl-wiki-layout">\n        <div class="frame project-view wiki-view">\n            <global-message ng-show="false"></global-message>\n            <header-global></header-global>\n            <div class="container">\n                \n                <div class="master-panel">\n                    \n                    <div class="project-menu">\n                        <ul class="master-menu" project-menu-highlight>\n                            <li class="issue-category">\n                                <div class="inner">\n                                    <div class="title">\n                                        <label>\n                                            <a href="/{{project | projectLink}}/issue">全部</a>\n                                        </label>\n                                    </div>\n                                    <project-category-menu data-project-id="{{project.id}}"></project-category-menu>\n                                </div>\n                            </li>\n                        </ul>\n                        <project-menu-bar></project-menu-bar>\n                    </div>\n                </div>\n\n\n                <project-salve-panel></project-salve-panel>\n            </div>\n        </div>\n    </textarea>   <textarea id="tmpl-wiki-list">\n        <div class="issue-list list">\n            <h3>{{title}}<span class="badge">({{undoneIssues.pagination.recordCount}})</span></h3>\n            <div class="create">\n                <input type="text" placeholder="来，想说点什么？" autofocus issue-quick-editor ng-keydown="onKeyDown($event)" data-category="1" ng-show="showQuickEditor" data-tag="issue"/>\n            </div>\n\n            \n            <div class="list">\n                <ul class="details">\n                    <li ng-repeat="issue in undoneIssues.items" class="row" id="issue-list-{{issue.id}}">\n                        <issue-list-cell></issue-list-cell>\n                    </li>\n                </ul>\n\n                <div ng-show="undoneIssues.items.length == 0" class="empty">\n                    咦，这里面好像什么都没有呢\n                </div>\n            </div>\n        </div>\n    </textarea> </div>';n.run(["$templateCache",function(e){e.put("wiki-all.html",o)}]),e.exports=o},function(e,t){var n,i=window.angular;try{n=i.module(["ng"])}catch(r){n=i.module("ng",[])}var o='<div> <textarea id="tmpl-gitlab-details">\n        <div class="gitlab-panel">\n            <gitlab-list bean="bean" name="gitlab"></gitlab-list>\n            <gitlab-add-to-project bean="bean" name="gitlab_add_form"></gitlab-add-to-project>\n            <gitlab-create-for-project bean="bean" name="gitlab_create_form"></gitlab-create-for-project>\n        </div>\n    </textarea> </div>';n.run(["$templateCache",function(e){e.put("gitlab.html",o)}]),e.exports=o},function(e,t){var n,i=window.angular;try{n=i.module(["ng"])}catch(r){n=i.module("ng",[])}var o='<div class="inner-view"> <article class="issue-details" issue-details id="issue-details"> <div class="not-found" ng-show="notFound"> <p> <i class="icon"></i>\n404 Not Found </p> </div> <div ng-show="assetPreviewer.show" class="asset-unwind-container"> <h3>{{assetPreviewer.bundleName}}\n<button class="default transparent" ng-click="onClickCloseAssetPreviewer($event)"> <i class="small icon"></i> </button> </h3> <asset-bundle-unwind></asset-bundle-unwind> </div> <div ng-show="!notFound" class="full"> <div style="height: 100%; position:relative">  <header> <div class="project-name"> <i class="small icon cell"></i> <label>{{project.title}}</label> </div> <div class="owner" dropdown data-name="issue:owner" data-text-container="label.display" data-selected="{{issue.owner}}" ng-hide="articleOnly" data-empty="责任人"> <i class="icon small cell"></i> <label class="display">{{issue.owner_name || \'未指定\'}}</label> <project-member-dropdown data-items="{{projectMember}}"></project-member-dropdown> </div> <div class="finish-date" ng-hide="articleOnly"> <button datetime-picker data-name="plan_finish_time" data-date="{{issue.plan_finish_time}}"> <i class="icon small cell"></i>\n<span> {{(issue.plan_finish_time | date:\'yyyy-MM-dd\') || \'完成日期\' }}</span> </button> </div> <div class="priority" dropdown data-name="issue:priority" data-text-container="label.display" data-selected="{{issue.priority}}" ng-hide="articleOnly" data-empty="请选择优先级" title="请选择优先级"> <i class="icon small cell priority-{{issue.priority}}"></i> <label class="display">中</label> <issue-priority-dropdown data-project-id="{{issue.project_id}}" data-id="{{issue.id}}"></issue-priority-dropdown> </div> <div class="category text-only" dropdown data-name="issue:category" data-text-container="label.display" data-selected="{{issue.category_id}}" title="请选择分类" data-empty="请选择分类"> <i class="icon small cell dummy"></i> <label class="display text-overflow">选择分类</label> <project-category-dropdown data-project-id="{{issue.project_id}}" data-id="{{issue.category_id}}"></project-category-dropdown> </div> <div class="tag text-only" dropdown data-name="issue:tag" data-text-container="label.display" data-selected="{{issue.tag}}" title="请选择类型" data-empty="请选择类型" ng-show="articleOnly"> <i class="icon small cell dummy"></i> <label class="display text-overflow">任务类型</label> <issue-tag-dropdown></issue-tag-dropdown> </div> <div class="version text-only" dropdown data-name="issue:version" data-text-container="label.display" data-selected="{{issue.version_id}}" title="请选择版本" ng-hide="articleOnly" data-empty="请选择版本"> <i class="icon small cell dummy"></i> <label class="display text-overflow">选择版本</label> <project-version-dropdown data-show-more="false"></project-version-dropdown> </div> </header>  <div class="issue panel" ng-click="onClickIssue($event)"> <div class="title" issue-status-dropdown-action> <div class="issue-status" ng-click="onClickStatus($event, issue)"> <i class="issue-status icon small" ng-class="issue.status"></i> </div> <input type="text" class="text" ng-show="editing" ng-model="issue.title"/> <h3 ng-show="!editing">{{issue.title | removeCommand | removeTag}}</h3> <div class="toolbar"> <a ng-click="onClickSplit($event, data)" href="javascript:void(0)" class="edit"> <i class="icon split"></i>\n<span class="tollbar-text">拆分</span> </a>\n<a ng-click="onClickEdit($event, data)" href="javascript:void(0)" class="edit"> <i class="icon edit"></i>\n<span class="tollbar-text">编辑</span> </a>\n<a ng-click="onClickDelete($event, data)" href="javascript:void(0)" class="delete"> <i class="icon delete"></i>\n<span class="tollbar-text">删除</span> </a> </div> <issue-status-dropdown></issue-status-dropdown> </div> <div class="sub-title"> <span class="creator">{{issue.creator_name || \'创建者\'}}</span> 创建于\n<span class="timestamp">{{issue.timestamp | date: \'yyyy-MM-dd HH:mm\'}}</span>\n<span class="id">#{{issue.id}}</span>\n<span class="timestamp" ng-show="issue.plan_finish_time">计划完成：{{issue.plan_finish_time | date}}</span>\n<span class="timestamp" ng-show="issue.finish_time">实际完成：{{issue.finish_time | date}}</span> <window-change-button ng-show="needchange"></window-change-button> </div> <issue-follow-members></issue-follow-members> <issue-split ng-show="!editing"></issue-split> <div ng-if="issue.tag!=\'form\'" class="content row editor-style" ng-bind-html="issue.content | unsafe" ng-show="!editing" full-size-image-previewer></div> <div ng-show="editing"> <editor data-name="issue" data-show-always-top="{{showAlwaysTop}}" data-upload-url="{{uploadUrl}}"></editor> </div> <issue-form ng-if="issue.tag==\'form\'" class="issue-form view" data-type="1" data-editflag="-1" data-change="-1"></issue-form> </div>  <div class="assets panel"> <div class="title"> <i class="icon small"></i> <h3>附件</h3> </div> <div class="content">  <asset-thumbnails></asset-thumbnails> </div> </div>  <div class="comments panel"> <div class="title"> <i class="icon small"></i> <h3>评论</h3> </div> <div class="content"> <comment-list></comment-list> </div> </div>  <div class="commits panel" ng-hide="articleOnly"> <div class="title"> <i class="icon small"></i> <h3>代码记录</h3> </div> <div class="content"> <commit-issue-list></commit-issue-list> </div> </div>  <div class="logs panel"> <div class="title"> <i class="icon small"></i> <h3>操作日志</h3> </div> <div class="content"> <issue-log></issue-log> </div> </div> </div> </div> </article> <comment-editor data-upload-url="{{uploadUrl}}"></comment-editor> </div>';n.run(["$templateCache",function(e){e.put("details.html",o)}]),e.exports=o},function(e,t){var n,i=window.angular;try{n=i.module(["ng"])}catch(r){n=i.module("ng",[])}var o='<div class="frame home-view full"> <header-global> </header-global> <div class="content-view"> <project-editor></project-editor> <div class="project-view"> <h3 class="title">我的项目</h3> <project-tiles></project-tiles> </div> </div> </div>';n.run(["$templateCache",function(e){e.put("home.html",o)}]),e.exports=o}]));